This file is a merged representation of the entire codebase, combining all repository files into a single document.
Generated by Repomix on: 2024-11-30T23:00:48.767Z

================================================================
File Summary
================================================================

Purpose:
--------
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

File Format:
------------
The content is organized as follows:
1. This summary section
2. Repository information
3. Repository structure
4. Multiple file entries, each consisting of:
  a. A separator line (================)
  b. The file path (File: path/to/file)
  c. Another separator line
  d. The full contents of the file
  e. A blank line

Usage Guidelines:
-----------------
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.

Notes:
------
- Some files may have been excluded based on .gitignore rules and Repomix's
  configuration.
- Binary files are not included in this packed representation. Please refer to
  the Repository Structure section for a complete list of file paths, including
  binary files.

Additional Info:
----------------

For more information about Repomix, visit: https://github.com/yamadashy/repomix

================================================================
Repository Structure
================================================================
src/
  assets/
    actor.js
    bundle.js
    bundle.js.LICENSE.txt
    cycles-balance.js
    index.html
  main.mo
dfx.json
index.js
Makefile
mops.toml
package.json
upload.js
webpack.config.js

================================================================
Repository Files
================================================================

================
File: src/assets/actor.js
================
import { HttpAgent, Actor } from "@dfinity/agent";
import { AuthClient } from "@dfinity/auth-client"
import { updateBalance } from './cycles-balance.js';  

const canisterId = "bw4dl-smaaa-aaaaa-qaacq-cai";

const idlFactory = ({ IDL }) => {
    return IDL.Service({
        whoAmI: IDL.Func([], [IDL.Principal], ["query"])
    });
};

const createActor = (canisterId, options = {}) => {
    const agent = new HttpAgent({
        host: "http://localhost:4943",
        ...options
    });
    
    // Only fetch the root key in development
    agent.fetchRootKey().catch(console.error);
    
    return Actor.createActor(idlFactory, {
        agent,
        canisterId,
    });
};

let actor = createActor(canisterId);
let authClient;

const updatePrincipalDisplay = async (actor, isAuthenticated = false) => {
    const displayElement = document.getElementById('principal-display');
    if (displayElement) {
        try {
            const principal = await actor.whoAmI();
            const principalText = principal.toText();
            displayElement.textContent = `${principalText}`;
        } catch (error) {
            console.error("Error getting principal:", error);
            displayElement.textContent = "Error fetching principal";
        }
    }
};

const updateAuthButton = (isAuthenticated) => {
    const button = document.getElementById('auth-button');
    if (button) {
        button.textContent = isAuthenticated ? 'Sign Out' : 'Sign in';
    }
};

const handleAuthenticated = async (authClient) => {
    const identity = authClient.getIdentity();
    actor = createActor(canisterId, { identity });
    await updatePrincipalDisplay(actor, true);
    updateAuthButton(true);
};

const init = async () => {
    authClient = await AuthClient.create();
    
    if (await authClient.isAuthenticated()) {
        await handleAuthenticated(authClient);
    } else {
        await updatePrincipalDisplay(actor, false);
        updateAuthButton(false);
    }

    // Add click handler for auth button
    document.getElementById('auth-button').addEventListener('click', async () => {
        if (await authClient.isAuthenticated()) {
            // Sign out
            await authClient.logout();
            actor = createActor(canisterId);
            await updatePrincipalDisplay(actor, false);
            updateAuthButton(false);
        } else {
            // Sign in
            await new Promise((resolve, reject) => {
                authClient.login({
                    identityProvider: `http://rdmx6-jaaaa-aaaaa-aaadq-cai.localhost:4943`,
                    onSuccess: resolve,
                    onError: reject,
                });
            });
            await handleAuthenticated(authClient);
        }
        updateBalance();
    });
};

init().catch(console.error);

================
File: src/assets/bundle.js
================
/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={506:(t,e,r)=>{"use strict";var n;r.d(e,{R:()=>n}),function(t){t[t.SysFatal=1]="SysFatal",t[t.SysTransient=2]="SysTransient",t[t.DestinationInvalid=3]="DestinationInvalid",t[t.CanisterReject=4]="CanisterReject",t[t.CanisterError=5]="CanisterError"}(n||(n={}))},72:(t,e,r)=>{"use strict";r.d(e,{t:()=>i});var n=r(857);class i extends n.Yv{constructor(t,e){super(t),this.response=e,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}},649:(t,e,r)=>{"use strict";r.d(e,{MM:()=>d.MM,qB:()=>wt,GZ:()=>pt,BY:()=>ut});var n,i,s,o,a=r(336),c=r(857),u=r(508),f=r(358),h=r(141),l=r(338),d=r(218),p=r(477),g=r(72),y=r(57),w=r(810),b=r(31),m=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},v=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class E{constructor(t={}){n.set(this,void 0),i.set(this,void 0),this[s]=this.entries.bind(this),this[o]="ExpirableMap";const{source:e=[],expirationTime:r=6e5}=t,a=Date.now();m(this,n,new Map([...e].map((([t,e])=>[t,{value:e,timestamp:a}]))),"f"),m(this,i,r,"f")}prune(){const t=Date.now();for(const[e,r]of v(this,n,"f").entries())t-r.timestamp>v(this,i,"f")&&v(this,n,"f").delete(e);return this}set(t,e){this.prune();const r={value:e,timestamp:Date.now()};return v(this,n,"f").set(t,r),this}get(t){const e=v(this,n,"f").get(t);if(void 0!==e){if(!(Date.now()-e.timestamp>v(this,i,"f")))return e.value;v(this,n,"f").delete(t)}}clear(){v(this,n,"f").clear()}entries(){const t=v(this,n,"f").entries();return function*(){for(const[e,r]of t)yield[e,r.value]}()}values(){const t=v(this,n,"f").values();return function*(){for(const e of t)yield e.value}()}keys(){return v(this,n,"f").keys()}forEach(t,e){for(const[r,i]of v(this,n,"f").entries())t.call(e,i.value,r,this)}has(t){return v(this,n,"f").has(t)}delete(t){return v(this,n,"f").delete(t)}get size(){return v(this,n,"f").size}}n=new WeakMap,i=new WeakMap,s=Symbol.iterator,o=Symbol.toStringTag;var _=r(499),I=r(345);class B{constructor(){this.observers=[]}subscribe(t){this.observers.push(t)}unsubscribe(t){this.observers=this.observers.filter((e=>e!==t))}notify(t,...e){this.observers.forEach((r=>r(t,...e)))}}class x extends B{constructor(){super()}print(t,...e){this.notify({message:t,level:"info"},...e)}warn(t,...e){this.notify({message:t,level:"warn"},...e)}error(t,e,...r){this.notify({message:t,level:"error",error:e},...r)}}var A,T,S,O,N,R,U,P,k,j=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},F=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};const L=.5,D=1.5,C=500,M=6e4,q=9e5,V=10;class ${constructor(t=$.default){A.set(this,void 0),T.set(this,void 0),S.set(this,void 0),O.set(this,void 0),N.set(this,void 0),R.set(this,void 0),U.set(this,void 0),P.set(this,void 0),k.set(this,0);const{initialInterval:e=C,randomizationFactor:r=L,multiplier:n=D,maxInterval:i=M,maxElapsedTime:s=q,maxIterations:o=V,date:a=Date}=t;j(this,A,e,"f"),j(this,T,r,"f"),j(this,S,n,"f"),j(this,O,i,"f"),j(this,P,a,"f"),j(this,N,a.now(),"f"),j(this,R,s,"f"),j(this,U,o,"f")}get ellapsedTimeInMsec(){return F(this,P,"f").now()-F(this,N,"f")}get currentInterval(){return F(this,A,"f")}get count(){return F(this,k,"f")}get randomValueFromInterval(){const t=F(this,T,"f")*F(this,A,"f"),e=F(this,A,"f")-t,r=F(this,A,"f")+t;return Math.random()*(r-e)+e}incrementCurrentInterval(){var t;return j(this,A,Math.min(F(this,A,"f")*F(this,S,"f"),F(this,O,"f")),"f"),j(this,k,(t=F(this,k,"f"),++t),"f"),F(this,A,"f")}next(){return this.ellapsedTimeInMsec>=F(this,R,"f")||F(this,k,"f")>=F(this,U,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}A=new WeakMap,T=new WeakMap,S=new WeakMap,O=new WeakMap,N=new WeakMap,R=new WeakMap,U=new WeakMap,P=new WeakMap,k=new WeakMap,$.default={initialInterval:C,randomizationFactor:L,multiplier:D,maxInterval:M,maxElapsedTime:q,maxIterations:V,date:Date};var z,G,K,W,H,Y,Z,J,X,Q,tt,et,rt,nt,it,st,ot,at,ct,ut,ft=r(373),ht=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},lt=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};!function(t){t.Received="received",t.Processing="processing",t.Replied="replied",t.Rejected="rejected",t.Unknown="unknown",t.Done="done"}(ut||(ut={}));const dt=6e4,pt="aaaaa-aa";class gt extends c.Yv{constructor(t){super(t),this.message=t}}class yt extends c.Yv{constructor(t){super(t),this.message=t}}class wt{constructor(t={}){var e;z.add(this),G.set(this,void 0),K.set(this,void 0),W.set(this,void 0),H.set(this,void 0),Y.set(this,0),Z.set(this,void 0),J.set(this,!1),X.set(this,void 0),Q.set(this,void 0),tt.set(this,void 0),this._isAgent=!0,this.config={},et.set(this,0),this.log=new x,rt.set(this,[]),nt.set(this,[]),it.set(this,new E({expirationTime:3e5})),st.set(this,!0),ct.set(this,((t,e)=>{if(!1===lt(this,st,"f"))return t;if(!e)throw new w.bK("Invalid signature from replica signed query: no matching node key found.");const{status:r,signatures:n=[],requestId:i}=t,s=(new TextEncoder).encode("\vic-response");for(const o of n){const{timestamp:n,identity:c}=o,u=a.p.fromUint8Array(c).toText();let f;if("replied"===r){const{reply:e}=t;f=(0,h.uF)({status:r,reply:e,timestamp:BigInt(n),request_id:i})}else{if("rejected"!==r)throw new Error(`Unknown status: ${r}`);{const{reject_code:e,reject_message:s,error_code:o}=t;f=(0,h.uF)({status:r,reject_code:e,reject_message:s,error_code:o,timestamp:BigInt(n),request_id:i})}}const d=(0,l.xW)(s,new Uint8Array(f)),p=null==e?void 0:e.nodeKeys.get(u);if(!p)throw new w.bK("Invalid signature from replica signed query: no matching node key found.");const g=_.G.fromDer(p).rawKey;if(b.ev.verify(o.signature,new Uint8Array(d),new Uint8Array(g)))return t;throw new w.bK(`Invalid signature from replica ${u} signed query.`)}return t})),this.config=t,ht(this,K,t.fetch||function(){let t;if("undefined"!=typeof window){if(!window.fetch)throw new gt("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");t=window.fetch.bind(window)}else if(void 0!==r.g){if(!r.g.fetch)throw new gt("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");t=r.g.fetch.bind(r.g)}else"undefined"!=typeof self&&self.fetch&&(t=self.fetch.bind(self));if(t)return t;throw new gt("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}()||fetch.bind(r.g),"f"),ht(this,W,t.fetchOptions,"f"),ht(this,H,t.callOptions,"f"),this.rootKey=t.rootKey?t.rootKey:(0,l.aD)("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae");const n=function(t){let e;if(void 0!==t)e=t.match(/^[a-z]+:/)||"undefined"==typeof window?new URL(t):new URL(window.location.protocol+"//"+t);else{const t=["ic0.app","icp0.io","127.0.0.1","localhost"],r=[".github.dev",".gitpod.io"],n="undefined"!=typeof window?window.location:void 0,i=null==n?void 0:n.hostname;let s;i&&"string"==typeof i&&(s=r.some((t=>i.endsWith(t)))?i:t.find((t=>i.endsWith(t)))),e=n&&s?new URL(`${n.protocol}//${s}${n.port?":"+n.port:""}`):new URL("https://icp-api.io")}return e.toString()}(t.host);if(this.host=new URL(n),void 0!==t.verifyQuerySignatures&&ht(this,st,t.verifyQuerySignatures,"f"),ht(this,X,null!==(e=t.retryTimes)&&void 0!==e?e:3,"f"),ht(this,Q,t.backoffStrategy||(()=>new $({maxIterations:lt(this,X,"f")})),"f"),this.host.hostname.endsWith(".ic0.app")?this.host.hostname="ic0.app":this.host.hostname.endsWith(".icp0.io")?this.host.hostname="icp0.io":this.host.hostname.endsWith(".icp-api.io")&&(this.host.hostname="icp-api.io"),t.credentials){const{name:e,password:r}=t.credentials;ht(this,Z,`${e}${r?":"+r:""}`,"f")}if(ht(this,G,Promise.resolve(t.identity||new u.mC),"f"),t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes>5)throw new c.Yv(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);if(t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes<=0)throw new c.Yv(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);ht(this,tt,t.ingressExpiryInMinutes||5,"f"),this.addTransform("update",(0,d.s8)(p.o)),t.useQueryNonces&&this.addTransform("query",(0,d.s8)(p.o)),t.logToConsole&&this.log.subscribe((t=>{"error"===t.level?console.error(t.message):"warn"===t.level?console.warn(t.message):console.log(t.message)}))}get waterMark(){return lt(this,et,"f")}static createSync(t={}){return new this(Object.assign({},t))}static async create(t={shouldFetchRootKey:!1}){const e=wt.createSync(t),r=[e.syncTime()];return"https://icp-api.io"!==e.host.toString()&&t.shouldFetchRootKey&&r.push(e.fetchRootKey()),await Promise.all(r),e}static async from(t){var e;try{return"config"in t?await wt.create(t.config):await wt.create({fetch:t._fetch,fetchOptions:t._fetchOptions,callOptions:t._callOptions,host:t._host.toString(),identity:null!==(e=t._identity)&&void 0!==e?e:void 0})}catch(t){throw new c.Yv("Failed to create agent from provided agent")}}isLocal(){const t=this.host.hostname;return"127.0.0.1"===t||t.endsWith("127.0.0.1")}addTransform(t,e,r=e.priority||0){if("update"===t){const t=lt(this,nt,"f").findIndex((t=>(t.priority||0)<r));lt(this,nt,"f").splice(t>=0?t:lt(this,nt,"f").length,0,Object.assign(e,{priority:r}))}else if("query"===t){const t=lt(this,rt,"f").findIndex((t=>(t.priority||0)<r));lt(this,rt,"f").splice(t>=0?t:lt(this,rt,"f").length,0,Object.assign(e,{priority:r}))}}async getPrincipal(){if(!lt(this,G,"f"))throw new yt("This identity has expired due this application's security policy. Please refresh your authentication.");return(await lt(this,G,"f")).getPrincipal()}async call(t,e,r){var n;const i=null===(n=e.callSync)||void 0===n||n,s=await(void 0!==r?await r:await lt(this,G,"f"));if(!s)throw new yt("This identity has expired due this application's security policy. Please refresh your authentication.");const o=a.p.from(t),c=e.effectiveCanisterId?a.p.from(e.effectiveCanisterId):o,u=s.getPrincipal()||a.p.anonymous();let l=new d.MM(lt(this,tt,"f")*dt);Math.abs(lt(this,Y,"f"))>3e4&&(l=new d.MM(lt(this,tt,"f")*dt+lt(this,Y,"f")));const g={request_type:p.q.Call,canister_id:o,method_name:e.methodName,arg:e.arg,sender:u,ingress_expiry:l};let y=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},lt(this,Z,"f")?{Authorization:"Basic "+btoa(lt(this,Z,"f"))}:{})},endpoint:"call",body:g});const w=y.body.nonce?(b=y.body.nonce,new Uint8Array(b)):void 0;var b;g.nonce=w,y=await s.transformRequest(y);const m=f.lF(y.body),v=lt(this,Q,"f").call(this);try{const t=()=>(this.log.print(`fetching "/api/v3/canister/${c.toText()}/call" with request:`,y),lt(this,K,"f").call(this,""+new URL(`/api/v3/canister/${c.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},lt(this,H,"f")),y.request),{body:m}))),e=()=>(this.log.print(`fetching "/api/v2/canister/${c.toText()}/call" with request:`,y),lt(this,K,"f").call(this,""+new URL(`/api/v2/canister/${c.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},lt(this,H,"f")),y.request),{body:m}))),r=lt(this,z,"m",at).call(this,{request:i?t:e,backoff:v,tries:0}),[n,s]=await Promise.all([r,(0,h.Gb)(g)]),o=await n.arrayBuffer(),a=200===n.status&&o.byteLength>0?f.D4(o):null;if(a&&"certificate"in a){const t=await this.parseTimeFromResponse({certificate:a.certificate});ht(this,et,t,"f")}return{requestId:s,response:{ok:n.ok,status:n.status,statusText:n.statusText,body:a,headers:(0,d.Z3)(n.headers)},requestDetails:g}}catch(n){if(n.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(t,Object.assign(Object.assign({},e),{callSync:!1}),r);throw this.log.error("Error while making call:",n),n}}async query(t,e,r){const n=lt(this,Q,"f").call(this),i=e.effectiveCanisterId?a.p.from(e.effectiveCanisterId):a.p.from(t);this.log.print(`ecid ${i.toString()}`),this.log.print(`canisterId ${t.toString()}`);const[s,o]=await Promise.all([(async()=>{const s=await(void 0!==r?r:lt(this,G,"f"));if(!s)throw new yt("This identity has expired due this application's security policy. Please refresh your authentication.");const o=a.p.from(t),c=(null==s?void 0:s.getPrincipal())||a.p.anonymous(),u={request_type:"query",canister_id:o,method_name:e.methodName,arg:e.arg,sender:c,ingress_expiry:new d.MM(lt(this,tt,"f")*dt)},l=await(0,h.Gb)(u);let p=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},lt(this,Z,"f")?{Authorization:"Basic "+btoa(lt(this,Z,"f"))}:{})},endpoint:"read",body:u});p=await(null==s?void 0:s.transformRequest(p));const g=f.lF(p.body),y={canister:o.toText(),ecid:i,transformedRequest:p,body:g,requestId:l,backoff:n,tries:0};return{requestDetails:u,query:await lt(this,z,"m",ot).call(this,y)}})(),(async()=>{if(!lt(this,st,"f"))return;return lt(this,it,"f").get(i.toString())||(await this.fetchSubnetKeys(i.toString()),lt(this,it,"f").get(i.toString()))})()]),{requestDetails:c,query:u}=s,l=Object.assign(Object.assign({},u),{requestDetails:c});if(this.log.print("Query response:",l),!lt(this,st,"f"))return l;try{return lt(this,ct,"f").call(this,l,o)}catch(e){this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),lt(this,it,"f").delete(t.toString()),await this.fetchSubnetKeys(i.toString());const r=lt(this,it,"f").get(t.toString());if(!r)throw new w.bK("Invalid signature from replica signed query: no matching node key found.");return lt(this,ct,"f").call(this,l,r)}}async createReadStateRequest(t,e){const r=await(void 0!==e?await e:await lt(this,G,"f"));if(!r)throw new yt("This identity has expired due this application's security policy. Please refresh your authentication.");const n=(null==r?void 0:r.getPrincipal())||a.p.anonymous(),i=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},lt(this,Z,"f")?{Authorization:"Basic "+btoa(lt(this,Z,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:t.paths,sender:n,ingress_expiry:new d.MM(lt(this,tt,"f")*dt)}});return null==r?void 0:r.transformRequest(i)}async readState(t,e,r,n){const i="string"==typeof t?a.p.fromText(t):t,s=null!=n?n:await this.createReadStateRequest(e,r),o=Object.assign(Object.assign({},s.body),{ingress_expiry:new d.MM(ft.j)}),c=f.lF(o);this.log.print(`fetching "/api/v2/canister/${i}/read_state" with request:`,s);const u=lt(this,Q,"f").call(this);try{const t=await lt(this,z,"m",at).call(this,{request:()=>lt(this,K,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},lt(this,W,"f")),s.request),{body:c})),backoff:u,tries:0});if(!t.ok)throw new Error(`Server returned an error:\n  Code: ${t.status} (${t.statusText})\n  Body: ${await t.text()}\n`);const e=f.D4(await t.arrayBuffer());this.log.print("Read state response:",e);const r=await this.parseTimeFromResponse(e);return r>0&&(this.log.print("Read state response time:",r),ht(this,et,r,"f")),e}catch(t){throw this.log.error("Caught exception while attempting to read state",t),t}}async parseTimeFromResponse(t){let e;if(t.certificate){const r=f.D4(t.certificate);if(!r||!("tree"in r))throw new Error("Could not decode time from response");e=r.tree;const n=(0,w.hV)(["time"],e);if(n.status!==w.hi.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(n.value instanceof ArrayBuffer||ArrayBuffer.isView(n)))throw new Error("Time was not found in the response or was not in its expected format.");const i=(0,I.A)((0,l.em)(n.value));return this.log.print("Time from response:",i),this.log.print("Time from response in milliseconds:",Number(i)),Number(i)}return this.log.warn("No certificate found in response"),0}async syncTime(t){const e=await Promise.resolve().then(r.bind(r,57)),n=Date.now();try{t||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const r=(await e.request({canisterId:null!=t?t:a.p.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:this,paths:["time"]})).get("time");r&&ht(this,Y,Number(r)-Number(n),"f")}catch(t){this.log.error("Caught exception while attempting to sync time",t)}}async status(){const t=lt(this,Z,"f")?{Authorization:"Basic "+btoa(lt(this,Z,"f"))}:{};this.log.print('fetching "/api/v2/status"');const e=lt(this,Q,"f").call(this),r=await lt(this,z,"m",at).call(this,{backoff:e,request:()=>lt(this,K,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:t},lt(this,W,"f"))),tries:0});return f.D4(await r.arrayBuffer())}async fetchRootKey(){if(!lt(this,J,"f")){const t=await this.status();this.rootKey=t.root_key,ht(this,J,!0,"f")}return this.rootKey}invalidateIdentity(){ht(this,G,null,"f")}replaceIdentity(t){ht(this,G,Promise.resolve(t),"f")}async fetchSubnetKeys(t){const e=a.p.from(t),r=(await(0,y.request)({canisterId:e,paths:["subnet"],agent:this})).get("subnet");if(r&&"object"==typeof r&&"nodeKeys"in r)return lt(this,it,"f").set(e.toText(),r),r}_transform(t){let e=Promise.resolve(t);if("call"===t.endpoint)for(const t of lt(this,nt,"f"))e=e.then((e=>t(e).then((t=>t||e))));else for(const t of lt(this,rt,"f"))e=e.then((e=>t(e).then((t=>t||e))));return e}}G=new WeakMap,K=new WeakMap,W=new WeakMap,H=new WeakMap,Y=new WeakMap,Z=new WeakMap,J=new WeakMap,X=new WeakMap,Q=new WeakMap,tt=new WeakMap,et=new WeakMap,rt=new WeakMap,nt=new WeakMap,it=new WeakMap,st=new WeakMap,ct=new WeakMap,z=new WeakSet,ot=async function t(e){var r,n;const{ecid:i,transformedRequest:s,body:o,requestId:a,backoff:u,tries:h}=e,l=0===h?0:u.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:h,backoff:u,delay:l}),null===l)throw new c.Yv(`Timestamp failed to pass the watermark after retrying the configured ${lt(this,X,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);let p;l>0&&await new Promise((t=>setTimeout(t,l)));try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,s);const t=await lt(this,K,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},lt(this,W,"f")),s.request),{body:o}));if(200!==t.status)throw new g.t(`Gateway returned an error:\n  Code: ${t.status} (${t.statusText})\n  Body: ${await t.text()}\n`,{ok:t.ok,status:t.status,statusText:t.statusText,headers:(0,d.Z3)(t.headers)});{const e=f.D4(await t.arrayBuffer());p=Object.assign(Object.assign({},e),{httpDetails:{ok:t.ok,status:t.status,statusText:t.statusText,headers:(0,d.Z3)(t.headers)},requestId:a})}}catch(r){if(h<lt(this,X,"f"))return this.log.warn(`Caught exception while attempting to make query:\n  ${r}\n  Retrying query.`),await lt(this,z,"m",t).call(this,Object.assign(Object.assign({},e),{tries:h+1}));throw r}const y=null===(n=null===(r=p.signatures)||void 0===r?void 0:r[0])||void 0===n?void 0:n.timestamp;if(!lt(this,st,"f"))return p;if(!y)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const w=Number(BigInt(y)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:w}),Number(this.waterMark)>w){const r=new c.Yv("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",r,{timestamp:y,waterMark:this.waterMark}),h<lt(this,X,"f"))return await lt(this,z,"m",t).call(this,Object.assign(Object.assign({},e),{tries:h+1}));throw new c.Yv(`Timestamp failed to pass the watermark after retrying the configured ${lt(this,X,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return p},at=async function t(e){const{request:r,backoff:n,tries:i}=e,s=0===i?0:n.next();if(null===s)throw new c.Yv(`Timestamp failed to pass the watermark after retrying the configured ${lt(this,X,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);let o;s>0&&await new Promise((t=>setTimeout(t,s)));try{o=await r()}catch(e){if(lt(this,X,"f")>i)return this.log.warn(`Caught exception while attempting to make request:\n  ${e}\n  Retrying request.`),await lt(this,z,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw e}if(o.ok)return o;const a=await o.clone().text(),u=`Server returned an error:\n  Code: ${o.status} (${o.statusText})\n  Body: ${a}\n`;if(404===o.status&&o.url.includes("api/v3"))throw new g.t("v3 api not supported. Fall back to v2",{ok:o.ok,status:o.status,statusText:o.statusText,headers:(0,d.Z3)(o.headers)});if(i<lt(this,X,"f"))return await lt(this,z,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw new g.t(u,{ok:o.ok,status:o.status,statusText:o.statusText,headers:(0,d.Z3)(o.headers)})}},218:(t,e,r)=>{"use strict";r.d(e,{MM:()=>a,Z3:()=>u,s8:()=>c});var n=r(664),i=r(283),s=r(477);const o=BigInt(1e6);class a{constructor(t){if(t<9e4){const e=BigInt(Date.now()+t)*o/BigInt(1e9);return void(this._value=e*BigInt(1e9))}const e=BigInt(Math.floor(Date.now()+t-6e4))*o/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=e}toCBOR(){return i.value.u64(this._value.toString(16),16)}toHash(){return(0,n.kk)(this._value)}}function c(t=s.o){return async e=>{const r=e.request.headers;e.request.headers=r,"call"===e.endpoint&&(e.body.nonce=t())}}function u(t){const e=[];return t.forEach(((t,r)=>{e.push([r,t])})),e}},477:(t,e,r)=>{"use strict";r.d(e,{q:()=>i,o:()=>s});const n=()=>{if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){const t=new Uint32Array(1);return window.crypto.getRandomValues(t),t[0]}if("undefined"!=typeof crypto&&crypto.getRandomValues){const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]}return"undefined"!=typeof crypto&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(4294967295*Math.random())};var i;function s(){const t=new ArrayBuffer(16),e=new DataView(t),r=n(),i=n(),s=n(),o=n();return e.setUint32(0,r),e.setUint32(4,i),e.setUint32(8,s),e.setUint32(12,o),t}!function(t){t.Call="call"}(i||(i={}))},485:(t,e,r)=>{"use strict";r.d(e,{MM:()=>s.MM,qB:()=>s.qB,GZ:()=>s.GZ,RK:()=>i.R,BY:()=>s.BY,i8:()=>o});var n,i=r(506),s=r(649);function o(){const t="undefined"==typeof window?void 0===r.g?"undefined"==typeof self?void 0:self.ic.agent:r.g.ic.agent:window.ic.agent;if(!t)throw new Error("No Agent could be found.");return t}r(72),r(336),function(t){t.Error="err",t.GetPrincipal="gp",t.GetPrincipalResponse="gpr",t.Query="q",t.QueryResponse="qr",t.Call="c",t.CallResponse="cr",t.ReadState="rs",t.ReadStateResponse="rsr",t.Status="s",t.StatusResponse="sr"}(n||(n={}))},508:(t,e,r)=>{"use strict";r.d(e,{A4:()=>a,mC:()=>c});var n=r(336),i=r(141),s=r(338);const o=(new TextEncoder).encode("\nic-request");class a{getPrincipal(){return this._principal||(this._principal=n.p.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(t){const{body:e}=t,r=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r}(t,["body"]),n=await(0,i.Gb)(e);return Object.assign(Object.assign({},r),{body:{content:e,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign((0,s.xW)(o,n))}})}}class c{getPrincipal(){return n.p.anonymous()}async transformRequest(t){return Object.assign(Object.assign({},t),{body:{content:t.body}})}}},57:(t,e,r)=>{"use strict";r.r(e),r.d(e,{CustomPath:()=>u,encodePath:()=>l,fetchNodeKeys:()=>h,request:()=>f});var n=r(336),i=r(857),s=r(810),o=r(338),a=r(358),c=r(345);class u{constructor(t,e,r){this.key=t,this.path=e,this.decodeStrategy=r}}const f=async t=>{const{agent:e,paths:r}=t,o=n.p.from(t.canisterId),a=[...new Set(r)],u=a.map((t=>l(t,o))),f=new Map,w=a.map(((t,r)=>(async()=>{var n;try{const t=await e.readState(o,{paths:[u[r]]}),n=await s.us.create({certificate:t.certificate,rootKey:e.rootKey,canisterId:o}),i=(r,n)=>"subnet"===n?{path:n,data:h(t.certificate,o,e.rootKey)}:{path:n,data:(0,s.Xr)(r.lookup(l(n,o)))},{path:w,data:b}=i(n,a[r]);if(b)switch(w){case"time":f.set(w,(0,c.A)(b));break;case"controllers":f.set(w,y(b));break;case"module_hash":f.set(w,d(b));break;case"subnet":f.set(w,b);break;case"candid":f.set(w,(new TextDecoder).decode(b));break;default:if("string"!=typeof w&&"key"in w&&"path"in w)switch(w.decodeStrategy){case"raw":f.set(w.key,b);break;case"leb128":f.set(w.key,(0,c.b)(b));break;case"cbor":f.set(w.key,p(b));break;case"hex":f.set(w.key,d(b));break;case"utf-8":f.set(w.key,g(b))}}else console.warn(`Expected to find result for path ${w}, but instead found nothing.`),"string"==typeof w?f.set(w,null):f.set(w.key,null)}catch(e){if(null===(n=null==e?void 0:e.message)||void 0===n?void 0:n.includes("Invalid certificate"))throw new i.Yv(e.message);"string"!=typeof t&&"key"in t&&"path"in t?f.set(t.key,null):f.set(t,null),console.group(),console.warn(`Expected to find result for path ${t}, but instead found nothing.`),console.warn(e),console.groupEnd()}})()));return await Promise.all(w),f},h=(t,e,r)=>{if(!e._isPrincipal)throw new Error("Invalid canisterId");const i=a.D4(new Uint8Array(t)),o=i.tree;let c,u=i.delegation;if(u&&u.subnet_id?c=n.p.fromUint8Array(new Uint8Array(u.subnet_id)):u||void 0===r?(c=n.p.selfAuthenticating(n.p.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),u={subnet_id:c.toUint8Array(),certificate:new ArrayBuffer(0)}):(c=n.p.selfAuthenticating(new Uint8Array(r)),u={subnet_id:c.toUint8Array(),certificate:new ArrayBuffer(0)}),!(0,s.Gk)({canisterId:e,subnetId:c,tree:o}))throw new Error("Canister not in range");const f=(0,s.hV)(["subnet",u.subnet_id,"node"],o);if(f.status!==s.hi.Found)throw new Error("Node not found");if(f.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const h=(0,s.Bx)(f.value),l=new Map;return h.forEach((t=>{const e=n.p.from(new Uint8Array(t[1])).toText(),r=(0,s.hV)(["public_key"],t[2]);if(r.status!==s.hi.Found)throw new Error("Public key not found");const i=r.value;if(44!==i.byteLength)throw new Error("Invalid public key length");l.set(e,i)})),{subnetId:n.p.fromUint8Array(new Uint8Array(u.subnet_id)).toText(),nodeKeys:l}},l=(t,e)=>{const r=new TextEncoder,n=t=>new DataView(r.encode(t).buffer).buffer,i=new DataView(e.toUint8Array().buffer).buffer;switch(t){case"time":return[n("time")];case"controllers":return[n("canister"),i,n("controllers")];case"module_hash":return[n("canister"),i,n("module_hash")];case"subnet":return[n("subnet")];case"candid":return[n("canister"),i,n("metadata"),n("candid:service")];default:if("key"in t&&"path"in t){if("string"==typeof t.path||t.path instanceof ArrayBuffer){const e=t.path,r="string"==typeof e?n(e):e;return[n("canister"),i,n("metadata"),r]}return t.path}}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${t} was formatted correctly.`)},d=t=>(0,o.nj)(t),p=t=>a.D4(t),g=t=>(new TextDecoder).decode(t),y=t=>p(t).map((t=>n.p.fromUint8Array(new Uint8Array(t))))},358:(t,e,r)=>{"use strict";r.d(e,{D4:()=>h,lF:()=>c});var n=r(516),i=r(283),s=r(338);const o=i.SelfDescribeCborSerializer.withDefaultEncoders(!0);var a;function c(t){return o.serialize(t)}function u(t){const e=t.byteLength;let r=BigInt(0);for(let n=0;n<e;n++)r=r*BigInt(256)+BigInt(t[n]);return r}o.addEncoder(new class{get name(){return"Principal"}get priority(){return 0}match(t){return t&&!0===t._isPrincipal}encode(t){return i.value.bytes(t.toUint8Array())}}),o.addEncoder(new class{get name(){return"Buffer"}get priority(){return 1}match(t){return t instanceof ArrayBuffer||ArrayBuffer.isView(t)}encode(t){return i.value.bytes(new Uint8Array(t))}}),o.addEncoder(new class{get name(){return"BigInt"}get priority(){return 1}match(t){return"bigint"==typeof t}encode(t){return t>BigInt(0)?i.value.tagged(2,i.value.bytes((0,s.aD)(t.toString(16)))):i.value.tagged(3,i.value.bytes((0,s.aD)((BigInt("-1")*t).toString(16))))}}),function(t){t[t.Uint64LittleEndian=71]="Uint64LittleEndian",t[t.Semantic=55799]="Semantic"}(a||(a={}));class f extends n.Decoder{createByteString(t){return(0,s.xW)(...t)}createByteStringFromHeap(t,e){return t===e?new ArrayBuffer(0):new Uint8Array(this._heap.slice(t,e))}}function h(t){const e=new Uint8Array(t),r=new f({size:e.byteLength,tags:{2:t=>u(t),3:t=>-u(t),[a.Semantic]:t=>t}});try{return r.decodeFirst(e)}catch(t){throw new Error(`Failed to decode CBOR: ${t}, input: ${(0,s.nj)(e)}`)}}},810:(t,e,r)=>{"use strict";r.d(e,{us:()=>Et,bK:()=>vt,hi:()=>Tt,Gk:()=>Ut,Bx:()=>Nt,Xr:()=>Bt,hV:()=>Ot});var n=r(358),i=r(857),s=r(141),o=r(338),a=r(336),c=r(690),u=r(606);const f=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),h=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),l=new Uint32Array(64);class d extends c.ol{constructor(){super(64,32,8,!1),this.A=0|h[0],this.B=0|h[1],this.C=0|h[2],this.D=0|h[3],this.E=0|h[4],this.F=0|h[5],this.G=0|h[6],this.H=0|h[7]}get(){const{A:t,B:e,C:r,D:n,E:i,F:s,G:o,H:a}=this;return[t,e,r,n,i,s,o,a]}set(t,e,r,n,i,s,o,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)l[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=l[t-15],r=l[t-2],n=(0,u.Ow)(e,7)^(0,u.Ow)(e,18)^e>>>3,i=(0,u.Ow)(r,17)^(0,u.Ow)(r,19)^r>>>10;l[t]=i+l[t-7]+n+l[t-16]|0}let{A:r,B:n,C:i,D:s,E:o,F:a,G:h,H:d}=this;for(let t=0;t<64;t++){const e=d+((0,u.Ow)(o,6)^(0,u.Ow)(o,11)^(0,u.Ow)(o,25))+(0,c.r9)(o,a,h)+f[t]+l[t]|0,p=((0,u.Ow)(r,2)^(0,u.Ow)(r,13)^(0,u.Ow)(r,22))+(0,c.TQ)(r,n,i)|0;d=h,h=a,a=o,o=s+e|0,s=i,i=n,n=r,r=e+p|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,o=o+this.E|0,a=a+this.F|0,h=h+this.G|0,d=d+this.H|0,this.set(r,n,i,s,o,a,h,d)}roundClean(){l.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const p=(0,u.ld)((()=>new d));var g=r(30),y=r(293);const w=y.Ph;function b(t,e){if(v(t),v(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=255&t,t>>>=8;return new Uint8Array(r)}function m(t,e){const r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}function v(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function E(t,e,r){(0,y.Q5)(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:n,k:i,m:s,hash:o,expand:a,DST:c}=r;(0,y.DO)(t),v(e);const u="string"==typeof c?(0,y.AI)(c):c,f=n.toString(2).length,h=Math.ceil((f+i)/8),l=e*s*h;let d;if("xmd"===a)d=function(t,e,r,n){(0,y.DO)(t),(0,y.DO)(e),v(r),e.length>255&&(e=n((0,y.Id)((0,y.AI)("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:s}=n,o=Math.ceil(r/i);if(r>65535||o>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=(0,y.Id)(e,b(e.length,1)),c=b(0,s),u=b(r,2),f=new Array(o),h=n((0,y.Id)(c,t,u,b(0,1),a));f[0]=n((0,y.Id)(h,b(1,1),a));for(let t=1;t<=o;t++){const e=[m(h,f[t-1]),b(t+1,1),a];f[t]=n((0,y.Id)(...e))}return(0,y.Id)(...f).slice(0,r)}(t,u,l,o);else if("xof"===a)d=function(t,e,r,n,i){if((0,y.DO)(t),(0,y.DO)(e),v(r),e.length>255){const t=Math.ceil(2*n/8);e=i.create({dkLen:t}).update((0,y.AI)("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(b(r,2)).update(e).update(b(e.length,1)).digest()}(t,u,l,i,o);else{if("_internal_pass"!==a)throw new Error('expand must be "xmd" or "xof"');d=t}const p=new Array(e);for(let t=0;t<e;t++){const e=new Array(s);for(let r=0;r<s;r++){const i=h*(r+t*s),o=d.subarray(i,i+h);e[r]=(0,g.zi)(w(o),n)}p[t]=e}return p}function _(t,e){const r=e.map((t=>Array.from(t).reverse()));return(e,n)=>{const[i,s,o,a]=r.map((r=>r.reduce(((r,n)=>t.add(t.mul(r,e),n)))));return e=t.div(i,s),n=t.mul(n,t.div(o,a)),{x:e,y:n}}}function I(t,e,r){if("function"!=typeof e)throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){const s=E(n,2,{...r,DST:r.DST,...i}),o=t.fromAffine(e(s[0])),a=t.fromAffine(e(s[1])),c=o.add(a).clearCofactor();return c.assertValidity(),c},encodeToCurve(n,i){const s=E(n,1,{...r,DST:r.encodeDST,...i}),o=t.fromAffine(e(s[0])).clearCofactor();return o.assertValidity(),o},mapToCurve(r){if(!Array.isArray(r))throw new Error("mapToCurve: expected array of bigints");for(const t of r)if("bigint"!=typeof t)throw new Error("mapToCurve: expected array of bigints");const n=t.fromAffine(e(r)).clearCofactor();return n.assertValidity(),n}}}var B=r(615);const{Ph:x,aT:A}=y,T={Err:class extends Error{constructor(t=""){super(t)}},_tlv:{encode:(t,e)=>{const{Err:r}=T;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(1&e.length)throw new r("tlv.encode: unpadded data");const n=e.length/2,i=y.zW(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?y.zW(i.length/2|128):"";return y.zW(t)+s+i+e},decode(t,e){const{Err:r}=T;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const i=e[n++];let s=0;if(128&i){const t=127&i;if(!t)throw new r("tlv.decode(long): indefinite length not supported");if(t>4)throw new r("tlv.decode(long): byte length is too big");const o=e.subarray(n,n+t);if(o.length!==t)throw new r("tlv.decode: length bytes not complete");if(0===o[0])throw new r("tlv.decode(long): zero leftmost byte");for(const t of o)s=s<<8|t;if(n+=t,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=i;const o=e.subarray(n,n+s);if(o.length!==s)throw new r("tlv.decode: wrong value length");return{v:o,l:e.subarray(n+s)}}},_int:{encode(t){const{Err:e}=T;if(t<S)throw new e("integer: negative integers are not allowed");let r=y.zW(t);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=T;if(128&t[0])throw new e("invalid signature integer: negative");if(0===t[0]&&!(128&t[1]))throw new e("invalid signature integer: unnecessary leading zero");return x(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=T,i="string"==typeof t?A(t):t;y.DO(i);const{v:s,l:o}=n.decode(48,i);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,s),{v:u,l:f}=n.decode(2,c);if(f.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(u)}},hexFromSig(t){const{_tlv:e,_int:r}=T,n=e.encode(2,r.encode(t.r))+e.encode(2,r.encode(t.s));return e.encode(48,n)}},S=BigInt(0),O=BigInt(1),N=BigInt(2),R=BigInt(3),U=BigInt(4);function P(t){const e=function(t){const e=(0,B.hp)(t);y.Q5(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:r}=e,n=g.D0(e.n,e.nBitLength),i=e.toBytes||((t,e,n)=>{const i=e.toAffine();return y.Id(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),s=e.fromBytes||(t=>{const e=t.subarray(1);return{x:r.fromBytes(e.subarray(0,r.BYTES)),y:r.fromBytes(e.subarray(r.BYTES,2*r.BYTES))}});function o(t){const{a:n,b:i}=e,s=r.sqr(t),o=r.mul(s,t);return r.add(r.add(o,r.mul(t,n)),i)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(t){const{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:i,n:s}=e;if(r&&"bigint"!=typeof t){if(y.aY(t)&&(t=y.My(t)),"string"!=typeof t||!r.includes(t.length))throw new Error("invalid private key");t=t.padStart(2*n,"0")}let o;try{o="bigint"==typeof t?t:y.Ph((0,y.qj)("private key",t,n))}catch(e){throw new Error("invalid private key, expected hex or "+n+" bytes, got "+typeof t)}return i&&(o=g.zi(o,s)),y.aK("private key",o,O,s),o}function c(t){if(!(t instanceof h))throw new Error("ProjectivePoint expected")}const u=(0,y.x)(((t,e)=>{const{px:n,py:i,pz:s}=t;if(r.eql(s,r.ONE))return{x:n,y:i};const o=t.is0();null==e&&(e=o?r.ONE:r.inv(s));const a=r.mul(n,e),c=r.mul(i,e),u=r.mul(s,e);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(u,r.ONE))throw new Error("invZ was invalid");return{x:a,y:c}})),f=(0,y.x)((t=>{if(t.is0()){if(e.allowInfinityPoint&&!r.is0(t.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=t.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not FE");const s=r.sqr(i),a=o(n);if(!r.eql(s,a))throw new Error("bad point: equation left != right");if(!t.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));class h{constructor(t,e,n){if(this.px=t,this.py=e,this.pz=n,null==t||!r.isValid(t))throw new Error("x required");if(null==e||!r.isValid(e))throw new Error("y required");if(null==n||!r.isValid(n))throw new Error("z required");Object.freeze(this)}static fromAffine(t){const{x:e,y:n}=t||{};if(!t||!r.isValid(e)||!r.isValid(n))throw new Error("invalid affine point");if(t instanceof h)throw new Error("projective point not allowed");const i=t=>r.eql(t,r.ZERO);return i(e)&&i(n)?h.ZERO:new h(e,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=r.invertBatch(t.map((t=>t.pz)));return t.map(((t,r)=>t.toAffine(e[r]))).map(h.fromAffine)}static fromHex(t){const e=h.fromAffine(s((0,y.qj)("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return h.BASE.multiply(a(t))}static msm(t,e){return(0,B.Xf)(h,n,t,e)}_setWindowSize(t){d.setWindowSize(this,t)}assertValidity(){f(this)}hasEvenY(){const{y:t}=this.toAffine();if(r.isOdd)return!r.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){c(t);const{px:e,py:n,pz:i}=this,{px:s,py:o,pz:a}=t,u=r.eql(r.mul(e,a),r.mul(s,i)),f=r.eql(r.mul(n,a),r.mul(o,i));return u&&f}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){const{a:t,b:n}=e,i=r.mul(n,R),{px:s,py:o,pz:a}=this;let c=r.ZERO,u=r.ZERO,f=r.ZERO,l=r.mul(s,s),d=r.mul(o,o),p=r.mul(a,a),g=r.mul(s,o);return g=r.add(g,g),f=r.mul(s,a),f=r.add(f,f),c=r.mul(t,f),u=r.mul(i,p),u=r.add(c,u),c=r.sub(d,u),u=r.add(d,u),u=r.mul(c,u),c=r.mul(g,c),f=r.mul(i,f),p=r.mul(t,p),g=r.sub(l,p),g=r.mul(t,g),g=r.add(g,f),f=r.add(l,l),l=r.add(f,l),l=r.add(l,p),l=r.mul(l,g),u=r.add(u,l),p=r.mul(o,a),p=r.add(p,p),l=r.mul(p,g),c=r.sub(c,l),f=r.mul(p,d),f=r.add(f,f),f=r.add(f,f),new h(c,u,f)}add(t){c(t);const{px:n,py:i,pz:s}=this,{px:o,py:a,pz:u}=t;let f=r.ZERO,l=r.ZERO,d=r.ZERO;const p=e.a,g=r.mul(e.b,R);let y=r.mul(n,o),w=r.mul(i,a),b=r.mul(s,u),m=r.add(n,i),v=r.add(o,a);m=r.mul(m,v),v=r.add(y,w),m=r.sub(m,v),v=r.add(n,s);let E=r.add(o,u);return v=r.mul(v,E),E=r.add(y,b),v=r.sub(v,E),E=r.add(i,s),f=r.add(a,u),E=r.mul(E,f),f=r.add(w,b),E=r.sub(E,f),d=r.mul(p,v),f=r.mul(g,b),d=r.add(f,d),f=r.sub(w,d),d=r.add(w,d),l=r.mul(f,d),w=r.add(y,y),w=r.add(w,y),b=r.mul(p,b),v=r.mul(g,v),w=r.add(w,b),b=r.sub(y,b),b=r.mul(p,b),v=r.add(v,b),y=r.mul(w,v),l=r.add(l,y),y=r.mul(E,v),f=r.mul(m,f),f=r.sub(f,y),y=r.mul(m,w),d=r.mul(E,d),d=r.add(d,y),new h(f,l,d)}subtract(t){return this.add(t.negate())}is0(){return this.equals(h.ZERO)}wNAF(t){return d.wNAFCached(this,t,h.normalizeZ)}multiplyUnsafe(t){const{endo:n,n:i}=e;y.aK("scalar",t,S,i);const s=h.ZERO;if(t===S)return s;if(this.is0()||t===O)return this;if(!n||d.hasPrecomputes(this))return d.wNAFCachedUnsafe(this,t,h.normalizeZ);let{k1neg:o,k1:a,k2neg:c,k2:u}=n.splitScalar(t),f=s,l=s,p=this;for(;a>S||u>S;)a&O&&(f=f.add(p)),u&O&&(l=l.add(p)),p=p.double(),a>>=O,u>>=O;return o&&(f=f.negate()),c&&(l=l.negate()),l=new h(r.mul(l.px,n.beta),l.py,l.pz),f.add(l)}multiply(t){const{endo:n,n:i}=e;let s,o;if(y.aK("scalar",t,O,i),n){const{k1neg:e,k1:i,k2neg:a,k2:c}=n.splitScalar(t);let{p:u,f}=this.wNAF(i),{p:l,f:p}=this.wNAF(c);u=d.constTimeNegate(e,u),l=d.constTimeNegate(a,l),l=new h(r.mul(l.px,n.beta),l.py,l.pz),s=u.add(l),o=f.add(p)}else{const{p:e,f:r}=this.wNAF(t);s=e,o=r}return h.normalizeZ([s,o])[0]}multiplyAndAddUnsafe(t,e,r){const n=h.BASE,i=(t,e)=>e!==S&&e!==O&&t.equals(n)?t.multiply(e):t.multiplyUnsafe(e),s=i(this,e).add(i(t,r));return s.is0()?void 0:s}toAffine(t){return u(this,t)}isTorsionFree(){const{h:t,isTorsionFree:r}=e;if(t===O)return!0;if(r)return r(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:r}=e;return t===O?this:r?r(h,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return(0,y.e8)("isCompressed",t),this.assertValidity(),i(h,this,t)}toHex(t=!0){return(0,y.e8)("isCompressed",t),y.My(this.toRawBytes(t))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);const l=e.nBitLength,d=(0,B.hT)(h,e.endo?Math.ceil(l/2):l);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:a,weierstrassEquation:o,isWithinCurveOrder:function(t){return y.r4(t,O,e.n)}}}function k(t,e){if(g.jr(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const r=function(t,e){const r=t.ORDER;let n=S;for(let t=r-O;t%N===S;t/=N)n+=O;const i=n,s=N<<i-O-O,o=s*N,a=(r-O)/o,c=(a-O)/N,u=o-O,f=s,h=t.pow(e,a),l=t.pow(e,(a+O)/N);let d=(e,r)=>{let n=h,s=t.pow(r,u),o=t.sqr(s);o=t.mul(o,r);let a=t.mul(e,o);a=t.pow(a,c),a=t.mul(a,s),s=t.mul(a,r),o=t.mul(a,e);let d=t.mul(o,s);a=t.pow(d,f);let p=t.eql(a,t.ONE);s=t.mul(o,l),a=t.mul(d,n),o=t.cmov(s,o,p),d=t.cmov(a,d,p);for(let e=i;e>O;e--){let r=e-N;r=N<<r-O;let i=t.pow(d,r);const a=t.eql(i,t.ONE);s=t.mul(o,n),n=t.mul(n,n),i=t.mul(d,n),o=t.cmov(s,o,a),d=t.cmov(i,d,a)}return{isValid:p,value:o}};if(t.ORDER%U===R){const r=(t.ORDER-R)/U,n=t.sqrt(t.neg(e));d=(e,i)=>{let s=t.sqr(i);const o=t.mul(e,i);s=t.mul(s,o);let a=t.pow(s,r);a=t.mul(a,o);const c=t.mul(a,n),u=t.mul(t.sqr(a),i),f=t.eql(u,e);return{isValid:f,value:t.cmov(c,a,f)}}}return d}(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,s,o,a,c,u,f,h;i=t.sqr(n),i=t.mul(i,e.Z),s=t.sqr(i),s=t.add(s,i),o=t.add(s,t.ONE),o=t.mul(o,e.B),a=t.cmov(e.Z,t.neg(s),!t.eql(s,t.ZERO)),a=t.mul(a,e.A),s=t.sqr(o),u=t.sqr(a),c=t.mul(u,e.A),s=t.add(s,c),s=t.mul(s,o),u=t.mul(u,a),c=t.mul(u,e.B),s=t.add(s,c),f=t.mul(i,o);const{isValid:l,value:d}=r(s,u);h=t.mul(i,n),h=t.mul(h,d),f=t.cmov(f,o,l),h=t.cmov(h,d,l);const p=t.isOdd(n)===t.isOdd(h);return h=t.cmov(t.neg(h),h,p),f=t.div(f,a),{x:f,y:h}}}const j=BigInt(0),F=BigInt(1),L=BigInt(2),D=BigInt(3),C=BigInt(0),M=BigInt(1),q=BigInt(2),V=BigInt(3);function $(t,e,r,n,i=1,s){const o=BigInt(void 0===s?n:s),a=r**BigInt(n),c=[];for(let s=0;s<i;s++){const i=BigInt(s+1),u=[];for(let s=0,c=M;s<n;s++){const n=(i*c-i)/o%a;u.push(t.pow(e,n)),c*=r}c.push(u)}return c}const z=BigInt(0),G=BigInt(1),K=BigInt(2),W=BigInt(3),H=BigInt(4),Y=BigInt("0xd201000000010000"),Z=(0,y.dJ)(Y),{Fp:J,Fp2:X,Fp6:Q,Fp4Square:tt,Fp12:et}=function(t){const{ORDER:e}=t,r=g.D0(e),n=r.create(t.NONRESIDUE||BigInt(-1)),i=g.tB(e),s=r.div(r.ONE,q),o=$(r,n,r.ORDER,2)[0],a=({c0:t,c1:e},{c0:n,c1:i})=>({c0:r.add(t,n),c1:r.add(e,i)}),c=({c0:t,c1:e},{c0:n,c1:i})=>({c0:r.sub(t,n),c1:r.sub(e,i)}),u=({c0:t,c1:e},n)=>{if("bigint"==typeof n)return{c0:r.mul(t,n),c1:r.mul(e,n)};const{c0:i,c1:s}=n;let o=r.mul(t,i),a=r.mul(e,s);return{c0:r.sub(o,a),c1:r.sub(r.mul(r.add(t,e),r.add(i,s)),r.add(o,a))}},f=({c0:t,c1:e})=>{const n=r.add(t,e),i=r.sub(t,e),s=r.add(t,t);return{c0:r.mul(n,i),c1:r.mul(s,e)}},h=t=>{if(2!==t.length)throw new Error("invalid tuple");const e=t.map((t=>r.create(t)));return{c0:e[0],c1:e[1]}},l=e*e,d=h(t.FP2_NONRESIDUE),p={ORDER:l,NONRESIDUE:d,BITS:(0,y.dJ)(l),BYTES:Math.ceil((0,y.dJ)(l)/8),MASK:(0,y.OG)((0,y.dJ)(l)),ZERO:{c0:r.ZERO,c1:r.ZERO},ONE:{c0:r.ONE,c1:r.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>"bigint"==typeof t&&"bigint"==typeof e,is0:({c0:t,c1:e})=>r.is0(t)&&r.is0(e),eql:({c0:t,c1:e},{c0:n,c1:i})=>r.eql(t,n)&&r.eql(e,i),neg:({c0:t,c1:e})=>({c0:r.neg(t),c1:r.neg(e)}),pow:(t,e)=>g.f4(p,t,e),invertBatch:t=>g.pS(p,t),add:a,sub:c,mul:u,sqr:f,addN:a,subN:c,mulN:u,sqrN:f,div:(t,e)=>p.mul(t,"bigint"==typeof e?r.inv(r.create(e)):p.inv(e)),inv:({c0:t,c1:e})=>{const n=r.inv(r.create(t*t+e*e));return{c0:r.mul(n,r.create(t)),c1:r.mul(n,r.create(-e))}},sqrt:e=>{if(t.Fp2sqrt)return t.Fp2sqrt(e);const{c0:o,c1:a}=e;if(r.is0(a))return r.eql(i(r,o),r.ONE)?p.create({c0:r.sqrt(o),c1:r.ZERO}):p.create({c0:r.ZERO,c1:r.sqrt(r.div(o,n))});const c=r.sqrt(r.sub(r.sqr(o),r.mul(r.sqr(a),n)));let u=r.mul(r.add(c,o),s);const f=i(r,u);r.is0(f)||r.eql(f,r.ONE)||(u=r.sub(u,c));const h=r.sqrt(u),l=p.create({c0:h,c1:r.div(r.mul(a,s),h)});if(!p.eql(p.sqr(l),e))throw new Error("Cannot find square root");const d=l,g=p.neg(d),{re:y,im:w}=p.reim(d),{re:b,im:m}=p.reim(g);return w>m||w===m&&y>b?d:g},isOdd:t=>{const{re:e,im:r}=p.reim(t);return BigInt(e%q||e===C&&r%q)==M},fromBytes(t){if(t.length!==p.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:r.fromBytes(t.subarray(0,r.BYTES)),c1:r.fromBytes(t.subarray(r.BYTES))}},toBytes:({c0:t,c1:e})=>(0,y.Id)(r.toBytes(t),r.toBytes(e)),cmov:({c0:t,c1:e},{c0:n,c1:i},s)=>({c0:r.cmov(t,n,s),c1:r.cmov(e,i,s)}),reim:({c0:t,c1:e})=>({re:t,im:e}),mulByNonresidue:({c0:t,c1:e})=>p.mul({c0:t,c1:e},d),mulByB:t.Fp2mulByB,fromBigTuple:h,frobeniusMap:({c0:t,c1:e},n)=>({c0:t,c1:r.mul(e,o[n%2])})},w=({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:s})=>({c0:p.add(t,n),c1:p.add(e,i),c2:p.add(r,s)}),b=({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:s})=>({c0:p.sub(t,n),c1:p.sub(e,i),c2:p.sub(r,s)}),m=({c0:t,c1:e,c2:r},n)=>{if("bigint"==typeof n)return{c0:p.mul(t,n),c1:p.mul(e,n),c2:p.mul(r,n)};const{c0:i,c1:s,c2:o}=n,a=p.mul(t,i),c=p.mul(e,s),u=p.mul(r,o);return{c0:p.add(a,p.mulByNonresidue(p.sub(p.mul(p.add(e,r),p.add(s,o)),p.add(c,u)))),c1:p.add(p.sub(p.mul(p.add(t,e),p.add(i,s)),p.add(a,c)),p.mulByNonresidue(u)),c2:p.sub(p.add(c,p.mul(p.add(t,r),p.add(i,o))),p.add(a,u))}},v=({c0:t,c1:e,c2:r})=>{let n=p.sqr(t),i=p.mul(p.mul(t,e),q),s=p.mul(p.mul(e,r),q),o=p.sqr(r);return{c0:p.add(p.mulByNonresidue(s),n),c1:p.add(p.mulByNonresidue(o),i),c2:p.sub(p.sub(p.add(p.add(i,p.sqr(p.add(p.sub(t,e),r))),s),n),o)}},[E,_]=$(p,d,r.ORDER,6,2,3),I={ORDER:p.ORDER,BITS:3*p.BITS,BYTES:3*p.BYTES,MASK:(0,y.OG)(3*p.BITS),ZERO:{c0:p.ZERO,c1:p.ZERO,c2:p.ZERO},ONE:{c0:p.ONE,c1:p.ZERO,c2:p.ZERO},create:t=>t,isValid:({c0:t,c1:e,c2:r})=>p.isValid(t)&&p.isValid(e)&&p.isValid(r),is0:({c0:t,c1:e,c2:r})=>p.is0(t)&&p.is0(e)&&p.is0(r),neg:({c0:t,c1:e,c2:r})=>({c0:p.neg(t),c1:p.neg(e),c2:p.neg(r)}),eql:({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:s})=>p.eql(t,n)&&p.eql(e,i)&&p.eql(r,s),sqrt:y.SJ,div:(t,e)=>I.mul(t,"bigint"==typeof e?r.inv(r.create(e)):I.inv(e)),pow:(t,e)=>g.f4(I,t,e),invertBatch:t=>g.pS(I,t),add:w,sub:b,mul:m,sqr:v,addN:w,subN:b,mulN:m,sqrN:v,inv:({c0:t,c1:e,c2:r})=>{let n=p.sub(p.sqr(t),p.mulByNonresidue(p.mul(r,e))),i=p.sub(p.mulByNonresidue(p.sqr(r)),p.mul(t,e)),s=p.sub(p.sqr(e),p.mul(t,r)),o=p.inv(p.add(p.mulByNonresidue(p.add(p.mul(r,i),p.mul(e,s))),p.mul(t,n)));return{c0:p.mul(o,n),c1:p.mul(o,i),c2:p.mul(o,s)}},fromBytes:t=>{if(t.length!==I.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:p.fromBytes(t.subarray(0,p.BYTES)),c1:p.fromBytes(t.subarray(p.BYTES,2*p.BYTES)),c2:p.fromBytes(t.subarray(2*p.BYTES))}},toBytes:({c0:t,c1:e,c2:r})=>(0,y.Id)(p.toBytes(t),p.toBytes(e),p.toBytes(r)),cmov:({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:s},o)=>({c0:p.cmov(t,n,o),c1:p.cmov(e,i,o),c2:p.cmov(r,s,o)}),fromBigSix:t=>{if(!Array.isArray(t)||6!==t.length)throw new Error("invalid Fp6 usage");return{c0:p.fromBigTuple(t.slice(0,2)),c1:p.fromBigTuple(t.slice(2,4)),c2:p.fromBigTuple(t.slice(4,6))}},frobeniusMap:({c0:t,c1:e,c2:r},n)=>({c0:p.frobeniusMap(t,n),c1:p.mul(p.frobeniusMap(e,n),E[n%6]),c2:p.mul(p.frobeniusMap(r,n),_[n%6])}),mulByFp2:({c0:t,c1:e,c2:r},n)=>({c0:p.mul(t,n),c1:p.mul(e,n),c2:p.mul(r,n)}),mulByNonresidue:({c0:t,c1:e,c2:r})=>({c0:p.mulByNonresidue(r),c1:t,c2:e}),mul1:({c0:t,c1:e,c2:r},n)=>({c0:p.mulByNonresidue(p.mul(r,n)),c1:p.mul(t,n),c2:p.mul(e,n)}),mul01({c0:t,c1:e,c2:r},n,i){let s=p.mul(t,n),o=p.mul(e,i);return{c0:p.add(p.mulByNonresidue(p.sub(p.mul(p.add(e,r),i),o)),s),c1:p.sub(p.sub(p.mul(p.add(n,i),p.add(t,e)),s),o),c2:p.add(p.sub(p.mul(p.add(t,r),n),s),o)}}},B=$(p,d,r.ORDER,12,1,6)[0],x=({c0:t,c1:e},{c0:r,c1:n})=>({c0:I.add(t,r),c1:I.add(e,n)}),A=({c0:t,c1:e},{c0:r,c1:n})=>({c0:I.sub(t,r),c1:I.sub(e,n)}),T=({c0:t,c1:e},r)=>{if("bigint"==typeof r)return{c0:I.mul(t,r),c1:I.mul(e,r)};let{c0:n,c1:i}=r,s=I.mul(t,n),o=I.mul(e,i);return{c0:I.add(s,I.mulByNonresidue(o)),c1:I.sub(I.mul(I.add(t,e),I.add(n,i)),I.add(s,o))}},S=({c0:t,c1:e})=>{let r=I.mul(t,e);return{c0:I.sub(I.sub(I.mul(I.add(I.mulByNonresidue(e),t),I.add(t,e)),r),I.mulByNonresidue(r)),c1:I.add(r,r)}},O={ORDER:p.ORDER,BITS:2*p.BITS,BYTES:2*p.BYTES,MASK:(0,y.OG)(2*p.BITS),ZERO:{c0:I.ZERO,c1:I.ZERO},ONE:{c0:I.ONE,c1:I.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>I.isValid(t)&&I.isValid(e),is0:({c0:t,c1:e})=>I.is0(t)&&I.is0(e),neg:({c0:t,c1:e})=>({c0:I.neg(t),c1:I.neg(e)}),eql:({c0:t,c1:e},{c0:r,c1:n})=>I.eql(t,r)&&I.eql(e,n),sqrt:y.SJ,inv:({c0:t,c1:e})=>{let r=I.inv(I.sub(I.sqr(t),I.mulByNonresidue(I.sqr(e))));return{c0:I.mul(t,r),c1:I.neg(I.mul(e,r))}},div:(t,e)=>O.mul(t,"bigint"==typeof e?r.inv(r.create(e)):O.inv(e)),pow:(t,e)=>g.f4(O,t,e),invertBatch:t=>g.pS(O,t),add:x,sub:A,mul:T,sqr:S,addN:x,subN:A,mulN:T,sqrN:S,fromBytes:t=>{if(t.length!==O.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:I.fromBytes(t.subarray(0,I.BYTES)),c1:I.fromBytes(t.subarray(I.BYTES))}},toBytes:({c0:t,c1:e})=>(0,y.Id)(I.toBytes(t),I.toBytes(e)),cmov:({c0:t,c1:e},{c0:r,c1:n},i)=>({c0:I.cmov(t,r,i),c1:I.cmov(e,n,i)}),fromBigTwelve:t=>({c0:I.fromBigSix(t.slice(0,6)),c1:I.fromBigSix(t.slice(6,12))}),frobeniusMap(t,e){const{c0:r,c1:n,c2:i}=I.frobeniusMap(t.c1,e),s=B[e%12];return{c0:I.frobeniusMap(t.c0,e),c1:I.create({c0:p.mul(r,s),c1:p.mul(n,s),c2:p.mul(i,s)})}},mulByFp2:({c0:t,c1:e},r)=>({c0:I.mulByFp2(t,r),c1:I.mulByFp2(e,r)}),conjugate:({c0:t,c1:e})=>({c0:t,c1:I.neg(e)}),mul014:({c0:t,c1:e},r,n,i)=>{let s=I.mul01(t,r,n),o=I.mul1(e,i);return{c0:I.add(I.mulByNonresidue(o),s),c1:I.sub(I.sub(I.mul01(I.add(e,t),r,p.add(n,i)),s),o)}},mul034:({c0:t,c1:e},r,n,i)=>{const s=I.create({c0:p.mul(t.c0,r),c1:p.mul(t.c1,r),c2:p.mul(t.c2,r)}),o=I.mul01(e,n,i),a=I.mul01(I.add(t,e),p.add(r,n),i);return{c0:I.add(I.mulByNonresidue(o),s),c1:I.sub(a,I.add(s,o))}},_cyclotomicSquare:t.Fp12cyclotomicSquare,_cyclotomicExp:t.Fp12cyclotomicExp,finalExponentiate:t.Fp12finalExponentiate};return{Fp:r,Fp2:p,Fp6:I,Fp4Square:function(t,e){const r=p.sqr(t),n=p.sqr(e);return{first:p.add(p.mulByNonresidue(n),r),second:p.sub(p.sub(p.sqr(p.add(t,e)),r),n)}},Fp12:O}}({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[G,G],Fp2mulByB:({c0:t,c1:e})=>{const r=J.mul(t,H),n=J.mul(e,H);return{c0:J.sub(r,n),c1:J.add(r,n)}},Fp12cyclotomicSquare:({c0:t,c1:e})=>{const{c0:r,c1:n,c2:i}=t,{c0:s,c1:o,c2:a}=e,{first:c,second:u}=tt(r,o),{first:f,second:h}=tt(s,i),{first:l,second:d}=tt(n,a),p=X.mulByNonresidue(d);return{c0:Q.create({c0:X.add(X.mul(X.sub(c,r),K),c),c1:X.add(X.mul(X.sub(f,n),K),f),c2:X.add(X.mul(X.sub(l,i),K),l)}),c1:Q.create({c0:X.add(X.mul(X.add(p,s),K),p),c1:X.add(X.mul(X.add(u,o),K),u),c2:X.add(X.mul(X.add(h,a),K),h)})}},Fp12cyclotomicExp(t,e){let r=et.ONE;for(let n=Z-1;n>=0;n--)r=et._cyclotomicSquare(r),(0,y.GU)(e,n)&&(r=et.mul(r,t));return r},Fp12finalExponentiate:t=>{const e=Y,r=et.div(et.frobeniusMap(t,6),t),n=et.mul(et.frobeniusMap(r,2),r),i=et.conjugate(et._cyclotomicExp(n,e)),s=et.mul(et.conjugate(et._cyclotomicSquare(n)),i),o=et.conjugate(et._cyclotomicExp(s,e)),a=et.conjugate(et._cyclotomicExp(o,e)),c=et.mul(et.conjugate(et._cyclotomicExp(a,e)),et._cyclotomicSquare(i)),u=et.conjugate(et._cyclotomicExp(c,e)),f=et.frobeniusMap(et.mul(i,a),2),h=et.frobeniusMap(et.mul(o,n),3),l=et.frobeniusMap(et.mul(c,et.conjugate(n)),1),d=et.mul(et.mul(u,et.conjugate(s)),n);return et.mul(et.mul(et.mul(f,h),l),d)}}),rt=g.D0(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),nt=_(X,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map((t=>t.map((t=>X.fromBigTuple(t.map(BigInt))))))),it=_(J,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map((t=>t.map((t=>BigInt(t)))))),st=k(X,{A:X.create({c0:J.create(z),c1:J.create(BigInt(240))}),B:X.create({c0:J.create(BigInt(1012)),c1:J.create(BigInt(1012))}),Z:X.create({c0:J.create(BigInt(-2)),c1:J.create(BigInt(-1))})}),ot=k(J,{A:J.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:J.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:J.create(BigInt(11))}),{G2psi:at,G2psi2:ct}=function(t,e,r){const n=e.pow(r,(t.ORDER-M)/V),i=e.pow(r,(t.ORDER-M)/q);function s(t,r){return[e.mul(e.frobeniusMap(t,1),n),e.mul(e.frobeniusMap(r,1),i)]}const o=e.pow(r,(t.ORDER**q-M)/V),a=e.pow(r,(t.ORDER**q-M)/q);if(!e.eql(a,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function c(t,r){return[e.mul(t,o),e.neg(r)]}const u=t=>(e,r)=>{const n=r.toAffine(),i=t(n.x,n.y);return e.fromAffine({x:i[0],y:i[1]})};return{psi:s,psi2:c,G2psi:u(s),G2psi2:u(c),PSI_X:n,PSI_Y:i,PSI2_X:o,PSI2_Y:a}}(J,X,X.div(X.ONE,X.NONRESIDUE)),ut=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:J.ORDER,m:2,k:128,expand:"xmd",hash:p}),ft=lt(J.toBytes(z),{infinity:!0,compressed:!0});function ht(t){const e=224&(t=t.slice())[0],r=!!(e>>7&1),n=!!(e>>6&1),i=!!(e>>5&1);return t[0]&=31,{compressed:r,infinity:n,sort:i,value:t}}function lt(t,e){if(224&t[0])throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function dt(t){t.assertValidity();const e=t.equals(gt.G1.ProjectivePoint.ZERO),{x:r,y:n}=t.toAffine();if(e)return ft.slice();const i=J.ORDER,s=Boolean(n*K/i);return lt((0,y.lq)(r,J.BYTES),{compressed:!0,sort:s})}function pt(t){t.assertValidity();const e=J.BYTES;if(t.equals(gt.G2.ProjectivePoint.ZERO))return(0,y.Id)(ft,(0,y.lq)(z,e));const{x:r,y:n}=t.toAffine(),{re:i,im:s}=X.reim(r),{re:o,im:a}=X.reim(n),c=Boolean((a>z?a*K:o*K)/J.ORDER&G),u=i;return(0,y.Id)(lt((0,y.lq)(s,e),{sort:c,compressed:!0}),(0,y.lq)(u,e))}const gt=function(t){const{Fp:e,Fr:r,Fp2:n,Fp6:i,Fp12:s}=t.fields,o=t.params.xNegative,a=t.params.twistType,c=P({n:r.ORDER,...t.G1}),u=Object.assign(c,I(c.ProjectivePoint,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),f=P({n:r.ORDER,...t.G2}),h=Object.assign(f,I(f.ProjectivePoint,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults}));let l;if("multiplicative"===a)l=(t,e,r,i,o,a)=>s.mul014(i,t,n.mul(e,o),n.mul(r,a));else{if("divisive"!==a)throw new Error("bls: unknown twist type");l=(t,e,r,i,o,a)=>s.mul034(i,n.mul(r,a),n.mul(e,o),t)}const d=n.div(n.ONE,n.mul(n.ONE,L));function p(t,e,r,i){const s=n.sqr(r),o=n.sqr(i),a=n.mulByB(n.mul(o,D)),c=n.mul(a,D),u=n.sub(n.sub(n.sqr(n.add(r,i)),o),s),f=n.sub(a,s),h=n.mul(n.sqr(e),D),l=n.neg(u);return t.push([f,h,l]),{Rx:e=n.mul(n.mul(n.mul(n.sub(s,c),e),r),d),Ry:r=n.sub(n.sqr(n.mul(n.add(s,c),d)),n.mul(n.sqr(a),D)),Rz:i=n.mul(s,u)}}function w(t,e,r,i,s,o){const a=n.sub(r,n.mul(o,i)),c=n.sub(e,n.mul(s,i)),u=n.sub(n.mul(a,s),n.mul(c,o)),f=n.neg(a),h=c;t.push([u,f,h]);const l=n.sqr(c),d=n.mul(l,c),p=n.mul(l,e),g=n.add(n.sub(d,n.mul(p,L)),n.mul(n.sqr(a),i));return{Rx:e=n.mul(c,g),Ry:r=n.sub(n.mul(n.sub(p,g),a),n.mul(d,r)),Rz:i=n.mul(i,d)}}const b=function(t){const e=[];for(;t>F;t>>=F)(t&F)===j?e.unshift(0):(t&D)===D?(e.unshift(-1),t+=F):e.unshift(1);return e}(t.params.ateLoopSize),m=(0,y.x)((e=>{const r=e,{x:i,y:s}=r.toAffine(),o=i,a=s,c=n.neg(s);let u=o,f=a,h=n.ONE;const l=[];for(const t of b){const e=[];({Rx:u,Ry:f,Rz:h}=p(e,u,f,h)),t&&({Rx:u,Ry:f,Rz:h}=w(e,u,f,h,o,-1===t?c:a)),l.push(e)}if(t.postPrecompute){const e=l[l.length-1];t.postPrecompute(u,f,h,o,a,w.bind(null,e))}return l}));function v(t,e=!1){let r=s.ONE;if(t.length){const e=t[0][0].length;for(let n=0;n<e;n++){r=s.sqr(r);for(const[e,i,s]of t)for(const[t,o,a]of e[n])r=l(t,o,a,r,i,s)}}return o&&(r=s.conjugate(r)),e?s.finalExponentiate(r):r}function E(t,e=!0){const r=[];u.ProjectivePoint.normalizeZ(t.map((({g1:t})=>t))),h.ProjectivePoint.normalizeZ(t.map((({g2:t})=>t)));for(const{g1:e,g2:n}of t){if(e.equals(u.ProjectivePoint.ZERO)||n.equals(h.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");e.assertValidity(),n.assertValidity();const t=e.toAffine();r.push([m(n),t.x,t.y])}return v(r,e)}const _={randomPrivateKey:()=>{const e=(0,g.Tp)(r.ORDER);return(0,g.qy)(t.randomBytes(e),r.ORDER)},calcPairingPrecomputes:m},{ShortSignature:B}=t.G1,{Signature:x}=t.G2;function A(t){return t instanceof u.ProjectivePoint?t:u.ProjectivePoint.fromHex(t)}function T(t,e){return t instanceof u.ProjectivePoint?t:u.hashToCurve((0,y.qj)("point",t),e)}function S(t){return t instanceof h.ProjectivePoint?t:x.fromHex(t)}function O(t,e){return t instanceof h.ProjectivePoint?t:h.hashToCurve((0,y.qj)("point",t),e)}function N(t){if(!Array.isArray(t)||0===t.length)throw new Error("expected non-empty array")}return u.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:function(t){return u.ProjectivePoint.fromPrivateKey(t).toRawBytes(!0)},getPublicKeyForShortSignatures:function(t){return h.ProjectivePoint.fromPrivateKey(t).toRawBytes(!0)},sign:function(t,e,r){const n=O(t,r);n.assertValidity();const i=n.multiply(u.normPrivateKeyToScalar(e));return t instanceof h.ProjectivePoint?i:x.toRawBytes(i)},signShortSignature:function(t,e,r){const n=T(t,r);n.assertValidity();const i=n.multiply(u.normPrivateKeyToScalar(e));return t instanceof u.ProjectivePoint?i:B.toRawBytes(i)},verify:function(t,e,r,n){const i=A(r),o=O(e,n),a=u.ProjectivePoint.BASE,c=S(t),f=E([{g1:i.negate(),g2:o},{g1:a,g2:c}]);return s.eql(f,s.ONE)},verifyBatch:function(t,e,r,n){if(N(e),r.length!==e.length)throw new Error("amount of public keys and messages should be equal");const i=S(t),o=e.map((t=>O(t,n))),a=r.map(A),c=new Map;for(let t=0;t<a.length;t++){const e=a[t],r=o[t];let n=c.get(r);void 0===n&&(n=[],c.set(r,n)),n.push(e)}const f=[];try{for(const[t,e]of c){const r=e.reduce(((t,e)=>t.add(e)));f.push({g1:r,g2:t})}return f.push({g1:u.ProjectivePoint.BASE.negate(),g2:i}),s.eql(E(f),s.ONE)}catch{return!1}},verifyShortSignature:function(t,e,r,n){const i=S(r),o=T(e,n),a=h.ProjectivePoint.BASE,c=E([{g1:o,g2:i},{g1:A(t),g2:a.negate()}]);return s.eql(c,s.ONE)},aggregatePublicKeys:function(t){N(t);const e=t.map(A).reduce(((t,e)=>t.add(e)),u.ProjectivePoint.ZERO);return t[0]instanceof u.ProjectivePoint?(e.assertValidity(),e):e.toRawBytes(!0)},aggregateSignatures:function(t){N(t);const e=t.map(S).reduce(((t,e)=>t.add(e)),h.ProjectivePoint.ZERO);return t[0]instanceof h.ProjectivePoint?(e.assertValidity(),e):x.toRawBytes(e)},aggregateShortSignatures:function(t){N(t);const e=t.map(A).reduce(((t,e)=>t.add(e)),u.ProjectivePoint.ZERO);return t[0]instanceof u.ProjectivePoint?(e.assertValidity(),e):B.toRawBytes(e)},millerLoopBatch:v,pairing:function(t,e,r=!0){return E([{g1:t,g2:e}],r)},pairingBatch:E,G1:u,G2:h,Signature:x,ShortSignature:B,fields:{Fr:r,Fp:e,Fp2:n,Fp6:i,Fp12:s},params:{ateLoopSize:t.params.ateLoopSize,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:_}}({fields:{Fp:J,Fp2:X,Fp6:Q,Fp12:et,Fr:rt},G1:{Fp:J,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:J.ZERO,b:H,htfDefaults:{...ut,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const r=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new t(J.mul(e.px,r),e.py,e.pz);return e.multiplyUnsafe(Y).negate().multiplyUnsafe(Y).equals(n)},clearCofactor:(t,e)=>e.multiplyUnsafe(Y).add(e),mapToCurve:t=>{const{x:e,y:r}=ot(J.create(t[0]));return it(e,r)},fromBytes:t=>{const{compressed:e,infinity:r,sort:n,value:i}=ht(t);if(48===i.length&&e){const t=J.ORDER,e=(0,y.Ph)(i),s=J.create(e&J.MASK);if(r){if(s!==z)throw new Error("G1: non-empty compressed point at infinity");return{x:z,y:z}}const o=J.add(J.pow(s,W),J.create(gt.params.G1b));let a=J.sqrt(o);if(!a)throw new Error("invalid compressed G1 point");return a*K/t!==BigInt(n)&&(a=J.neg(a)),{x:J.create(s),y:J.create(a)}}if(96!==i.length||e)throw new Error("invalid point G1, expected 48/96 bytes");{const t=(0,y.Ph)(i.subarray(0,J.BYTES)),e=(0,y.Ph)(i.subarray(J.BYTES));if(r){if(t!==z||e!==z)throw new Error("G1: non-empty point at infinity");return gt.G1.ProjectivePoint.ZERO.toAffine()}return{x:J.create(t),y:J.create(e)}}},toBytes:(t,e,r)=>{const n=e.equals(t.ZERO),{x:i,y:s}=e.toAffine();if(r){if(n)return ft.slice();const t=J.ORDER,e=Boolean(s*K/t);return lt((0,y.lq)(i,J.BYTES),{compressed:!0,sort:e})}return n?(0,y.Id)(new Uint8Array([64]),new Uint8Array(2*J.BYTES-1)):(0,y.Id)((0,y.lq)(i,J.BYTES),(0,y.lq)(s,J.BYTES))},ShortSignature:{fromHex(t){const{infinity:e,sort:r,value:n}=ht((0,y.qj)("signatureHex",t,48)),i=J.ORDER,s=(0,y.Ph)(n);if(e)return gt.G1.ProjectivePoint.ZERO;const o=J.create(s&J.MASK),a=J.add(J.pow(o,W),J.create(gt.params.G1b));let c=J.sqrt(a);if(!c)throw new Error("invalid compressed G1 point");const u=BigInt(r);c*K/i!==u&&(c=J.neg(c));const f=gt.G1.ProjectivePoint.fromAffine({x:o,y:c});return f.assertValidity(),f},toRawBytes:t=>dt(t),toHex:t=>(0,y.My)(dt(t))}},G2:{Fp:X,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:X.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:X.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:X.ZERO,b:X.fromBigTuple([H,H]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...ut},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:t=>{const{x:e,y:r}=st(X.fromBigTuple(t));return nt(e,r)},isTorsionFree:(t,e)=>e.multiplyUnsafe(Y).negate().equals(at(t,e)),clearCofactor:(t,e)=>{const r=Y;let n=e.multiplyUnsafe(r).negate(),i=at(t,e),s=e.double();return s=ct(t,s),s=s.subtract(i),i=n.add(i),i=i.multiplyUnsafe(r).negate(),s=s.add(i),s=s.subtract(n),s.subtract(e)},fromBytes:t=>{const{compressed:e,infinity:r,sort:n,value:i}=ht(t);if(!e&&!r&&n||!e&&r&&n||n&&r&&e)throw new Error("invalid encoding flag: "+(224&t[0]));const s=J.BYTES,o=(t,e,r)=>(0,y.Ph)(t.slice(e,r));if(96===i.length&&e){const t=gt.params.G2b,e=J.ORDER;if(r){if(i.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid compressed G2 point");return{x:X.ZERO,y:X.ZERO}}const a=o(i,0,s),c=o(i,s,2*s),u=X.create({c0:J.create(c),c1:J.create(a)}),f=X.add(X.pow(u,W),t);let h=X.sqrt(f);const l=h.c1===z?h.c0*K/e:h.c1*K/e?G:z;return h=n&&l>0?h:X.neg(h),{x:u,y:h}}if(192!==i.length||e)throw new Error("invalid point G2, expected 96/192 bytes");{if(r){if(i.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid uncompressed G2 point");return{x:X.ZERO,y:X.ZERO}}const t=o(i,0,s),e=o(i,s,2*s),n=o(i,2*s,3*s),a=o(i,3*s,4*s);return{x:X.fromBigTuple([e,t]),y:X.fromBigTuple([a,n])}}},toBytes:(t,e,r)=>{const{BYTES:n,ORDER:i}=J,s=e.equals(t.ZERO),{x:o,y:a}=e.toAffine();if(r){if(s)return(0,y.Id)(ft,(0,y.lq)(z,n));const t=Boolean(a.c1===z?a.c0*K/i:a.c1*K/i);return(0,y.Id)(lt((0,y.lq)(o.c1,n),{compressed:!0,sort:t}),(0,y.lq)(o.c0,n))}{if(s)return(0,y.Id)(new Uint8Array([64]),new Uint8Array(4*n-1));const{re:t,im:e}=X.reim(o),{re:r,im:i}=X.reim(a);return(0,y.Id)((0,y.lq)(e,n),(0,y.lq)(t,n),(0,y.lq)(i,n),(0,y.lq)(r,n))}},Signature:{fromHex(t){const{infinity:e,sort:r,value:n}=ht((0,y.qj)("signatureHex",t)),i=J.ORDER,s=n.length/2;if(48!==s&&96!==s)throw new Error("invalid compressed signature length, must be 96 or 192");const o=(0,y.Ph)(n.slice(0,s)),a=(0,y.Ph)(n.slice(s));if(e)return gt.G2.ProjectivePoint.ZERO;const c=J.create(o&J.MASK),u=J.create(a),f=X.create({c0:u,c1:c}),h=X.add(X.pow(f,W),gt.params.G2b);let l=X.sqrt(h);if(!l)throw new Error("Failed to find a square root");const{re:d,im:p}=X.reim(l),g=BigInt(r);(p>z&&p*K/i!==g||p===z&&d*K/i!==g)&&(l=X.neg(l));const w=gt.G2.ProjectivePoint.fromAffine({x:f,y:l});return w.assertValidity(),w},toRawBytes:t=>pt(t),toHex:t=>(0,y.My)(pt(t))}},params:{ateLoopSize:Y,r:rt.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:ut,hash:p,randomBytes:u.po});function yt(t,e,r){const n="string"==typeof t?t:(0,o.nj)(t),i="string"==typeof e?e:(0,o.nj)(e),s="string"==typeof r?r:(0,o.nj)(r);return gt.verifyShortSignature(i,s,n)}var wt,bt=r(345),mt=r(485);class vt extends i.Yv{constructor(t){super(`Invalid certificate: ${t}`)}}!function(t){t[t.Empty=0]="Empty",t[t.Fork=1]="Fork",t[t.Labeled=2]="Labeled",t[t.Leaf=3]="Leaf",t[t.Pruned=4]="Pruned"}(wt||(wt={}));class Et{constructor(t,e,r,i,s=5){this._rootKey=e,this._canisterId=r,this._blsVerify=i,this._maxAgeInMinutes=s,this.cert=n.D4(new Uint8Array(t))}static async create(t){const e=Et.createUnverified(t);return await e.verify(),e}static createUnverified(t){let e=t.blsVerify;return e||(e=yt),new Et(t.certificate,t.rootKey,t.canisterId,e,t.maxAgeInMinutes)}lookup(t){return Ot(t,this.cert.tree)}lookup_label(t){return this.lookup([t])}async verify(){const t=await xt(this.cert.tree),e=await this._checkDelegationAndGetKey(this.cert.delegation),r=this.cert.signature,n=function(t){const e=_t.byteLength+It;if(t.byteLength!==e)throw new TypeError(`BLS DER-encoded public key must be ${e} bytes long`);const r=t.slice(0,_t.byteLength);if(!(0,o.HA)(r,_t))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${_t}, but get ${r}`);return t.slice(_t.byteLength)}(e),i=(0,o.xW)(At("ic-state-root"),t);let s=!1;const a=Bt(this.lookup(["time"]));if(!a)throw new vt("Certificate does not contain a time");const c=60*this._maxAgeInMinutes*1e3,u=Date.now(),f=u-c,h=u+3e5,l=(0,bt.A)(a);if(l.getTime()<f)throw new vt(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+l.toISOString()+" Current time: "+new Date(u).toISOString());if(l.getTime()>h)throw new vt("Certificate is signed more than 5 minutes in the future. Certificate time: "+l.toISOString()+" Current time: "+new Date(u).toISOString());try{s=await this._blsVerify(new Uint8Array(n),new Uint8Array(r),new Uint8Array(i))}catch(t){s=!1}if(!s)throw new vt("Signature verification failed")}async _checkDelegationAndGetKey(t){if(!t)return this._rootKey;const e=await Et.createUnverified({certificate:t.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(e.cert.delegation)throw new vt("Delegation certificates cannot be nested");if(await e.verify(),this._canisterId.toString()!==mt.GZ&&!Ut({canisterId:this._canisterId,subnetId:a.p.fromUint8Array(new Uint8Array(t.subnet_id)),tree:e.cert.tree}))throw new vt(`Canister ${this._canisterId} not in range of delegations for subnet 0x${(0,o.nj)(t.subnet_id)}`);const r=Bt(e.lookup(["subnet",t.subnet_id,"public_key"]));if(!r)throw new Error(`Could not find subnet key for subnet 0x${(0,o.nj)(t.subnet_id)}`);return r}}const _t=(0,o.aD)("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),It=96;function Bt(t){if(t.status===Tt.Found)return t.value instanceof ArrayBuffer?t.value:t.value instanceof Uint8Array?t.value.buffer:void 0}async function xt(t){switch(t[0]){case wt.Empty:return(0,s.tW)(At("ic-hashtree-empty"));case wt.Pruned:return t[1];case wt.Leaf:return(0,s.tW)((0,o.xW)(At("ic-hashtree-leaf"),t[1]));case wt.Labeled:return(0,s.tW)((0,o.xW)(At("ic-hashtree-labeled"),t[1],await xt(t[2])));case wt.Fork:return(0,s.tW)((0,o.xW)(At("ic-hashtree-fork"),await xt(t[1]),await xt(t[2])));default:throw new Error("unreachable")}}function At(t){const e=new Uint8Array([t.length]),r=(new TextEncoder).encode(t);return(0,o.xW)(e,r)}var Tt,St;function Ot(t,e){if(0===t.length){if(e[0]===wt.Leaf){if(!e[1])throw new Error("Invalid tree structure for leaf");return e[1]instanceof ArrayBuffer?{status:Tt.Found,value:e[1]}:e[1]instanceof Uint8Array?{status:Tt.Found,value:e[1].buffer}:{status:Tt.Found,value:e[1]}}return{status:Tt.Found,value:e}}const r=Rt("string"==typeof t[0]?(new TextEncoder).encode(t[0]):t[0],e);switch(r.status){case Tt.Found:return Ot(t.slice(1),r.value);case St.Greater:case St.Less:return{status:Tt.Absent};default:return r}}function Nt(t){switch(t[0]){case wt.Empty:return[];case wt.Fork:return Nt(t[1]).concat(Nt(t[2]));default:return[t]}}function Rt(t,e){switch(e[0]){case wt.Labeled:return function(t,e){const r=new Uint8Array(t),n=new Uint8Array(e);for(let t=0;t<r.length;t++)if(r[t]>n[t])return!0;return!1}(t,e[1])?{status:St.Greater}:(0,o.HA)(t,e[1])?{status:Tt.Found,value:e[2]}:{status:St.Less};case wt.Fork:const r=Rt(t,e[1]);switch(r.status){case St.Greater:{const r=Rt(t,e[2]);return r.status===St.Less?{status:Tt.Absent}:r}case Tt.Unknown:{let r=Rt(t,e[2]);return r.status===St.Less?{status:Tt.Unknown}:r}default:return r}case wt.Pruned:return{status:Tt.Unknown};default:return{status:Tt.Absent}}}function Ut(t){const{canisterId:e,subnetId:r,tree:i}=t,s=Ot(["subnet",r.toUint8Array(),"canister_ranges"],i);if(s.status!==Tt.Found||!(s.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${r}`);return n.D4(s.value).map((t=>[a.p.fromUint8Array(t[0]),a.p.fromUint8Array(t[1])])).some((t=>t[0].ltEq(e)&&t[1].gtEq(e)))}!function(t){t.Unknown="unknown",t.Absent="absent",t.Found="found"}(Tt||(Tt={})),function(t){t.Less="less",t.Greater="greater"}(St||(St={}))},373:(t,e,r)=>{"use strict";r.d(e,{j:()=>n});const n=3e5},919:(t,e,r)=>{"use strict";r.d(e,{C2:()=>u,WQ:()=>a,le:()=>c,n9:()=>f});var n=r(338);const i=t=>{if(t<=127)return 1;if(t<=255)return 2;if(t<=65535)return 3;if(t<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},s=(t,e,r)=>{if(r<=127)return t[e]=r,1;if(r<=255)return t[e]=129,t[e+1]=r,2;if(r<=65535)return t[e]=130,t[e+1]=r>>8,t[e+2]=r,3;if(r<=16777215)return t[e]=131,t[e+1]=r>>16,t[e+2]=r>>8,t[e+3]=r,4;throw new Error("Length too long (> 4 bytes)")},o=(t,e)=>{if(t[e]<128)return 1;if(128===t[e])throw new Error("Invalid length 0");if(129===t[e])return 2;if(130===t[e])return 3;if(131===t[e])return 4;throw new Error("Length too long (> 4 bytes)")},a=Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]),c=Uint8Array.from([48,5,6,3,43,101,112]);function u(t,e){const r=2+i(t.byteLength+1),n=e.byteLength+r+t.byteLength;let o=0;const a=new Uint8Array(1+i(n)+n);return a[o++]=48,o+=s(a,o,n),a.set(e,o),o+=e.byteLength,a[o++]=3,o+=s(a,o,t.byteLength+1),a[o++]=0,a.set(new Uint8Array(t),o),a}Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);const f=(t,e)=>{let r=0;const i=(t,e)=>{if(s[r++]!==t)throw new Error("Expected: "+e)},s=new Uint8Array(t);if(i(48,"sequence"),r+=o(s,r),!(0,n.HA)(s.slice(r,r+e.byteLength),e))throw new Error("Not the expected OID.");r+=e.byteLength,i(3,"bit string");const a=((t,e)=>{const r=o(t,e);if(1===r)return t[e];if(2===r)return t[e+1];if(3===r)return(t[e+1]<<8)+t[e+2];if(4===r)return(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];throw new Error("Length too long (> 4 bytes)")})(s,r)-1;r+=o(s,r),i(0,"0 padding");const c=s.slice(r);if(a!==c.length)throw new Error(`DER payload mismatch: Expected length ${a} actual length ${c.length}`);return c}},857:(t,e,r)=>{"use strict";r.d(e,{Yv:()=>n}),r(336),r(506),r(338);class n extends Error{constructor(t){super(t),this.message=t,this.name="AgentError",this.__proto__=n.prototype,Object.setPrototypeOf(this,n.prototype)}}},499:(t,e,r)=>{"use strict";r.d(e,{G:()=>c});var n,i,s=r(919),o=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},a=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class c{constructor(t){if(n.set(this,void 0),i.set(this,void 0),t.byteLength!==c.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");o(this,n,t,"f"),o(this,i,c.derEncode(t),"f")}static from(t){return this.fromDer(t.toDer())}static fromRaw(t){return new c(t)}static fromDer(t){return new c(this.derDecode(t))}static derEncode(t){return(0,s.C2)(t,s.le).buffer}static derDecode(t){const e=(0,s.n9)(t,s.le);if(e.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return e}get rawKey(){return a(this,n,"f")}get derKey(){return a(this,i,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}n=new WeakMap,i=new WeakMap,c.RAW_KEY_LENGTH=32},141:(t,e,r)=>{"use strict";r.d(e,{Gb:()=>f,tW:()=>a,uF:()=>h});var n=r(664),i=r(516),s=r(663),o=r(338);function a(t){return(0,o.Nn)(s.sc.create().update(new Uint8Array(t)).digest())}function c(t){if(t instanceof i.Tagged)return c(t.value);if("string"==typeof t)return u(t);if("number"==typeof t)return a((0,n.kk)(t));if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return a(t);if(Array.isArray(t)){const e=t.map(c);return a((0,o.xW)(...e))}if(t&&"object"==typeof t&&t._isPrincipal)return a(t.toUint8Array());if("object"==typeof t&&null!==t&&"function"==typeof t.toHash)return c(t.toHash());if("object"==typeof t)return h(t);if("bigint"==typeof t)return a((0,n.kk)(t));throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${t}`),{value:t})}const u=t=>a((new TextEncoder).encode(t));function f(t){return h(t)}function h(t){const e=Object.entries(t).filter((([,t])=>void 0!==t)).map((([t,e])=>[u(t),c(e)])).sort((([t],[e])=>(0,o.UD)(t,e)));return a((0,o.xW)(...e.map((t=>(0,o.xW)(...t)))))}},338:(t,e,r)=>{"use strict";function n(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.byteLength),0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e.buffer}function i(t){return[...new Uint8Array(t)].map((t=>t.toString(16).padStart(2,"0"))).join("")}r.d(e,{HA:()=>c,Nn:()=>u,UD:()=>a,aD:()=>o,em:()=>f,nj:()=>i,xW:()=>n});const s=new RegExp(/^[0-9a-fA-F]+$/);function o(t){if(!s.test(t))throw new Error("Invalid hexadecimal string.");const e=[...t].reduce(((t,e,r)=>(t[r/2|0]=(t[r/2|0]||"")+e,t)),[]).map((t=>Number.parseInt(t,16)));return new Uint8Array(e).buffer}function a(t,e){if(t.byteLength!==e.byteLength)return t.byteLength-e.byteLength;const r=new Uint8Array(t),n=new Uint8Array(e);for(let t=0;t<r.length;t++)if(r[t]!==n[t])return r[t]-n[t];return 0}function c(t,e){return 0===a(t,e)}function u(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function f(t){return t instanceof Uint8Array?u(t):t instanceof ArrayBuffer?t:Array.isArray(t)?u(new Uint8Array(t)):"buffer"in t?f(t.buffer):u(new Uint8Array(t))}},345:(t,e,r)=>{"use strict";r.d(e,{A:()=>s,b:()=>i});var n=r(664);const i=t=>(0,n.Ui)(new n.Ki(t)),s=t=>{const e=i(t);return new Date(Number(e)/1e6)}},664:(t,e,r)=>{"use strict";r.d(e,{Ih:()=>n,Ki:()=>o,em:()=>c,Ui:()=>p,kk:()=>d});var n={};r.r(n),r.d(n,{Bool:()=>tt,BoolClass:()=>O,ConstructType:()=>A,Empty:()=>J,EmptyClass:()=>T,FixedIntClass:()=>F,FixedNatClass:()=>L,Float32:()=>st,Float64:()=>ot,FloatClass:()=>j,Func:()=>_t,FuncClass:()=>K,Int:()=>nt,Int16:()=>ct,Int32:()=>ut,Int64:()=>ft,Int8:()=>at,IntClass:()=>P,Nat:()=>it,Nat16:()=>lt,Nat32:()=>dt,Nat64:()=>pt,Nat8:()=>ht,NatClass:()=>k,Null:()=>et,NullClass:()=>N,Opt:()=>bt,OptClass:()=>C,PrimitiveType:()=>x,Principal:()=>gt,PrincipalClass:()=>G,Rec:()=>Et,RecClass:()=>$,Record:()=>mt,RecordClass:()=>M,Reserved:()=>X,ReservedClass:()=>R,Service:()=>It,ServiceClass:()=>W,Text:()=>rt,TextClass:()=>U,Tuple:()=>yt,TupleClass:()=>q,Type:()=>B,Unknown:()=>Q,UnknownClass:()=>S,Variant:()=>vt,VariantClass:()=>V,Vec:()=>wt,VecClass:()=>D,Visitor:()=>I,decode:()=>Z,encode:()=>Y});var i=r(336);function s(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.byteLength),0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e}class o{constructor(t,e=(null==t?void 0:t.byteLength)||0){this._buffer=c(t||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,e)}get buffer(){return c(this._view.slice())}get byteLength(){return this._view.byteLength}read(t){const e=this._view.subarray(0,t);return this._view=this._view.subarray(t),e.slice().buffer}readUint8(){const t=this._view[0];return this._view=this._view.subarray(1),t}write(t){const e=new Uint8Array(t),r=this._view.byteLength;this._view.byteOffset+this._view.byteLength+e.byteLength>=this._buffer.byteLength?this.alloc(e.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+e.byteLength),this._view.set(e,r)}get end(){return 0===this._view.byteLength}alloc(t){const e=new ArrayBuffer(1.2*(this._buffer.byteLength+t)|0),r=new Uint8Array(e,0,this._view.byteLength+t);r.set(this._view),this._buffer=e,this._view=r}}function a(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function c(t){return t instanceof Uint8Array?a(t):t instanceof ArrayBuffer?t:Array.isArray(t)?a(new Uint8Array(t)):"buffer"in t?c(t.buffer):a(new Uint8Array(t))}function u(t){if(/^_\d+_$/.test(t)||/^_0x[0-9a-fA-F]+_$/.test(t)){const e=+t.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return function(t){const e=(new TextEncoder).encode(t);let r=0;for(const t of e)r=(223*r+t)%2**32;return r}(t)}function f(){throw new Error("unexpected end of buffer")}function h(t,e){return t.byteLength<e&&f(),t.read(e)}function l(t){const e=t.readUint8();return void 0===e&&f(),e}function d(t){if("number"==typeof t&&(t=BigInt(t)),t<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,r=new o(new ArrayBuffer(e),0);for(;;){const e=Number(t&BigInt(127));if((t/=BigInt(128))===BigInt(0)){r.write(new Uint8Array([e]));break}r.write(new Uint8Array([128|e]))}return r.buffer}function p(t){let e,r=BigInt(1),n=BigInt(0);do{e=l(t),n+=BigInt(127&e).valueOf()*r,r*=BigInt(128)}while(e>=128);return n}function g(t){"number"==typeof t&&(t=BigInt(t));const e=t<BigInt(0);e&&(t=-t-BigInt(1));const r=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,n=new o(new ArrayBuffer(r),0);for(;;){const r=i(t);if(t/=BigInt(128),e&&t===BigInt(0)&&64&r||!e&&t===BigInt(0)&&!(64&r)){n.write(new Uint8Array([r]));break}n.write(new Uint8Array([128|r]))}function i(t){const r=t%BigInt(128);return Number(e?BigInt(128)-r-BigInt(1):r)}return n.buffer}function y(t){const e=new Uint8Array(t.buffer);let r=0;for(;r<e.byteLength;r++)if(e[r]<128){if(!(64&e[r]))return p(t);break}const n=new Uint8Array(h(t,r+1));let i=BigInt(0);for(let t=n.byteLength-1;t>=0;t--)i=i*BigInt(128)+BigInt(128-(127&n[t])-1);return-i-BigInt(1)}function w(t,e){t=BigInt(t);const r=new o(new ArrayBuffer(Math.min(1,e)),0);let n=0,i=BigInt(256),s=BigInt(0),a=Number(t%i);for(r.write(new Uint8Array([a]));++n<e;)t<0&&s===BigInt(0)&&0!==a&&(s=BigInt(1)),a=Number((t/i-s)%BigInt(256)),r.write(new Uint8Array([a])),i*=BigInt(256);return r.buffer}function b(t,e){let r=BigInt(l(t)),n=BigInt(1),i=0;for(;++i<e;)n*=BigInt(256),r+=n*BigInt(l(t));return r}function m(t){const e=BigInt(t);if(t<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}const v="DIDL";function E(t,e,r){return t.map(((t,n)=>r(t,e[n])))}class _{constructor(){this._typs=[],this._idx=new Map}has(t){return this._idx.has(t.name)}add(t,e){const r=this._typs.length;this._idx.set(t.name,r),this._typs.push(e)}merge(t,e){const r=this._idx.get(t.name),n=this._idx.get(e);if(void 0===r)throw new Error("Missing type index for "+t);if(void 0===n)throw new Error("Missing type index for "+e);this._typs[r]=this._typs[n],this._typs.splice(n,1),this._idx.delete(e)}encode(){const t=d(this._typs.length),e=s(...this._typs);return s(t,e)}indexOf(t){if(!this._idx.has(t))throw new Error("Missing type index for "+t);return g(this._idx.get(t)||0)}}class I{visitType(t,e){throw new Error("Not implemented")}visitPrimitive(t,e){return this.visitType(t,e)}visitEmpty(t,e){return this.visitPrimitive(t,e)}visitBool(t,e){return this.visitPrimitive(t,e)}visitNull(t,e){return this.visitPrimitive(t,e)}visitReserved(t,e){return this.visitPrimitive(t,e)}visitText(t,e){return this.visitPrimitive(t,e)}visitNumber(t,e){return this.visitPrimitive(t,e)}visitInt(t,e){return this.visitNumber(t,e)}visitNat(t,e){return this.visitNumber(t,e)}visitFloat(t,e){return this.visitPrimitive(t,e)}visitFixedInt(t,e){return this.visitNumber(t,e)}visitFixedNat(t,e){return this.visitNumber(t,e)}visitPrincipal(t,e){return this.visitPrimitive(t,e)}visitConstruct(t,e){return this.visitType(t,e)}visitVec(t,e,r){return this.visitConstruct(t,r)}visitOpt(t,e,r){return this.visitConstruct(t,r)}visitRecord(t,e,r){return this.visitConstruct(t,r)}visitTuple(t,e,r){const n=e.map(((t,e)=>[`_${e}_`,t]));return this.visitRecord(t,n,r)}visitVariant(t,e,r){return this.visitConstruct(t,r)}visitRec(t,e,r){return this.visitConstruct(e,r)}visitFunc(t,e){return this.visitConstruct(t,e)}visitService(t,e){return this.visitConstruct(t,e)}}class B{display(){return this.name}valueToString(t){return H(t)}buildTypeTable(t){t.has(this)||this._buildTypeTableImpl(t)}}class x extends B{checkType(t){if(this.name!==t.name)throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`);return t}_buildTypeTableImpl(t){}}class A extends B{checkType(t){if(t instanceof $){const e=t.getType();if(void 0===e)throw new Error("type mismatch with uninitialized type");return e}throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`)}encodeType(t){return t.indexOf(this.name)}}class T extends x{accept(t,e){return t.visitEmpty(this,e)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return g(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class S extends B{checkType(t){throw new Error("Method not implemented for unknown.")}accept(t,e){throw t.visitType(this,e)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(t,e){let r,n=e.decodeValue(t,e);return Object(n)!==n&&(n=Object(n)),r=e instanceof $?()=>e.getType():()=>e,Object.defineProperty(n,"type",{value:r,writable:!0,enumerable:!1,configurable:!0}),n}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class O extends x{accept(t,e){return t.visitBool(this,e)}covariant(t){if("boolean"==typeof t)return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){return new Uint8Array([t?1:0])}encodeType(){return g(-2)}decodeValue(t,e){switch(this.checkType(e),l(t)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class N extends x{accept(t,e){return t.visitNull(this,e)}covariant(t){if(null===t)return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return g(-1)}decodeValue(t,e){return this.checkType(e),null}get name(){return"null"}}class R extends x{accept(t,e){return t.visitReserved(this,e)}covariant(t){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return g(-16)}decodeValue(t,e){return e.name!==this.name&&e.decodeValue(t,e),null}get name(){return"reserved"}}class U extends x{accept(t,e){return t.visitText(this,e)}covariant(t){if("string"==typeof t)return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){const e=(new TextEncoder).encode(t);return s(d(e.byteLength),e)}encodeType(){return g(-15)}decodeValue(t,e){this.checkType(e);const r=p(t),n=h(t,Number(r));return new TextDecoder("utf8",{fatal:!0}).decode(n)}get name(){return"text"}valueToString(t){return'"'+t+'"'}}class P extends x{accept(t,e){return t.visitInt(this,e)}covariant(t){if("bigint"==typeof t||Number.isInteger(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){return g(t)}encodeType(){return g(-4)}decodeValue(t,e){return this.checkType(e),y(t)}get name(){return"int"}valueToString(t){return t.toString()}}class k extends x{accept(t,e){return t.visitNat(this,e)}covariant(t){if("bigint"==typeof t&&t>=BigInt(0)||Number.isInteger(t)&&t>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){return d(t)}encodeType(){return g(-3)}decodeValue(t,e){return this.checkType(e),p(t)}get name(){return"nat"}valueToString(t){return t.toString()}}class j extends x{constructor(t){if(super(),this._bits=t,32!==t&&64!==t)throw new Error("not a valid float type")}accept(t,e){return t.visitFloat(this,e)}covariant(t){if("number"==typeof t||t instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){const e=new ArrayBuffer(this._bits/8),r=new DataView(e);return 32===this._bits?r.setFloat32(0,t,!0):r.setFloat64(0,t,!0),e}encodeType(){return g(32===this._bits?-13:-14)}decodeValue(t,e){this.checkType(e);const r=h(t,this._bits/8),n=new DataView(r);return 32===this._bits?n.getFloat32(0,!0):n.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(t){return t.toString()}}class F extends x{constructor(t){super(),this._bits=t}accept(t,e){return t.visitFixedInt(this,e)}covariant(t){const e=m(this._bits-1)*BigInt(-1),r=m(this._bits-1)-BigInt(1);let n=!1;if("bigint"==typeof t)n=t>=e&&t<=r;else if(Number.isInteger(t)){const i=BigInt(t);n=i>=e&&i<=r}else n=!1;if(n)return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){return w(t,this._bits/8)}encodeType(){return g(-9-(Math.log2(this._bits)-3))}decodeValue(t,e){this.checkType(e);const r=function(t,e){let r=b(t,e);const n=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return r>=n&&(r-=n*BigInt(2)),r}(t,this._bits/8);return this._bits<=32?Number(r):r}get name(){return`int${this._bits}`}valueToString(t){return t.toString()}}class L extends x{constructor(t){super(),this._bits=t}accept(t,e){return t.visitFixedNat(this,e)}covariant(t){const e=m(this._bits);let r=!1;if(r="bigint"==typeof t&&t>=BigInt(0)?t<e:!!(Number.isInteger(t)&&t>=0)&&BigInt(t)<e,r)return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){return function(t,e){if(BigInt(t)<BigInt(0))throw new Error("Cannot write negative values.");return w(t,e)}(t,this._bits/8)}encodeType(){return g(-5-(Math.log2(this._bits)-3))}decodeValue(t,e){this.checkType(e);const r=b(t,this._bits/8);return this._bits<=32?Number(r):r}get name(){return`nat${this._bits}`}valueToString(t){return t.toString()}}class D extends A{constructor(t){super(),this._type=t,this._blobOptimization=!1,t instanceof L&&8===t._bits&&(this._blobOptimization=!0)}accept(t,e){return t.visitVec(this,this._type,e)}covariant(t){const e=this._type instanceof L||this._type instanceof F?this._type._bits:0;if(ArrayBuffer.isView(t)&&e==8*t.BYTES_PER_ELEMENT||Array.isArray(t)&&t.every(((t,e)=>{try{return this._type.covariant(t)}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nindex ${e} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){const e=d(t.length);if(this._blobOptimization)return s(e,new Uint8Array(t));if(ArrayBuffer.isView(t))return s(e,new Uint8Array(t.buffer));const r=new o(new ArrayBuffer(e.byteLength+t.length),0);r.write(e);for(const e of t){const t=this._type.encodeValue(e);r.write(new Uint8Array(t))}return r.buffer}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const e=g(-19),r=this._type.encodeType(t);t.add(this,s(e,r))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof D))throw new Error("Not a vector type");const n=Number(p(t));if(this._type instanceof L){if(8==this._type._bits)return new Uint8Array(t.read(n));if(16==this._type._bits)return new Uint16Array(t.read(2*n));if(32==this._type._bits)return new Uint32Array(t.read(4*n));if(64==this._type._bits)return new BigUint64Array(t.read(8*n))}if(this._type instanceof F){if(8==this._type._bits)return new Int8Array(t.read(n));if(16==this._type._bits)return new Int16Array(t.read(2*n));if(32==this._type._bits)return new Int32Array(t.read(4*n));if(64==this._type._bits)return new BigInt64Array(t.read(8*n))}const i=[];for(let e=0;e<n;e++)i.push(this._type.decodeValue(t,r._type));return i}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(t){return"vec {"+t.map((t=>this._type.valueToString(t))).join("; ")+"}"}}class C extends A{constructor(t){super(),this._type=t}accept(t,e){return t.visitOpt(this,this._type,e)}covariant(t){try{if(Array.isArray(t)&&(0===t.length||1===t.length&&this._type.covariant(t[0])))return!0}catch(e){throw new Error(`Invalid ${this.display()} argument: ${H(t)} \n\n-> ${e.message}`)}throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){return 0===t.length?new Uint8Array([0]):s(new Uint8Array([1]),this._type.encodeValue(t[0]))}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const e=g(-18),r=this._type.encodeType(t);t.add(this,s(e,r))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof C))throw new Error("Not an option type");switch(l(t)){case 0:return[];case 1:return[this._type.decodeValue(t,r._type)];default:throw new Error("Not an option value")}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(t){return 0===t.length?"null":`opt ${this._type.valueToString(t[0])}`}}class M extends A{constructor(t={}){super(),this._fields=Object.entries(t).sort(((t,e)=>u(t[0])-u(e[0])))}accept(t,e){return t.visitRecord(this,this._fields,e)}tryAsTuple(){const t=[];for(let e=0;e<this._fields.length;e++){const[r,n]=this._fields[e];if(r!==`_${e}_`)return null;t.push(n)}return t}covariant(t){if("object"==typeof t&&this._fields.every((([e,r])=>{if(!t.hasOwnProperty(e))throw new Error(`Record is missing key "${e}".`);try{return r.covariant(t[e])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nfield ${e} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){const e=this._fields.map((([e])=>t[e]));return s(...E(this._fields,e,(([,t],e)=>t.encodeValue(e))))}_buildTypeTableImpl(t){this._fields.forEach((([e,r])=>r.buildTypeTable(t)));const e=g(-20),r=d(this._fields.length),n=this._fields.map((([e,r])=>s(d(u(e)),r.encodeType(t))));t.add(this,s(e,r,s(...n)))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof M))throw new Error("Not a record type");const n={};let i=0,s=0;for(;s<r._fields.length;){const[e,o]=r._fields[s];if(i>=this._fields.length){o.decodeValue(t,o),s++;continue}const[a,c]=this._fields[i],f=u(this._fields[i][0]),h=u(e);if(f===h)n[a]=c.decodeValue(t,o),i++,s++;else if(h>f){if(!(c instanceof C||c instanceof R))throw new Error("Cannot find required field "+a);n[a]=[],i++}else o.decodeValue(t,o),s++}for(const[t,e]of this._fields.slice(i)){if(!(e instanceof C||e instanceof R))throw new Error("Cannot find required field "+t);n[t]=[]}return n}get name(){return`record {${this._fields.map((([t,e])=>t+":"+e.name)).join("; ")}}`}display(){return`record {${this._fields.map((([t,e])=>t+":"+e.display())).join("; ")}}`}valueToString(t){const e=this._fields.map((([e])=>t[e]));return`record {${E(this._fields,e,(([t,e],r)=>t+"="+e.valueToString(r))).join("; ")}}`}}class q extends M{constructor(t){const e={};t.forEach(((t,r)=>e["_"+r+"_"]=t)),super(e),this._components=t}accept(t,e){return t.visitTuple(this,this._components,e)}covariant(t){if(Array.isArray(t)&&t.length>=this._fields.length&&this._components.every(((e,r)=>{try{return e.covariant(t[r])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nindex ${r} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){return s(...E(this._components,t,((t,e)=>t.encodeValue(e))))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof q))throw new Error("not a tuple type");if(r._components.length<this._components.length)throw new Error("tuple mismatch");const n=[];for(const[e,i]of r._components.entries())e>=this._components.length?i.decodeValue(t,i):n.push(this._components[e].decodeValue(t,i));return n}display(){return`record {${this._components.map((t=>t.display())).join("; ")}}`}valueToString(t){return`record {${E(this._components,t,((t,e)=>t.valueToString(e))).join("; ")}}`}}class V extends A{constructor(t={}){super(),this._fields=Object.entries(t).sort(((t,e)=>u(t[0])-u(e[0])))}accept(t,e){return t.visitVariant(this,this._fields,e)}covariant(t){if("object"==typeof t&&1===Object.entries(t).length&&this._fields.every((([e,r])=>{try{return!t.hasOwnProperty(e)||r.covariant(t[e])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nvariant ${e} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){for(let e=0;e<this._fields.length;e++){const[r,n]=this._fields[e];if(t.hasOwnProperty(r))return s(d(e),n.encodeValue(t[r]))}throw Error("Variant has no data: "+t)}_buildTypeTableImpl(t){this._fields.forEach((([,e])=>{e.buildTypeTable(t)}));const e=g(-21),r=d(this._fields.length),n=this._fields.map((([e,r])=>s(d(u(e)),r.encodeType(t))));t.add(this,s(e,r,...n))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof V))throw new Error("Not a variant type");const n=Number(p(t));if(n>=r._fields.length)throw Error("Invalid variant index: "+n);const[i,s]=r._fields[n];for(const[e,r]of this._fields)if(u(i)===u(e)){const n=r.decodeValue(t,s);return{[e]:n}}throw new Error("Cannot find field hash "+i)}get name(){return`variant {${this._fields.map((([t,e])=>t+":"+e.name)).join("; ")}}`}display(){return`variant {${this._fields.map((([t,e])=>t+("null"===e.name?"":`:${e.display()}`))).join("; ")}}`}valueToString(t){for(const[e,r]of this._fields)if(t.hasOwnProperty(e)){const n=r.valueToString(t[e]);return"null"===n?`variant {${e}}`:`variant {${e}=${n}}`}throw new Error("Variant has no data: "+t)}}class $ extends A{constructor(){super(...arguments),this._id=$._counter++,this._type=void 0}accept(t,e){if(!this._type)throw Error("Recursive type uninitialized.");return t.visitRec(this,this._type,e)}fill(t){this._type=t}getType(){return this._type}covariant(t){if(this._type&&this._type.covariant(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(t)}_buildTypeTableImpl(t){if(!this._type)throw Error("Recursive type uninitialized.");t.add(this,new Uint8Array([])),this._type.buildTypeTable(t),t.merge(this,this._type.name)}decodeValue(t,e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(t,e)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`μ${this.name}.${this._type.name}`}valueToString(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(t)}}function z(t){if(1!==l(t))throw new Error("Cannot decode principal");const e=Number(p(t));return i.p.fromUint8Array(new Uint8Array(h(t,e)))}$._counter=0;class G extends x{accept(t,e){return t.visitPrincipal(this,e)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){const e=t.toUint8Array(),r=d(e.byteLength);return s(new Uint8Array([1]),r,e)}encodeType(){return g(-24)}decodeValue(t,e){return this.checkType(e),z(t)}get name(){return"principal"}valueToString(t){return`${this.name} "${t.toText()}"`}}class K extends A{constructor(t,e,r=[]){super(),this.argTypes=t,this.retTypes=e,this.annotations=r}static argsToString(t,e){if(t.length!==e.length)throw new Error("arity mismatch");return"("+t.map(((t,r)=>t.valueToString(e[r]))).join(", ")+")"}accept(t,e){return t.visitFunc(this,e)}covariant(t){if(Array.isArray(t)&&2===t.length&&t[0]&&t[0]._isPrincipal&&"string"==typeof t[1])return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue([t,e]){const r=t.toUint8Array(),n=d(r.byteLength),i=s(new Uint8Array([1]),n,r),o=(new TextEncoder).encode(e),a=d(o.byteLength);return s(new Uint8Array([1]),i,a,o)}_buildTypeTableImpl(t){this.argTypes.forEach((e=>e.buildTypeTable(t))),this.retTypes.forEach((e=>e.buildTypeTable(t)));const e=g(-22),r=d(this.argTypes.length),n=s(...this.argTypes.map((e=>e.encodeType(t)))),i=d(this.retTypes.length),o=s(...this.retTypes.map((e=>e.encodeType(t)))),a=d(this.annotations.length),c=s(...this.annotations.map((t=>this.encodeAnnotation(t))));t.add(this,s(e,r,n,i,o,a,c))}decodeValue(t){if(1!==l(t))throw new Error("Cannot decode function reference");const e=z(t),r=h(t,Number(p(t)));return[e,new TextDecoder("utf8",{fatal:!0}).decode(r)]}get name(){return`(${this.argTypes.map((t=>t.name)).join(", ")}) -> (${this.retTypes.map((t=>t.name)).join(", ")})${" "+this.annotations.join(" ")}`}valueToString([t,e]){return`func "${t.toText()}".${e}`}display(){return`(${this.argTypes.map((t=>t.display())).join(", ")}) → (${this.retTypes.map((t=>t.display())).join(", ")})${" "+this.annotations.join(" ")}`}encodeAnnotation(t){if("query"===t)return new Uint8Array([1]);if("oneway"===t)return new Uint8Array([2]);if("composite_query"===t)return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class W extends A{constructor(t){super(),this._fields=Object.entries(t).sort(((t,e)=>t[0]<e[0]?-1:t[0]>e[0]?1:0))}accept(t,e){return t.visitService(this,e)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${H(t)}`)}encodeValue(t){const e=t.toUint8Array(),r=d(e.length);return s(new Uint8Array([1]),r,e)}_buildTypeTableImpl(t){this._fields.forEach((([e,r])=>r.buildTypeTable(t)));const e=g(-23),r=d(this._fields.length),n=this._fields.map((([e,r])=>{const n=(new TextEncoder).encode(e);return s(d(n.length),n,r.encodeType(t))}));t.add(this,s(e,r,...n))}decodeValue(t){return z(t)}get name(){return`service {${this._fields.map((([t,e])=>t+":"+e.name)).join("; ")}}`}valueToString(t){return`service "${t.toText()}"`}}function H(t){const e=JSON.stringify(t,((t,e)=>"bigint"==typeof e?`BigInt(${e})`:e));return e&&e.length>400?e.substring(0,397)+"...":e}function Y(t,e){if(e.length<t.length)throw Error("Wrong number of message arguments");const r=new _;t.forEach((t=>t.buildTypeTable(r)));const n=(new TextEncoder).encode(v),i=r.encode(),o=d(e.length),a=s(...t.map((t=>t.encodeType(r)))),c=s(...E(t,e,((t,e)=>{try{t.covariant(e)}catch(t){throw new Error(t.message+"\n\n")}return t.encodeValue(e)})));return s(n,i,o,a,c)}function Z(t,e){const r=new o(e);if(e.byteLength<v.length)throw new Error("Message length smaller than magic number");const n=h(r,v.length),i=(new TextDecoder).decode(n);if(i!==v)throw new Error("Wrong magic number: "+JSON.stringify(i));const[s,a]=function(t){const e=[],r=Number(p(t));for(let n=0;n<r;n++){const r=Number(y(t));switch(r){case-18:case-19:{const n=Number(y(t));e.push([r,n]);break}case-20:case-21:{const n=[];let i,s=Number(p(t));for(;s--;){const e=Number(p(t));if(e>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if("number"==typeof i&&i>=e)throw new Error("field id collision or not sorted");i=e;const r=Number(y(t));n.push([e,r])}e.push([r,n]);break}case-22:{const n=[];let i=Number(p(t));for(;i--;)n.push(Number(y(t)));const s=[];let o=Number(p(t));for(;o--;)s.push(Number(y(t)));const a=[];let c=Number(p(t));for(;c--;)switch(Number(p(t))){case 1:a.push("query");break;case 2:a.push("oneway");break;case 3:a.push("composite_query");break;default:throw new Error("unknown annotation")}e.push([r,[n,s,a]]);break}case-23:{let n=Number(p(t));const i=[];for(;n--;){const e=Number(p(t)),r=(new TextDecoder).decode(h(t,e)),n=y(t);i.push([r,n])}e.push([r,i]);break}default:throw new Error("Illegal op_code: "+r)}}const n=[],i=Number(p(t));for(let e=0;e<i;e++)n.push(Number(y(t)));return[e,n]}(r);if(a.length<t.length)throw new Error("Wrong number of return values");const c=s.map((t=>Et()));function u(t){if(t<-24)throw new Error("future value not supported");if(t<0)switch(t){case-1:return et;case-2:return tt;case-3:return it;case-4:return nt;case-5:return ht;case-6:return lt;case-7:return dt;case-8:return pt;case-9:return at;case-10:return ct;case-11:return ut;case-12:return ft;case-13:return st;case-14:return ot;case-15:return rt;case-16:return X;case-17:return J;case-24:return gt;default:throw new Error("Illegal op_code: "+t)}if(t>=s.length)throw new Error("type index out of range");return c[t]}function f(t){switch(t[0]){case-19:return wt(u(t[1]));case-18:return bt(u(t[1]));case-20:{const e={};for(const[r,n]of t[1])e[`_${r}_`]=u(n);const r=mt(e),n=r.tryAsTuple();return Array.isArray(n)?yt(...n):r}case-21:{const e={};for(const[r,n]of t[1])e[`_${r}_`]=u(n);return vt(e)}case-22:{const[e,r,n]=t[1];return _t(e.map((t=>u(t))),r.map((t=>u(t))),n)}case-23:{const e={},r=t[1];for(const[t,n]of r){let r=u(n);if(r instanceof $&&(r=r.getType()),!(r instanceof K))throw new Error("Illegal service definition: services can only contain functions");e[t]=r}return It(e)}default:throw new Error("Illegal op_code: "+t[0])}}s.forEach(((t,e)=>{if(-22===t[0]){const r=f(t);c[e].fill(r)}})),s.forEach(((t,e)=>{if(-22!==t[0]){const r=f(t);c[e].fill(r)}}));const l=a.map((t=>u(t))),d=t.map(((t,e)=>t.decodeValue(r,l[e])));for(let e=t.length;e<l.length;e++)l[e].decodeValue(r,l[e]);if(r.byteLength>0)throw new Error("decode: Left-over bytes");return d}const J=new T,X=new R,Q=new S,tt=new O,et=new N,rt=new U,nt=new P,it=new k,st=new j(32),ot=new j(64),at=new F(8),ct=new F(16),ut=new F(32),ft=new F(64),ht=new L(8),lt=new L(16),dt=new L(32),pt=new L(64),gt=new G;function yt(...t){return new q(t)}function wt(t){return new D(t)}function bt(t){return new C(t)}function mt(t){return new M(t)}function vt(t){return new V(t)}function Et(){return new $}function _t(t,e,r=[]){return new K(t,e,r)}function It(t){return new W(t)}},336:(t,e,r)=>{"use strict";r.d(e,{p:()=>c});const n="abcdefghijklmnopqrstuvwxyz234567",i=Object.create(null);for(let t=0;t<32;t++)i[n[t]]=t;i[0]=i.o,i[1]=i.i;const s=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);var o=r(663);const a="__principal__";class c{constructor(t){this._arr=t,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([4]))}static managementCanister(){return this.fromHex("aaaaa-aa")}static selfAuthenticating(t){const e=(r=t,o.ZT.create().update(new Uint8Array(r)).digest());var r;return new this(new Uint8Array([...e,2]))}static from(t){if("string"==typeof t)return c.fromText(t);if(Object.getPrototypeOf(t)===Uint8Array.prototype)return new c(t);if("object"==typeof t&&null!==t&&!0===t._isPrincipal)return new c(t._arr);throw new Error(`Impossible to convert ${JSON.stringify(t)} to Principal.`)}static fromHex(t){return new this(new Uint8Array((null!==(e=t.match(/.{1,2}/g))&&void 0!==e?e:[]).map((t=>parseInt(t,16)))));var e}static fromText(t){let e=t;if(t.includes(a)){const r=JSON.parse(t);a in r&&(e=r[a])}let r=function(t){let e=0,r=0;const n=new Uint8Array(4*t.length/3|0);let s=0;function o(t){let o=i[t.toLowerCase()];if(void 0===o)throw new Error(`Invalid character: ${JSON.stringify(t)}`);o<<=3,r|=o>>>e,e+=5,e>=8&&(n[s++]=r,e-=8,r=e>0?o<<5-e&255:0)}for(const e of t)o(e);return n.slice(0,s)}(e.toLowerCase().replace(/-/g,""));r=r.slice(4,r.length);const n=new this(r);if(n.toText()!==e)throw new Error(`Principal "${n.toText()}" does not have a valid checksum (original value "${e}" may not be a valid Principal ID).`);return n}static fromUint8Array(t){return new this(t)}isAnonymous(){return 1===this._arr.byteLength&&4===this._arr[0]}toUint8Array(){return this._arr}toHex(){return(t=this._arr,t.reduce(((t,e)=>t+e.toString(16).padStart(2,"0")),"")).toUpperCase();var t}toText(){const t=new ArrayBuffer(4);new DataView(t).setUint32(0,function(t){const e=new Uint8Array(t);let r=-1;for(let t=0;t<e.length;t++){const n=e[t];r=s[255&(n^r)]^r>>>8}return~r>>>0}(this._arr));const e=new Uint8Array(t),r=Uint8Array.from(this._arr),i=function(t){let e=0,r=0,i="";for(let o=0;o<t.length;)o+=(s=t[o],e<0?r|=s>>-e:r=s<<e&248,e>3?(e-=8,1):(e<4&&(i+=n[r>>3],e+=5),0));var s;return i+(e<0?n[r>>3]:"")}(new Uint8Array([...e,...r])).match(/.{1,5}/g);if(!i)throw new Error;return i.join("-")}toString(){return this.toText()}toJSON(){return{[a]:this.toText()}}compareTo(t){for(let e=0;e<Math.min(this._arr.length,t._arr.length);e++){if(this._arr[e]<t._arr[e])return"lt";if(this._arr[e]>t._arr[e])return"gt"}return this._arr.length<t._arr.length?"lt":this._arr.length>t._arr.length?"gt":"eq"}ltEq(t){const e=this.compareTo(t);return"lt"==e||"eq"==e}gtEq(t){const e=this.compareTo(t);return"gt"==e||"eq"==e}}},526:(t,e)=>{"use strict";e.byteLength=function(t){var e=a(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,s=a(t),o=s[0],c=s[1],u=new i(function(t,e,r){return 3*(e+r)/4-r}(0,o,c)),f=0,h=c>0?o-4:o;for(r=0;r<h;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],u[f++]=e>>16&255,u[f++]=e>>8&255,u[f++]=255&e;return 2===c&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,u[f++]=255&e),1===c&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,u[f++]=e>>8&255,u[f++]=255&e),u},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,s=[],o=16383,a=0,u=n-i;a<u;a+=o)s.push(c(t,a,a+o>u?u:a+o));return 1===i?(e=t[n-1],s.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],s.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),s.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)r[o]=s[o],n[s.charCodeAt(o)]=o;function a(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function c(t,e,n){for(var i,s,o=[],a=e;a<n;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(r[(s=i)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},594:function(t,e,r){var n;!function(){"use strict";var i,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,o=Math.ceil,a=Math.floor,c="[BigNumber Error] ",u=c+"Number primitive has more than 15 significant digits: ",f=1e14,h=14,l=9007199254740991,d=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],p=1e7,g=1e9;function y(t){var e=0|t;return t>0||t===e?e:e-1}function w(t){for(var e,r,n=1,i=t.length,s=t[0]+"";n<i;){for(e=t[n++]+"",r=h-e.length;r--;e="0"+e);s+=e}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function b(t,e){var r,n,i=t.c,s=e.c,o=t.s,a=e.s,c=t.e,u=e.e;if(!o||!a)return null;if(r=i&&!i[0],n=s&&!s[0],r||n)return r?n?0:-a:o;if(o!=a)return o;if(r=o<0,n=c==u,!i||!s)return n?0:!i^r?1:-1;if(!n)return c>u^r?1:-1;for(a=(c=i.length)<(u=s.length)?c:u,o=0;o<a;o++)if(i[o]!=s[o])return i[o]>s[o]^r?1:-1;return c==u?0:c>u^r?1:-1}function m(t,e,r,n){if(t<e||t>r||t!==a(t))throw Error(c+(n||"Argument")+("number"==typeof t?t<e||t>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function v(t){var e=t.c.length-1;return y(t.e/h)==e&&t.c[e]%2!=0}function E(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function _(t,e,r){var n,i;if(e<0){for(i=r+".";++e;i+=r);t=i+t}else if(++e>(n=t.length)){for(i=r,e-=n;--e;i+=r);t+=i}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}i=function t(e){var r,n,i,I,B,x,A,T,S,O,N=z.prototype={constructor:z,toString:null,valueOf:null},R=new z(1),U=20,P=4,k=-7,j=21,F=-1e7,L=1e7,D=!1,C=1,M=0,q={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},V="0123456789abcdefghijklmnopqrstuvwxyz",$=!0;function z(t,e){var r,o,c,f,d,p,g,y,w=this;if(!(w instanceof z))return new z(t,e);if(null==e){if(t&&!0===t._isBigNumber)return w.s=t.s,void(!t.c||t.e>L?w.c=w.e=null:t.e<F?w.c=[w.e=0]:(w.e=t.e,w.c=t.c.slice()));if((p="number"==typeof t)&&0*t==0){if(w.s=1/t<0?(t=-t,-1):1,t===~~t){for(f=0,d=t;d>=10;d/=10,f++);return void(f>L?w.c=w.e=null:(w.e=f,w.c=[t]))}y=String(t)}else{if(!s.test(y=String(t)))return i(w,y,p);w.s=45==y.charCodeAt(0)?(y=y.slice(1),-1):1}(f=y.indexOf("."))>-1&&(y=y.replace(".","")),(d=y.search(/e/i))>0?(f<0&&(f=d),f+=+y.slice(d+1),y=y.substring(0,d)):f<0&&(f=y.length)}else{if(m(e,2,V.length,"Base"),10==e&&$)return H(w=new z(t),U+w.e+1,P);if(y=String(t),p="number"==typeof t){if(0*t!=0)return i(w,y,p,e);if(w.s=1/t<0?(y=y.slice(1),-1):1,z.DEBUG&&y.replace(/^0\.0*|\./,"").length>15)throw Error(u+t)}else w.s=45===y.charCodeAt(0)?(y=y.slice(1),-1):1;for(r=V.slice(0,e),f=d=0,g=y.length;d<g;d++)if(r.indexOf(o=y.charAt(d))<0){if("."==o){if(d>f){f=g;continue}}else if(!c&&(y==y.toUpperCase()&&(y=y.toLowerCase())||y==y.toLowerCase()&&(y=y.toUpperCase()))){c=!0,d=-1,f=0;continue}return i(w,String(t),p,e)}p=!1,(f=(y=n(y,e,10,w.s)).indexOf("."))>-1?y=y.replace(".",""):f=y.length}for(d=0;48===y.charCodeAt(d);d++);for(g=y.length;48===y.charCodeAt(--g););if(y=y.slice(d,++g)){if(g-=d,p&&z.DEBUG&&g>15&&(t>l||t!==a(t)))throw Error(u+w.s*t);if((f=f-d-1)>L)w.c=w.e=null;else if(f<F)w.c=[w.e=0];else{if(w.e=f,w.c=[],d=(f+1)%h,f<0&&(d+=h),d<g){for(d&&w.c.push(+y.slice(0,d)),g-=h;d<g;)w.c.push(+y.slice(d,d+=h));d=h-(y=y.slice(d)).length}else d-=g;for(;d--;y+="0");w.c.push(+y)}}else w.c=[w.e=0]}function G(t,e,r,n){var i,s,o,a,c;if(null==r?r=P:m(r,0,8),!t.c)return t.toString();if(i=t.c[0],o=t.e,null==e)c=w(t.c),c=1==n||2==n&&(o<=k||o>=j)?E(c,o):_(c,o,"0");else if(s=(t=H(new z(t),e,r)).e,a=(c=w(t.c)).length,1==n||2==n&&(e<=s||s<=k)){for(;a<e;c+="0",a++);c=E(c,s)}else if(e-=o,c=_(c,s,"0"),s+1>a){if(--e>0)for(c+=".";e--;c+="0");}else if((e+=s-a)>0)for(s+1==a&&(c+=".");e--;c+="0");return t.s<0&&i?"-"+c:c}function K(t,e){for(var r,n,i=1,s=new z(t[0]);i<t.length;i++)(!(n=new z(t[i])).s||(r=b(s,n))===e||0===r&&s.s===e)&&(s=n);return s}function W(t,e,r){for(var n=1,i=e.length;!e[--i];e.pop());for(i=e[0];i>=10;i/=10,n++);return(r=n+r*h-1)>L?t.c=t.e=null:r<F?t.c=[t.e=0]:(t.e=r,t.c=e),t}function H(t,e,r,n){var i,s,c,u,l,p,g,y=t.c,w=d;if(y){t:{for(i=1,u=y[0];u>=10;u/=10,i++);if((s=e-i)<0)s+=h,c=e,l=y[p=0],g=a(l/w[i-c-1]%10);else if((p=o((s+1)/h))>=y.length){if(!n)break t;for(;y.length<=p;y.push(0));l=g=0,i=1,c=(s%=h)-h+1}else{for(l=u=y[p],i=1;u>=10;u/=10,i++);g=(c=(s%=h)-h+i)<0?0:a(l/w[i-c-1]%10)}if(n=n||e<0||null!=y[p+1]||(c<0?l:l%w[i-c-1]),n=r<4?(g||n)&&(0==r||r==(t.s<0?3:2)):g>5||5==g&&(4==r||n||6==r&&(s>0?c>0?l/w[i-c]:0:y[p-1])%10&1||r==(t.s<0?8:7)),e<1||!y[0])return y.length=0,n?(e-=t.e+1,y[0]=w[(h-e%h)%h],t.e=-e||0):y[0]=t.e=0,t;if(0==s?(y.length=p,u=1,p--):(y.length=p+1,u=w[h-s],y[p]=c>0?a(l/w[i-c]%w[c])*u:0),n)for(;;){if(0==p){for(s=1,c=y[0];c>=10;c/=10,s++);for(c=y[0]+=u,u=1;c>=10;c/=10,u++);s!=u&&(t.e++,y[0]==f&&(y[0]=1));break}if(y[p]+=u,y[p]!=f)break;y[p--]=0,u=1}for(s=y.length;0===y[--s];y.pop());}t.e>L?t.c=t.e=null:t.e<F&&(t.c=[t.e=0])}return t}function Y(t){var e,r=t.e;return null===r?t.toString():(e=w(t.c),e=r<=k||r>=j?E(e,r):_(e,r,"0"),t.s<0?"-"+e:e)}return z.clone=t,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(t){var e,r;if(null!=t){if("object"!=typeof t)throw Error(c+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(m(r=t[e],0,g,e),U=r),t.hasOwnProperty(e="ROUNDING_MODE")&&(m(r=t[e],0,8,e),P=r),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((r=t[e])&&r.pop?(m(r[0],-g,0,e),m(r[1],0,g,e),k=r[0],j=r[1]):(m(r,-g,g,e),k=-(j=r<0?-r:r))),t.hasOwnProperty(e="RANGE"))if((r=t[e])&&r.pop)m(r[0],-g,-1,e),m(r[1],1,g,e),F=r[0],L=r[1];else{if(m(r,-g,g,e),!r)throw Error(c+e+" cannot be zero: "+r);F=-(L=r<0?-r:r)}if(t.hasOwnProperty(e="CRYPTO")){if((r=t[e])!==!!r)throw Error(c+e+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw D=!r,Error(c+"crypto unavailable");D=r}else D=r}if(t.hasOwnProperty(e="MODULO_MODE")&&(m(r=t[e],0,9,e),C=r),t.hasOwnProperty(e="POW_PRECISION")&&(m(r=t[e],0,g,e),M=r),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(r=t[e]))throw Error(c+e+" not an object: "+r);q=r}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(r=t[e])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(c+e+" invalid: "+r);$="0123456789"==r.slice(0,10),V=r}}return{DECIMAL_PLACES:U,ROUNDING_MODE:P,EXPONENTIAL_AT:[k,j],RANGE:[F,L],CRYPTO:D,MODULO_MODE:C,POW_PRECISION:M,FORMAT:q,ALPHABET:V}},z.isBigNumber=function(t){if(!t||!0!==t._isBigNumber)return!1;if(!z.DEBUG)return!0;var e,r,n=t.c,i=t.e,s=t.s;t:if("[object Array]"=={}.toString.call(n)){if((1===s||-1===s)&&i>=-g&&i<=g&&i===a(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break t}if((e=(i+1)%h)<1&&(e+=h),String(n[0]).length==e){for(e=0;e<n.length;e++)if((r=n[e])<0||r>=f||r!==a(r))break t;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===s||1===s||-1===s))return!0;throw Error(c+"Invalid BigNumber: "+t)},z.maximum=z.max=function(){return K(arguments,-1)},z.minimum=z.min=function(){return K(arguments,1)},z.random=(I=9007199254740992,B=Math.random()*I&2097151?function(){return a(Math.random()*I)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,r,n,i,s,u=0,f=[],l=new z(R);if(null==t?t=U:m(t,0,g),i=o(t/h),D)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(i*=2));u<i;)(s=131072*e[u]+(e[u+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),e[u]=r[0],e[u+1]=r[1]):(f.push(s%1e14),u+=2);u=i/2}else{if(!crypto.randomBytes)throw D=!1,Error(c+"crypto unavailable");for(e=crypto.randomBytes(i*=7);u<i;)(s=281474976710656*(31&e[u])+1099511627776*e[u+1]+4294967296*e[u+2]+16777216*e[u+3]+(e[u+4]<<16)+(e[u+5]<<8)+e[u+6])>=9e15?crypto.randomBytes(7).copy(e,u):(f.push(s%1e14),u+=7);u=i/7}if(!D)for(;u<i;)(s=B())<9e15&&(f[u++]=s%1e14);for(i=f[--u],t%=h,i&&t&&(s=d[h-t],f[u]=a(i/s)*s);0===f[u];f.pop(),u--);if(u<0)f=[n=0];else{for(n=-1;0===f[0];f.splice(0,1),n-=h);for(u=1,s=f[0];s>=10;s/=10,u++);u<h&&(n-=h-u)}return l.e=n,l.c=f,l}),z.sum=function(){for(var t=1,e=arguments,r=new z(e[0]);t<e.length;)r=r.plus(e[t++]);return r},n=function(){var t="0123456789";function e(t,e,r,n){for(var i,s,o=[0],a=0,c=t.length;a<c;){for(s=o.length;s--;o[s]*=e);for(o[0]+=n.indexOf(t.charAt(a++)),i=0;i<o.length;i++)o[i]>r-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}return function(n,i,s,o,a){var c,u,f,h,l,d,p,g,y=n.indexOf("."),b=U,m=P;for(y>=0&&(h=M,M=0,n=n.replace(".",""),d=(g=new z(i)).pow(n.length-y),M=h,g.c=e(_(w(d.c),d.e,"0"),10,s,t),g.e=g.c.length),f=h=(p=e(n,i,s,a?(c=V,t):(c=t,V))).length;0==p[--h];p.pop());if(!p[0])return c.charAt(0);if(y<0?--f:(d.c=p,d.e=f,d.s=o,p=(d=r(d,g,b,m,s)).c,l=d.r,f=d.e),y=p[u=f+b+1],h=s/2,l=l||u<0||null!=p[u+1],l=m<4?(null!=y||l)&&(0==m||m==(d.s<0?3:2)):y>h||y==h&&(4==m||l||6==m&&1&p[u-1]||m==(d.s<0?8:7)),u<1||!p[0])n=l?_(c.charAt(1),-b,c.charAt(0)):c.charAt(0);else{if(p.length=u,l)for(--s;++p[--u]>s;)p[u]=0,u||(++f,p=[1].concat(p));for(h=p.length;!p[--h];);for(y=0,n="";y<=h;n+=c.charAt(p[y++]));n=_(n,f,c.charAt(0))}return n}}(),r=function(){function t(t,e,r){var n,i,s,o,a=0,c=t.length,u=e%p,f=e/p|0;for(t=t.slice();c--;)a=((i=u*(s=t[c]%p)+(n=f*s+(o=t[c]/p|0)*u)%p*p+a)/r|0)+(n/p|0)+f*o,t[c]=i%r;return a&&(t=[a].concat(t)),t}function e(t,e,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(t[i]!=e[i]){s=t[i]>e[i]?1:-1;break}return s}function r(t,e,r,n){for(var i=0;r--;)t[r]-=i,i=t[r]<e[r]?1:0,t[r]=i*n+t[r]-e[r];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(n,i,s,o,c){var u,l,d,p,g,w,b,m,v,E,_,I,B,x,A,T,S,O=n.s==i.s?1:-1,N=n.c,R=i.c;if(!(N&&N[0]&&R&&R[0]))return new z(n.s&&i.s&&(N?!R||N[0]!=R[0]:R)?N&&0==N[0]||!R?0*O:O/0:NaN);for(v=(m=new z(O)).c=[],O=s+(l=n.e-i.e)+1,c||(c=f,l=y(n.e/h)-y(i.e/h),O=O/h|0),d=0;R[d]==(N[d]||0);d++);if(R[d]>(N[d]||0)&&l--,O<0)v.push(1),p=!0;else{for(x=N.length,T=R.length,d=0,O+=2,(g=a(c/(R[0]+1)))>1&&(R=t(R,g,c),N=t(N,g,c),T=R.length,x=N.length),B=T,_=(E=N.slice(0,T)).length;_<T;E[_++]=0);S=R.slice(),S=[0].concat(S),A=R[0],R[1]>=c/2&&A++;do{if(g=0,(u=e(R,E,T,_))<0){if(I=E[0],T!=_&&(I=I*c+(E[1]||0)),(g=a(I/A))>1)for(g>=c&&(g=c-1),b=(w=t(R,g,c)).length,_=E.length;1==e(w,E,b,_);)g--,r(w,T<b?S:R,b,c),b=w.length,u=1;else 0==g&&(u=g=1),b=(w=R.slice()).length;if(b<_&&(w=[0].concat(w)),r(E,w,_,c),_=E.length,-1==u)for(;e(R,E,T,_)<1;)g++,r(E,T<_?S:R,_,c),_=E.length}else 0===u&&(g++,E=[0]);v[d++]=g,E[0]?E[_++]=N[B]||0:(E=[N[B]],_=1)}while((B++<x||null!=E[0])&&O--);p=null!=E[0],v[0]||v.splice(0,1)}if(c==f){for(d=1,O=v[0];O>=10;O/=10,d++);H(m,s+(m.e=d+l*h-1)+1,o,p)}else m.e=l,m.r=+p;return m}}(),x=/^(-?)0([xbo])(?=\w[\w.]*$)/i,A=/^([^.]+)\.$/,T=/^\.([^.]+)$/,S=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g,i=function(t,e,r,n){var i,s=r?e:e.replace(O,"");if(S.test(s))t.s=isNaN(s)?null:s<0?-1:1;else{if(!r&&(s=s.replace(x,(function(t,e,r){return i="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=i?t:e})),n&&(i=n,s=s.replace(A,"$1").replace(T,"0.$1")),e!=s))return new z(s,i);if(z.DEBUG)throw Error(c+"Not a"+(n?" base "+n:"")+" number: "+e);t.s=null}t.c=t.e=null},N.absoluteValue=N.abs=function(){var t=new z(this);return t.s<0&&(t.s=1),t},N.comparedTo=function(t,e){return b(this,new z(t,e))},N.decimalPlaces=N.dp=function(t,e){var r,n,i,s=this;if(null!=t)return m(t,0,g),null==e?e=P:m(e,0,8),H(new z(s),t+s.e+1,e);if(!(r=s.c))return null;if(n=((i=r.length-1)-y(this.e/h))*h,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},N.dividedBy=N.div=function(t,e){return r(this,new z(t,e),U,P)},N.dividedToIntegerBy=N.idiv=function(t,e){return r(this,new z(t,e),0,1)},N.exponentiatedBy=N.pow=function(t,e){var r,n,i,s,u,f,l,d,p=this;if((t=new z(t)).c&&!t.isInteger())throw Error(c+"Exponent not an integer: "+Y(t));if(null!=e&&(e=new z(e)),u=t.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!t.c||!t.c[0])return d=new z(Math.pow(+Y(p),u?t.s*(2-v(t)):+Y(t))),e?d.mod(e):d;if(f=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new z(NaN);(n=!f&&p.isInteger()&&e.isInteger())&&(p=p.mod(e))}else{if(t.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||u&&p.c[1]>=24e7:p.c[0]<8e13||u&&p.c[0]<=9999975e7)))return s=p.s<0&&v(t)?-0:0,p.e>-1&&(s=1/s),new z(f?1/s:s);M&&(s=o(M/h+2))}for(u?(r=new z(.5),f&&(t.s=1),l=v(t)):l=(i=Math.abs(+Y(t)))%2,d=new z(R);;){if(l){if(!(d=d.times(p)).c)break;s?d.c.length>s&&(d.c.length=s):n&&(d=d.mod(e))}if(i){if(0===(i=a(i/2)))break;l=i%2}else if(H(t=t.times(r),t.e+1,1),t.e>14)l=v(t);else{if(0==(i=+Y(t)))break;l=i%2}p=p.times(p),s?p.c&&p.c.length>s&&(p.c.length=s):n&&(p=p.mod(e))}return n?d:(f&&(d=R.div(d)),e?d.mod(e):s?H(d,M,P,void 0):d)},N.integerValue=function(t){var e=new z(this);return null==t?t=P:m(t,0,8),H(e,e.e+1,t)},N.isEqualTo=N.eq=function(t,e){return 0===b(this,new z(t,e))},N.isFinite=function(){return!!this.c},N.isGreaterThan=N.gt=function(t,e){return b(this,new z(t,e))>0},N.isGreaterThanOrEqualTo=N.gte=function(t,e){return 1===(e=b(this,new z(t,e)))||0===e},N.isInteger=function(){return!!this.c&&y(this.e/h)>this.c.length-2},N.isLessThan=N.lt=function(t,e){return b(this,new z(t,e))<0},N.isLessThanOrEqualTo=N.lte=function(t,e){return-1===(e=b(this,new z(t,e)))||0===e},N.isNaN=function(){return!this.s},N.isNegative=function(){return this.s<0},N.isPositive=function(){return this.s>0},N.isZero=function(){return!!this.c&&0==this.c[0]},N.minus=function(t,e){var r,n,i,s,o=this,a=o.s;if(e=(t=new z(t,e)).s,!a||!e)return new z(NaN);if(a!=e)return t.s=-e,o.plus(t);var c=o.e/h,u=t.e/h,l=o.c,d=t.c;if(!c||!u){if(!l||!d)return l?(t.s=-e,t):new z(d?o:NaN);if(!l[0]||!d[0])return d[0]?(t.s=-e,t):new z(l[0]?o:3==P?-0:0)}if(c=y(c),u=y(u),l=l.slice(),a=c-u){for((s=a<0)?(a=-a,i=l):(u=c,i=d),i.reverse(),e=a;e--;i.push(0));i.reverse()}else for(n=(s=(a=l.length)<(e=d.length))?a:e,a=e=0;e<n;e++)if(l[e]!=d[e]){s=l[e]<d[e];break}if(s&&(i=l,l=d,d=i,t.s=-t.s),(e=(n=d.length)-(r=l.length))>0)for(;e--;l[r++]=0);for(e=f-1;n>a;){if(l[--n]<d[n]){for(r=n;r&&!l[--r];l[r]=e);--l[r],l[n]+=f}l[n]-=d[n]}for(;0==l[0];l.splice(0,1),--u);return l[0]?W(t,l,u):(t.s=3==P?-1:1,t.c=[t.e=0],t)},N.modulo=N.mod=function(t,e){var n,i,s=this;return t=new z(t,e),!s.c||!t.s||t.c&&!t.c[0]?new z(NaN):!t.c||s.c&&!s.c[0]?new z(s):(9==C?(i=t.s,t.s=1,n=r(s,t,0,3),t.s=i,n.s*=i):n=r(s,t,0,C),(t=s.minus(n.times(t))).c[0]||1!=C||(t.s=s.s),t)},N.multipliedBy=N.times=function(t,e){var r,n,i,s,o,a,c,u,l,d,g,w,b,m,v,E=this,_=E.c,I=(t=new z(t,e)).c;if(!(_&&I&&_[0]&&I[0]))return!E.s||!t.s||_&&!_[0]&&!I||I&&!I[0]&&!_?t.c=t.e=t.s=null:(t.s*=E.s,_&&I?(t.c=[0],t.e=0):t.c=t.e=null),t;for(n=y(E.e/h)+y(t.e/h),t.s*=E.s,(c=_.length)<(d=I.length)&&(b=_,_=I,I=b,i=c,c=d,d=i),i=c+d,b=[];i--;b.push(0));for(m=f,v=p,i=d;--i>=0;){for(r=0,g=I[i]%v,w=I[i]/v|0,s=i+(o=c);s>i;)r=((u=g*(u=_[--o]%v)+(a=w*u+(l=_[o]/v|0)*g)%v*v+b[s]+r)/m|0)+(a/v|0)+w*l,b[s--]=u%m;b[s]=r}return r?++n:b.splice(0,1),W(t,b,n)},N.negated=function(){var t=new z(this);return t.s=-t.s||null,t},N.plus=function(t,e){var r,n=this,i=n.s;if(e=(t=new z(t,e)).s,!i||!e)return new z(NaN);if(i!=e)return t.s=-e,n.minus(t);var s=n.e/h,o=t.e/h,a=n.c,c=t.c;if(!s||!o){if(!a||!c)return new z(i/0);if(!a[0]||!c[0])return c[0]?t:new z(a[0]?n:0*i)}if(s=y(s),o=y(o),a=a.slice(),i=s-o){for(i>0?(o=s,r=c):(i=-i,r=a),r.reverse();i--;r.push(0));r.reverse()}for((i=a.length)-(e=c.length)<0&&(r=c,c=a,a=r,e=i),i=0;e;)i=(a[--e]=a[e]+c[e]+i)/f|0,a[e]=f===a[e]?0:a[e]%f;return i&&(a=[i].concat(a),++o),W(t,a,o)},N.precision=N.sd=function(t,e){var r,n,i,s=this;if(null!=t&&t!==!!t)return m(t,1,g),null==e?e=P:m(e,0,8),H(new z(s),t,e);if(!(r=s.c))return null;if(n=(i=r.length-1)*h+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return t&&s.e+1>n&&(n=s.e+1),n},N.shiftedBy=function(t){return m(t,-9007199254740991,l),this.times("1e"+t)},N.squareRoot=N.sqrt=function(){var t,e,n,i,s,o=this,a=o.c,c=o.s,u=o.e,f=U+4,h=new z("0.5");if(1!==c||!a||!a[0])return new z(!c||c<0&&(!a||a[0])?NaN:a?o:1/0);if(0==(c=Math.sqrt(+Y(o)))||c==1/0?(((e=w(a)).length+u)%2==0&&(e+="0"),c=Math.sqrt(+e),u=y((u+1)/2)-(u<0||u%2),n=new z(e=c==1/0?"5e"+u:(e=c.toExponential()).slice(0,e.indexOf("e")+1)+u)):n=new z(c+""),n.c[0])for((c=(u=n.e)+f)<3&&(c=0);;)if(s=n,n=h.times(s.plus(r(o,s,f,1))),w(s.c).slice(0,c)===(e=w(n.c)).slice(0,c)){if(n.e<u&&--c,"9999"!=(e=e.slice(c-3,c+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(H(n,n.e+U+2,1),t=!n.times(n).eq(o));break}if(!i&&(H(s,s.e+U+2,0),s.times(s).eq(o))){n=s;break}f+=4,c+=4,i=1}return H(n,n.e+U+1,P,t)},N.toExponential=function(t,e){return null!=t&&(m(t,0,g),t++),G(this,t,e,1)},N.toFixed=function(t,e){return null!=t&&(m(t,0,g),t=t+this.e+1),G(this,t,e)},N.toFormat=function(t,e,r){var n,i=this;if(null==r)null!=t&&e&&"object"==typeof e?(r=e,e=null):t&&"object"==typeof t?(r=t,t=e=null):r=q;else if("object"!=typeof r)throw Error(c+"Argument not an object: "+r);if(n=i.toFixed(t,e),i.c){var s,o=n.split("."),a=+r.groupSize,u=+r.secondaryGroupSize,f=r.groupSeparator||"",h=o[0],l=o[1],d=i.s<0,p=d?h.slice(1):h,g=p.length;if(u&&(s=a,a=u,u=s,g-=s),a>0&&g>0){for(s=g%a||a,h=p.substr(0,s);s<g;s+=a)h+=f+p.substr(s,a);u>0&&(h+=f+p.slice(s)),d&&(h="-"+h)}n=l?h+(r.decimalSeparator||"")+((u=+r.fractionGroupSize)?l.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):l):h}return(r.prefix||"")+n+(r.suffix||"")},N.toFraction=function(t){var e,n,i,s,o,a,u,f,l,p,g,y,b=this,m=b.c;if(null!=t&&(!(u=new z(t)).isInteger()&&(u.c||1!==u.s)||u.lt(R)))throw Error(c+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+Y(u));if(!m)return new z(b);for(e=new z(R),l=n=new z(R),i=f=new z(R),y=w(m),o=e.e=y.length-b.e-1,e.c[0]=d[(a=o%h)<0?h+a:a],t=!t||u.comparedTo(e)>0?o>0?e:l:u,a=L,L=1/0,u=new z(y),f.c[0]=0;p=r(u,e,0,1),1!=(s=n.plus(p.times(i))).comparedTo(t);)n=i,i=s,l=f.plus(p.times(s=l)),f=s,e=u.minus(p.times(s=e)),u=s;return s=r(t.minus(n),i,0,1),f=f.plus(s.times(l)),n=n.plus(s.times(i)),f.s=l.s=b.s,g=r(l,i,o*=2,P).minus(b).abs().comparedTo(r(f,n,o,P).minus(b).abs())<1?[l,i]:[f,n],L=a,g},N.toNumber=function(){return+Y(this)},N.toPrecision=function(t,e){return null!=t&&m(t,1,g),G(this,t,e,2)},N.toString=function(t){var e,r=this,i=r.s,s=r.e;return null===s?i?(e="Infinity",i<0&&(e="-"+e)):e="NaN":(null==t?e=s<=k||s>=j?E(w(r.c),s):_(w(r.c),s,"0"):10===t&&$?e=_(w((r=H(new z(r),U+s+1,P)).c),r.e,"0"):(m(t,2,V.length,"Base"),e=n(_(w(r.c),s,"0"),10,t,i,!0)),i<0&&r.c[0]&&(e="-"+e)),e},N.valueOf=N.toJSON=function(){return Y(this)},N._isBigNumber=!0,null!=e&&z.set(e),z}(),i.default=i.BigNumber=i,void 0===(n=function(){return i}.call(e,r,e,t))||(t.exports=n)}()},279:(t,e,r)=>{"use strict";var n=r(526),i=r(251),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=c,e.SlowBuffer=function(t){return+t!=t&&(t=0),c.alloc(+t)},e.INSPECT_MAX_BYTES=50;var o=2147483647;function a(t){if(t>o)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,c.prototype),e}function c(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return u(t,e,r)}function u(t,e,r){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!c.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|g(t,e),n=a(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(q(t,Uint8Array)){var e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return l(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(q(t,ArrayBuffer)||t&&q(t.buffer,ArrayBuffer))return d(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(q(t,SharedArrayBuffer)||t&&q(t.buffer,SharedArrayBuffer)))return d(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return c.from(n,e,r);var i=function(t){if(c.isBuffer(t)){var e=0|p(t.length),r=a(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||V(t.length)?a(0):l(t):"Buffer"===t.type&&Array.isArray(t.data)?l(t.data):void 0}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return c.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return f(t),a(t<0?0:0|p(t))}function l(t){for(var e=t.length<0?0:0|p(t.length),r=a(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function d(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,c.prototype),n}function p(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function g(t,e){if(c.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||q(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return D(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return C(t).length;default:if(i)return n?-1:D(t).length;e=(""+e).toLowerCase(),i=!0}}function y(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return N(this,e,r);case"utf8":case"utf-8":return A(this,e,r);case"ascii":return S(this,e,r);case"latin1":case"binary":return O(this,e,r);case"base64":return x(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function w(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function b(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),V(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=c.from(e,n)),c.isBuffer(e))return 0===e.length?-1:m(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):m(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,r,n,i){var s,o=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,a/=2,c/=2,r/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var f=-1;for(s=r;s<a;s++)if(u(t,s)===u(e,-1===f?0:s-f)){if(-1===f&&(f=s),s-f+1===c)return f*o}else-1!==f&&(s-=s-f),f=-1}else for(r+c>a&&(r=a-c),s=r;s>=0;s--){for(var h=!0,l=0;l<c;l++)if(u(t,s+l)!==u(e,l)){h=!1;break}if(h)return s}return-1}function v(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var s=e.length;n>s/2&&(n=s/2);for(var o=0;o<n;++o){var a=parseInt(e.substr(2*o,2),16);if(V(a))return o;t[r+o]=a}return o}function E(t,e,r,n){return M(D(e,t.length-r),t,r,n)}function _(t,e,r,n){return M(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function I(t,e,r,n){return M(C(e),t,r,n)}function B(t,e,r,n){return M(function(t,e){for(var r,n,i,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=(r=t.charCodeAt(o))>>8,i=r%256,s.push(i),s.push(n);return s}(e,t.length-r),t,r,n)}function x(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function A(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var s,o,a,c,u=t[i],f=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=r)switch(h){case 1:u<128&&(f=u);break;case 2:128==(192&(s=t[i+1]))&&(c=(31&u)<<6|63&s)>127&&(f=c);break;case 3:s=t[i+1],o=t[i+2],128==(192&s)&&128==(192&o)&&(c=(15&u)<<12|(63&s)<<6|63&o)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:s=t[i+1],o=t[i+2],a=t[i+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(c=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&c<1114112&&(f=c)}null===f?(f=65533,h=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),i+=h}return function(t){var e=t.length;if(e<=T)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=T));return r}(n)}e.kMaxLength=o,c.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(t,e,r){return u(t,e,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(t,e,r){return function(t,e,r){return f(t),t<=0?a(t):void 0!==e?"string"==typeof r?a(t).fill(e,r):a(t).fill(e):a(t)}(t,e,r)},c.allocUnsafe=function(t){return h(t)},c.allocUnsafeSlow=function(t){return h(t)},c.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==c.prototype},c.compare=function(t,e){if(q(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),q(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,i=0,s=Math.min(r,n);i<s;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=c.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var s=t[r];if(q(s,Uint8Array))i+s.length>n.length?c.from(s).copy(n,i):Uint8Array.prototype.set.call(n,s,i);else{if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i)}i+=s.length}return n},c.byteLength=g,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)w(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)w(this,e,e+3),w(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)w(this,e,e+7),w(this,e+1,e+6),w(this,e+2,e+5),w(this,e+3,e+4);return this},c.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?A(this,0,t):y.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},s&&(c.prototype[s]=c.prototype.inspect),c.prototype.compare=function(t,e,r,n,i){if(q(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(e>>>=0),a=Math.min(s,o),u=this.slice(n,i),f=t.slice(e,r),h=0;h<a;++h)if(u[h]!==f[h]){s=u[h],o=f[h];break}return s<o?-1:o<s?1:0},c.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},c.prototype.indexOf=function(t,e,r){return b(this,t,e,r,!0)},c.prototype.lastIndexOf=function(t,e,r){return b(this,t,e,r,!1)},c.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return v(this,t,e,r);case"utf8":case"utf-8":return E(this,t,e,r);case"ascii":case"latin1":case"binary":return _(this,t,e,r);case"base64":return I(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function S(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function O(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function N(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=e;s<r;++s)i+=$[t[s]];return i}function R(t,e,r){for(var n=t.slice(e,r),i="",s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}function U(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function P(t,e,r,n,i,s){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function k(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(t,e,r,n,s){return e=+e,r>>>=0,s||k(t,0,r,4),i.write(t,e,r,n,23,4),r+4}function F(t,e,r,n,s){return e=+e,r>>>=0,s||k(t,0,r,8),i.write(t,e,r,n,52,8),r+8}c.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);for(var n=this[t],i=1,s=0;++s<e&&(i*=256);)n+=this[t+s]*i;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},c.prototype.readUint8=c.prototype.readUInt8=function(t,e){return t>>>=0,e||U(t,1,this.length),this[t]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(t,e){return t>>>=0,e||U(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(t,e){return t>>>=0,e||U(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(t,e){return t>>>=0,e||U(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(t,e){return t>>>=0,e||U(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);for(var n=this[t],i=1,s=0;++s<e&&(i*=256);)n+=this[t+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},c.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);for(var n=e,i=1,s=this[t+--n];n>0&&(i*=256);)s+=this[t+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},c.prototype.readInt8=function(t,e){return t>>>=0,e||U(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){t>>>=0,e||U(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(t,e){t>>>=0,e||U(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(t,e){return t>>>=0,e||U(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return t>>>=0,e||U(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return t>>>=0,e||U(t,4,this.length),i.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return t>>>=0,e||U(t,4,this.length),i.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return t>>>=0,e||U(t,8,this.length),i.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return t>>>=0,e||U(t,8,this.length),i.read(this,t,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||P(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,s=0;for(this[e]=255&t;++s<r&&(i*=256);)this[e+s]=t/i&255;return e+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||P(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,1,255,0),this[e]=255&t,e+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);P(this,t,e,r,i-1,-i)}var s=0,o=1,a=0;for(this[e]=255&t;++s<r&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o|0)-a&255;return e+r},c.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);P(this,t,e,r,i-1,-i)}var s=r-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o|0)-a&255;return e+r},c.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},c.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeFloatLE=function(t,e,r){return j(this,t,e,!0,r)},c.prototype.writeFloatBE=function(t,e,r){return j(this,t,e,!1,r)},c.prototype.writeDoubleLE=function(t,e,r){return F(this,t,e,!0,r)},c.prototype.writeDoubleBE=function(t,e,r){return F(this,t,e,!1,r)},c.prototype.copy=function(t,e,r,n){if(!c.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},c.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var i=t.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var o=c.isBuffer(t)?t:c.from(t,n),a=o.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<r-e;++s)this[s+e]=o[s%a]}return this};var L=/[^+/0-9A-Za-z-_]/g;function D(t,e){var r;e=e||1/0;for(var n=t.length,i=null,s=[],o=0;o<n;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function C(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function M(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function q(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function V(t){return t!=t}var $=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)e[n+i]=t[r]+t[i];return e}()},729:(t,e,r)=>{"use strict";const n=r(594).BigNumber;e.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},e.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36},e.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},e.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},e.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")},e.SHIFT32=Math.pow(2,32),e.SHIFT16=Math.pow(2,16),e.MAX_SAFE_HIGH=2097151,e.NEG_ONE=new n(-1),e.TEN=new n(10),e.TWO=new n(2),e.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5}},637:t=>{t.exports=function(t,e,r){"use asm";var n=new t.Uint8Array(r);var i=e.pushInt;var s=e.pushInt32;var o=e.pushInt32Neg;var a=e.pushInt64;var c=e.pushInt64Neg;var u=e.pushFloat;var f=e.pushFloatSingle;var h=e.pushFloatDouble;var l=e.pushTrue;var d=e.pushFalse;var p=e.pushUndefined;var g=e.pushNull;var y=e.pushInfinity;var w=e.pushInfinityNeg;var b=e.pushNaN;var m=e.pushNaNNeg;var v=e.pushArrayStart;var E=e.pushArrayStartFixed;var _=e.pushArrayStartFixed32;var I=e.pushArrayStartFixed64;var B=e.pushObjectStart;var x=e.pushObjectStartFixed;var A=e.pushObjectStartFixed32;var T=e.pushObjectStartFixed64;var S=e.pushByteString;var O=e.pushByteStringStart;var N=e.pushUtf8String;var R=e.pushUtf8StringStart;var U=e.pushSimpleUnassigned;var P=e.pushTagStart;var k=e.pushTagStart4;var j=e.pushTagStart8;var F=e.pushTagUnassigned;var L=e.pushBreak;var D=t.Math.pow;var C=0;var M=0;var q=0;function V(t){t=t|0;C=0;M=t;while((C|0)<(M|0)){q=Zt[n[C]&255](n[C]|0)|0;if((q|0)>0){break}}return q|0}function $(t){t=t|0;if(((C|0)+(t|0)|0)<(M|0)){return 0}return 1}function z(t){t=t|0;return n[t|0]<<8|n[t+1|0]|0}function G(t){t=t|0;return n[t|0]<<24|n[t+1|0]<<16|n[t+2|0]<<8|n[t+3|0]|0}function K(t){t=t|0;i(t|0);C=C+1|0;return 0}function W(t){t=t|0;if($(1)|0){return 1}i(n[C+1|0]|0);C=C+2|0;return 0}function H(t){t=t|0;if($(2)|0){return 1}i(z(C+1|0)|0);C=C+3|0;return 0}function Y(t){t=t|0;if($(4)|0){return 1}s(z(C+1|0)|0,z(C+3|0)|0);C=C+5|0;return 0}function Z(t){t=t|0;if($(8)|0){return 1}a(z(C+1|0)|0,z(C+3|0)|0,z(C+5|0)|0,z(C+7|0)|0);C=C+9|0;return 0}function J(t){t=t|0;i(-1-(t-32|0)|0);C=C+1|0;return 0}function X(t){t=t|0;if($(1)|0){return 1}i(-1-(n[C+1|0]|0)|0);C=C+2|0;return 0}function Q(t){t=t|0;var e=0;if($(2)|0){return 1}e=z(C+1|0)|0;i(-1-(e|0)|0);C=C+3|0;return 0}function tt(t){t=t|0;if($(4)|0){return 1}o(z(C+1|0)|0,z(C+3|0)|0);C=C+5|0;return 0}function et(t){t=t|0;if($(8)|0){return 1}c(z(C+1|0)|0,z(C+3|0)|0,z(C+5|0)|0,z(C+7|0)|0);C=C+9|0;return 0}function rt(t){t=t|0;var e=0;var r=0;var n=0;n=t-64|0;if($(n|0)|0){return 1}e=C+1|0;r=(C+1|0)+(n|0)|0;S(e|0,r|0);C=r|0;return 0}function nt(t){t=t|0;var e=0;var r=0;var i=0;if($(1)|0){return 1}i=n[C+1|0]|0;e=C+2|0;r=(C+2|0)+(i|0)|0;if($(i+1|0)|0){return 1}S(e|0,r|0);C=r|0;return 0}function it(t){t=t|0;var e=0;var r=0;var n=0;if($(2)|0){return 1}n=z(C+1|0)|0;e=C+3|0;r=(C+3|0)+(n|0)|0;if($(n+2|0)|0){return 1}S(e|0,r|0);C=r|0;return 0}function st(t){t=t|0;var e=0;var r=0;var n=0;if($(4)|0){return 1}n=G(C+1|0)|0;e=C+5|0;r=(C+5|0)+(n|0)|0;if($(n+4|0)|0){return 1}S(e|0,r|0);C=r|0;return 0}function ot(t){t=t|0;return 1}function at(t){t=t|0;O();C=C+1|0;return 0}function ct(t){t=t|0;var e=0;var r=0;var n=0;n=t-96|0;if($(n|0)|0){return 1}e=C+1|0;r=(C+1|0)+(n|0)|0;N(e|0,r|0);C=r|0;return 0}function ut(t){t=t|0;var e=0;var r=0;var i=0;if($(1)|0){return 1}i=n[C+1|0]|0;e=C+2|0;r=(C+2|0)+(i|0)|0;if($(i+1|0)|0){return 1}N(e|0,r|0);C=r|0;return 0}function ft(t){t=t|0;var e=0;var r=0;var n=0;if($(2)|0){return 1}n=z(C+1|0)|0;e=C+3|0;r=(C+3|0)+(n|0)|0;if($(n+2|0)|0){return 1}N(e|0,r|0);C=r|0;return 0}function ht(t){t=t|0;var e=0;var r=0;var n=0;if($(4)|0){return 1}n=G(C+1|0)|0;e=C+5|0;r=(C+5|0)+(n|0)|0;if($(n+4|0)|0){return 1}N(e|0,r|0);C=r|0;return 0}function lt(t){t=t|0;return 1}function dt(t){t=t|0;R();C=C+1|0;return 0}function pt(t){t=t|0;E(t-128|0);C=C+1|0;return 0}function gt(t){t=t|0;if($(1)|0){return 1}E(n[C+1|0]|0);C=C+2|0;return 0}function yt(t){t=t|0;if($(2)|0){return 1}E(z(C+1|0)|0);C=C+3|0;return 0}function wt(t){t=t|0;if($(4)|0){return 1}_(z(C+1|0)|0,z(C+3|0)|0);C=C+5|0;return 0}function bt(t){t=t|0;if($(8)|0){return 1}I(z(C+1|0)|0,z(C+3|0)|0,z(C+5|0)|0,z(C+7|0)|0);C=C+9|0;return 0}function mt(t){t=t|0;v();C=C+1|0;return 0}function vt(t){t=t|0;var e=0;e=t-160|0;if($(e|0)|0){return 1}x(e|0);C=C+1|0;return 0}function Et(t){t=t|0;if($(1)|0){return 1}x(n[C+1|0]|0);C=C+2|0;return 0}function _t(t){t=t|0;if($(2)|0){return 1}x(z(C+1|0)|0);C=C+3|0;return 0}function It(t){t=t|0;if($(4)|0){return 1}A(z(C+1|0)|0,z(C+3|0)|0);C=C+5|0;return 0}function Bt(t){t=t|0;if($(8)|0){return 1}T(z(C+1|0)|0,z(C+3|0)|0,z(C+5|0)|0,z(C+7|0)|0);C=C+9|0;return 0}function xt(t){t=t|0;B();C=C+1|0;return 0}function At(t){t=t|0;P(t-192|0|0);C=C+1|0;return 0}function Tt(t){0;P(t|0);C=C+1|0;return 0}function St(t){0;P(t|0);C=C+1|0;return 0}function Ot(t){0;P(t|0);C=C+1|0;return 0}function Nt(t){0;P(t|0);C=C+1|0;return 0}function Rt(t){t=t|0;P(t-192|0|0);C=C+1|0;return 0}function Ut(t){0;P(t|0);C=C+1|0;return 0}function Pt(t){0;P(t|0);C=C+1|0;return 0}function kt(t){0;P(t|0);C=C+1|0;return 0}function jt(t){t=t|0;if($(1)|0){return 1}P(n[C+1|0]|0);C=C+2|0;return 0}function Ft(t){t=t|0;if($(2)|0){return 1}P(z(C+1|0)|0);C=C+3|0;return 0}function Lt(t){t=t|0;if($(4)|0){return 1}k(z(C+1|0)|0,z(C+3|0)|0);C=C+5|0;return 0}function Dt(t){t=t|0;if($(8)|0){return 1}j(z(C+1|0)|0,z(C+3|0)|0,z(C+5|0)|0,z(C+7|0)|0);C=C+9|0;return 0}function Ct(t){t=t|0;U((t|0)-224|0);C=C+1|0;return 0}function Mt(t){t=t|0;d();C=C+1|0;return 0}function qt(t){t=t|0;l();C=C+1|0;return 0}function Vt(t){t=t|0;g();C=C+1|0;return 0}function $t(t){t=t|0;p();C=C+1|0;return 0}function zt(t){t=t|0;if($(1)|0){return 1}U(n[C+1|0]|0);C=C+2|0;return 0}function Gt(t){t=t|0;var e=0;var r=0;var i=1.0;var s=0.0;var o=0.0;var a=0.0;if($(2)|0){return 1}e=n[C+1|0]|0;r=n[C+2|0]|0;if((e|0)&0x80){i=-1.0}s=+(((e|0)&0x7C)>>2);o=+(((e|0)&0x03)<<8|r);if(+s==0.0){u(+(+i*+5.9604644775390625e-8*+o))}else if(+s==31.0){if(+i==1.0){if(+o>0.0){b()}else{y()}}else{if(+o>0.0){m()}else{w()}}}else{u(+(+i*D(+2,+(+s-25.0))*+(1024.0+o)))}C=C+3|0;return 0}function Kt(t){t=t|0;if($(4)|0){return 1}f(n[C+1|0]|0,n[C+2|0]|0,n[C+3|0]|0,n[C+4|0]|0);C=C+5|0;return 0}function Wt(t){t=t|0;if($(8)|0){return 1}h(n[C+1|0]|0,n[C+2|0]|0,n[C+3|0]|0,n[C+4|0]|0,n[C+5|0]|0,n[C+6|0]|0,n[C+7|0]|0,n[C+8|0]|0);C=C+9|0;return 0}function Ht(t){t=t|0;return 1}function Yt(t){t=t|0;L();C=C+1|0;return 0}var Zt=[K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,W,H,Y,Z,Ht,Ht,Ht,Ht,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,X,Q,tt,et,Ht,Ht,Ht,Ht,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,nt,it,st,ot,Ht,Ht,Ht,at,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ut,ft,ht,lt,Ht,Ht,Ht,dt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,gt,yt,wt,bt,Ht,Ht,Ht,mt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,Et,_t,It,Bt,Ht,Ht,Ht,xt,At,At,At,At,At,At,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,jt,Ft,Lt,Dt,Ht,Ht,Ht,Ht,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Mt,qt,Vt,$t,zt,Gt,Kt,Wt,Ht,Ht,Ht,Yt];return{parse:V}}},416:(t,e,r)=>{"use strict";const{Buffer:n}=r(279),i=r(251),s=r(594).BigNumber,o=r(637),a=r(205),c=r(729),u=r(80),f=r(994),{URL:h}=r(438);class l{constructor(t){!(t=t||{}).size||t.size<65536?t.size=65536:t.size=a.nextPowerOf2(t.size),this._heap=new ArrayBuffer(t.size),this._heap8=new Uint8Array(this._heap),this._buffer=n.from(this._heap),this._reset(),this._knownTags=Object.assign({0:t=>new Date(t),1:t=>new Date(1e3*t),2:t=>a.arrayBufferToBignumber(t),3:t=>c.NEG_ONE.minus(a.arrayBufferToBignumber(t)),4:t=>c.TEN.pow(t[0]).times(t[1]),5:t=>c.TWO.pow(t[0]).times(t[1]),32:t=>new h(t),35:t=>new RegExp(t)},t.tags),this.parser=o(r.g,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var t=this._parents.pop();if(t.length>0)throw new Error(`Missing ${t.length} elements`);switch(t.type){case c.PARENT.TAG:this._push(this.createTag(t.ref[0],t.ref[1]));break;case c.PARENT.BYTE_STRING:this._push(this.createByteString(t.ref,t.length));break;case c.PARENT.UTF8_STRING:this._push(this.createUtf8String(t.ref,t.length));break;case c.PARENT.MAP:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(t.ref,t.length));break;case c.PARENT.OBJECT:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(t.ref,t.length));break;case c.PARENT.ARRAY:this._push(this.createArray(t.ref,t.length))}this._currentParent&&this._currentParent.type===c.PARENT.TAG&&this._dec()}_dec(){const t=this._currentParent;t.length<0||(t.length--,0===t.length&&this._closeParent())}_push(t,e){const r=this._currentParent;switch(r.values++,r.type){case c.PARENT.ARRAY:case c.PARENT.BYTE_STRING:case c.PARENT.UTF8_STRING:r.length>-1?this._ref[this._ref.length-r.length]=t:this._ref.push(t),this._dec();break;case c.PARENT.OBJECT:null!=r.tmpKey?(this._ref[r.tmpKey]=t,r.tmpKey=null,this._dec()):(r.tmpKey=t,"string"!=typeof r.tmpKey&&(r.type=c.PARENT.MAP,r.ref=a.buildMap(r.ref)));break;case c.PARENT.MAP:null!=r.tmpKey?(this._ref.set(r.tmpKey,t),r.tmpKey=null,this._dec()):r.tmpKey=t;break;case c.PARENT.TAG:this._ref.push(t),e||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(t,e,r){this._parents[this._depth]={type:e,length:r,ref:t,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:c.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(t,e){const r=this._knownTags[t];return r?r(e):new f(t,e)}createMap(t,e){return t}createObject(t,e){return t}createArray(t,e){return t}createByteString(t,e){return n.concat(t)}createByteStringFromHeap(t,e){return t===e?n.alloc(0):n.from(this._heap.slice(t,e))}createInt(t){return t}createInt32(t,e){return a.buildInt32(t,e)}createInt64(t,e,r,n){return a.buildInt64(t,e,r,n)}createFloat(t){return t}createFloatSingle(t,e,r,n){return i.read([t,e,r,n],0,!1,23,4)}createFloatDouble(t,e,r,n,s,o,a,c){return i.read([t,e,r,n,s,o,a,c],0,!1,52,8)}createInt32Neg(t,e){return-1-a.buildInt32(t,e)}createInt64Neg(t,e,r,n){const i=a.buildInt32(t,e),o=a.buildInt32(r,n);return i>c.MAX_SAFE_HIGH?c.NEG_ONE.minus(new s(i).times(c.SHIFT32).plus(o)):-1-(i*c.SHIFT32+o)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(t,e){return t.join("")}createUtf8StringFromHeap(t,e){return t===e?"":this._buffer.toString("utf8",t,e)}createSimpleUnassigned(t){return new u(t)}pushInt(t){this._push(this.createInt(t))}pushInt32(t,e){this._push(this.createInt32(t,e))}pushInt64(t,e,r,n){this._push(this.createInt64(t,e,r,n))}pushFloat(t){this._push(this.createFloat(t))}pushFloatSingle(t,e,r,n){this._push(this.createFloatSingle(t,e,r,n))}pushFloatDouble(t,e,r,n,i,s,o,a){this._push(this.createFloatDouble(t,e,r,n,i,s,o,a))}pushInt32Neg(t,e){this._push(this.createInt32Neg(t,e))}pushInt64Neg(t,e,r,n){this._push(this.createInt64Neg(t,e,r,n))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],c.PARENT.ARRAY,-1)}pushArrayStartFixed(t){this._createArrayStartFixed(t)}pushArrayStartFixed32(t,e){const r=a.buildInt32(t,e);this._createArrayStartFixed(r)}pushArrayStartFixed64(t,e,r,n){const i=a.buildInt64(t,e,r,n);this._createArrayStartFixed(i)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(t){this._createObjectStartFixed(t)}pushObjectStartFixed32(t,e){const r=a.buildInt32(t,e);this._createObjectStartFixed(r)}pushObjectStartFixed64(t,e,r,n){const i=a.buildInt64(t,e,r,n);this._createObjectStartFixed(i)}pushByteStringStart(){this._parents[this._depth]={type:c.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(t,e){this._push(this.createByteStringFromHeap(t,e))}pushUtf8StringStart(){this._parents[this._depth]={type:c.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(t,e){this._push(this.createUtf8StringFromHeap(t,e))}pushSimpleUnassigned(t){this._push(this.createSimpleUnassigned(t))}pushTagStart(t){this._parents[this._depth]={type:c.PARENT.TAG,length:1,ref:[t]}}pushTagStart4(t,e){this.pushTagStart(a.buildInt32(t,e))}pushTagStart8(t,e,r,n){this.pushTagStart(a.buildInt64(t,e,r,n))}pushTagUnassigned(t){this._push(this.createTag(t))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(t){0!==t?this._createParent({},c.PARENT.OBJECT,t):this._push(this.createObject({}))}_createArrayStartFixed(t){0!==t?this._createParent(new Array(t),c.PARENT.ARRAY,t):this._push(this.createArray([]))}_decode(t){if(0===t.byteLength)throw new Error("Input too short");this._reset(),this._heap8.set(t);const e=this.parser.parse(t.byteLength);if(this._depth>1){for(;0===this._currentParent.length;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(e>0)throw new Error("Failed to parse");if(0===this._res.length)throw new Error("No valid result")}decodeFirst(t){return this._decode(t),this._res[0]}decodeAll(t){return this._decode(t),this._res}static decode(t,e){return"string"==typeof t&&(t=n.from(t,e||"hex")),new l({size:t.length}).decodeFirst(t)}static decodeAll(t,e){return"string"==typeof t&&(t=n.from(t,e||"hex")),new l({size:t.length}).decodeAll(t)}}l.decodeFirst=l.decode,t.exports=l},858:(t,e,r)=>{"use strict";const{Buffer:n}=r(279),i=r(416),s=r(205);class o extends i{createTag(t,e){return`${t}(${e})`}createInt(t){return super.createInt(t).toString()}createInt32(t,e){return super.createInt32(t,e).toString()}createInt64(t,e,r,n){return super.createInt64(t,e,r,n).toString()}createInt32Neg(t,e){return super.createInt32Neg(t,e).toString()}createInt64Neg(t,e,r,n){return super.createInt64Neg(t,e,r,n).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(t){const e=super.createFloat(t);return s.isNegativeZero(t)?"-0_1":`${e}_1`}createFloatSingle(t,e,r,n){return`${super.createFloatSingle(t,e,r,n)}_2`}createFloatDouble(t,e,r,n,i,s,o,a){return`${super.createFloatDouble(t,e,r,n,i,s,o,a)}_3`}createByteString(t,e){const r=t.join(", ");return-1===e?`(_ ${r})`:`h'${r}`}createByteStringFromHeap(t,e){return`h'${n.from(super.createByteStringFromHeap(t,e)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(t){return`simple(${t})`}createArray(t,e){const r=super.createArray(t,e);return-1===e?`[_ ${r.join(", ")}]`:`[${r.join(", ")}]`}createMap(t,e){const r=super.createMap(t),n=Array.from(r.keys()).reduce(a(r),"");return-1===e?`{_ ${n}}`:`{${n}}`}createObject(t,e){const r=super.createObject(t),n=Object.keys(r).reduce(a(r),"");return-1===e?`{_ ${n}}`:`{${n}}`}createUtf8String(t,e){const r=t.join(", ");return-1===e?`(_ ${r})`:`"${r}"`}createUtf8StringFromHeap(t,e){return`"${n.from(super.createUtf8StringFromHeap(t,e)).toString("utf8")}"`}static diagnose(t,e){return"string"==typeof t&&(t=n.from(t,e||"hex")),(new o).decodeFirst(t)}}function a(t){return(e,r)=>e?`${e}, ${r}: ${t[r]}`:`${r}: ${t[r]}`}t.exports=o},928:(t,e,r)=>{"use strict";const{Buffer:n}=r(279),{URL:i}=r(438),s=r(594).BigNumber,o=r(205),a=r(729),c=a.MT,u=a.NUMBYTES,f=a.SHIFT32,h=a.SYMS,l=a.TAG,d=a.MT.SIMPLE_FLOAT<<5|a.NUMBYTES.TWO,p=a.MT.SIMPLE_FLOAT<<5|a.NUMBYTES.FOUR,g=a.MT.SIMPLE_FLOAT<<5|a.NUMBYTES.EIGHT,y=a.MT.SIMPLE_FLOAT<<5|a.SIMPLE.TRUE,w=a.MT.SIMPLE_FLOAT<<5|a.SIMPLE.FALSE,b=a.MT.SIMPLE_FLOAT<<5|a.SIMPLE.UNDEFINED,m=a.MT.SIMPLE_FLOAT<<5|a.SIMPLE.NULL,v=new s("0x20000000000000"),E=n.from("f97e00","hex"),_=n.from("f9fc00","hex"),I=n.from("f97c00","hex");class B{constructor(t){t=t||{},this.streaming="function"==typeof t.stream,this.onData=t.stream,this.semanticTypes=[[i,this._pushUrl],[s,this._pushBigNumber]];const e=t.genTypes||[],r=e.length;for(let t=0;t<r;t++)this.addSemanticType(e[t][0],e[t][1]);this._reset()}addSemanticType(t,e){const r=this.semanticTypes.length;for(let n=0;n<r;n++)if(this.semanticTypes[n][0]===t){const t=this.semanticTypes[n][1];return this.semanticTypes[n][1]=e,t}return this.semanticTypes.push([t,e]),null}push(t){return!t||(this.result[this.offset]=t,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=t.length,this.offset++,this.streaming&&this.onData(this.finalize()),!0)}pushWrite(t,e,r){return this.result[this.offset]=t,this.resultMethod[this.offset]=e,this.resultLength[this.offset]=r,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(t){return this.pushWrite(t,1,1)}_pushUInt16BE(t){return this.pushWrite(t,2,2)}_pushUInt32BE(t){return this.pushWrite(t,3,4)}_pushDoubleBE(t){return this.pushWrite(t,4,8)}_pushNaN(){return this.push(E)}_pushInfinity(t){const e=t<0?_:I;return this.push(e)}_pushFloat(t){const e=n.allocUnsafe(2);if(o.writeHalf(e,t)&&o.parseHalf(e)===t)return this._pushUInt8(d)&&this.push(e);const r=n.allocUnsafe(4);return r.writeFloatBE(t,0),r.readFloatBE(0)===t?this._pushUInt8(p)&&this.push(r):this._pushUInt8(g)&&this._pushDoubleBE(t)}_pushInt(t,e,r){const n=e<<5;return t<24?this._pushUInt8(n|t):t<=255?this._pushUInt8(n|u.ONE)&&this._pushUInt8(t):t<=65535?this._pushUInt8(n|u.TWO)&&this._pushUInt16BE(t):t<=4294967295?this._pushUInt8(n|u.FOUR)&&this._pushUInt32BE(t):t<=Number.MAX_SAFE_INTEGER?this._pushUInt8(n|u.EIGHT)&&this._pushUInt32BE(Math.floor(t/f))&&this._pushUInt32BE(t%f):e===c.NEG_INT?this._pushFloat(r):this._pushFloat(t)}_pushIntNum(t){return t<0?this._pushInt(-t-1,c.NEG_INT,t):this._pushInt(t,c.POS_INT)}_pushNumber(t){switch(!1){case t==t:return this._pushNaN(t);case isFinite(t):return this._pushInfinity(t);case t%1!=0:return this._pushIntNum(t);default:return this._pushFloat(t)}}_pushString(t){const e=n.byteLength(t,"utf8");return this._pushInt(e,c.UTF8_STRING)&&this.pushWrite(t,5,e)}_pushBoolean(t){return this._pushUInt8(t?y:w)}_pushUndefined(t){return this._pushUInt8(b)}_pushArray(t,e){const r=e.length;if(!t._pushInt(r,c.ARRAY))return!1;for(let n=0;n<r;n++)if(!t.pushAny(e[n]))return!1;return!0}_pushTag(t){return this._pushInt(t,c.TAG)}_pushDate(t,e){return t._pushTag(l.DATE_EPOCH)&&t.pushAny(Math.round(e/1e3))}_pushBuffer(t,e){return t._pushInt(e.length,c.BYTE_STRING)&&t.push(e)}_pushNoFilter(t,e){return t._pushBuffer(t,e.slice())}_pushRegexp(t,e){return t._pushTag(l.REGEXP)&&t.pushAny(e.source)}_pushSet(t,e){if(!t._pushInt(e.size,c.ARRAY))return!1;for(const r of e)if(!t.pushAny(r))return!1;return!0}_pushUrl(t,e){return t._pushTag(l.URI)&&t.pushAny(e.format())}_pushBigint(t){let e=l.POS_BIGINT;t.isNegative()&&(t=t.negated().minus(1),e=l.NEG_BIGINT);let r=t.toString(16);r.length%2&&(r="0"+r);const i=n.from(r,"hex");return this._pushTag(e)&&this._pushBuffer(this,i)}_pushBigNumber(t,e){if(e.isNaN())return t._pushNaN();if(!e.isFinite())return t._pushInfinity(e.isNegative()?-1/0:1/0);if(e.isInteger())return t._pushBigint(e);if(!t._pushTag(l.DECIMAL_FRAC)||!t._pushInt(2,c.ARRAY))return!1;const r=e.decimalPlaces(),n=e.multipliedBy(new s(10).pow(r));return!!t._pushIntNum(-r)&&(n.abs().isLessThan(v)?t._pushIntNum(n.toNumber()):t._pushBigint(n))}_pushMap(t,e){return!!t._pushInt(e.size,c.MAP)&&this._pushRawMap(e.size,Array.from(e))}_pushObject(t){if(!t)return this._pushUInt8(m);for(var e=this.semanticTypes.length,r=0;r<e;r++)if(t instanceof this.semanticTypes[r][0])return this.semanticTypes[r][1].call(t,this,t);var n=t.encodeCBOR;if("function"==typeof n)return n.call(t,this);var i=Object.keys(t),s=i.length;return!!this._pushInt(s,c.MAP)&&this._pushRawMap(s,i.map((e=>[e,t[e]])))}_pushRawMap(t,e){e=e.map((function(t){return t[0]=B.encode(t[0]),t})).sort(o.keySorter);for(var r=0;r<t;r++){if(!this.push(e[r][0]))return!1;if(!this.pushAny(e[r][1]))return!1}return!0}write(t){return this.pushAny(t)}pushAny(t){var e=function(t){return{}.toString.call(t).slice(8,-1)}(t);switch(e){case"Number":return this._pushNumber(t);case"String":return this._pushString(t);case"Boolean":return this._pushBoolean(t);case"Object":return this._pushObject(t);case"Array":return this._pushArray(this,t);case"Uint8Array":return this._pushBuffer(this,n.isBuffer(t)?t:n.from(t));case"Null":return this._pushUInt8(m);case"Undefined":return this._pushUndefined(t);case"Map":return this._pushMap(this,t);case"Set":return this._pushSet(this,t);case"URL":return this._pushUrl(this,t);case"BigNumber":return this._pushBigNumber(this,t);case"Date":return this._pushDate(this,t);case"RegExp":return this._pushRegexp(this,t);case"Symbol":switch(t){case h.NULL:return this._pushObject(null);case h.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+t.toString())}default:throw new Error("Unknown type: "+typeof t+", "+(t?t.toString():""))}}finalize(){if(0===this.offset)return null;for(var t=this.result,e=this.resultLength,r=this.resultMethod,i=this.offset,s=0,o=0;o<i;o++)s+=e[o];var a=n.allocUnsafe(s),c=0,u=0;for(o=0;o<i;o++){switch(u=e[o],r[o]){case 0:t[o].copy(a,c);break;case 1:a.writeUInt8(t[o],c,!0);break;case 2:a.writeUInt16BE(t[o],c,!0);break;case 3:a.writeUInt32BE(t[o],c,!0);break;case 4:a.writeDoubleBE(t[o],c,!0);break;case 5:a.write(t[o],c,u,"utf8");break;default:throw new Error("unkown method")}c+=u}var f=a;return this._reset(),f}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(t){const e=new B;if(!e.pushAny(t))throw new Error("Failed to encode input");return e.finalize()}}t.exports=B},516:(t,e,r)=>{"use strict";e.Diagnose=r(858),e.Decoder=r(416),e.Encoder=r(928),e.Simple=r(80),e.Tagged=r(994),e.decodeAll=e.Decoder.decodeAll,e.decodeFirst=e.Decoder.decodeFirst,e.diagnose=e.Diagnose.diagnose,e.encode=e.Encoder.encode,e.decode=e.Decoder.decode,e.leveldb={decode:e.Decoder.decodeAll,encode:e.Encoder.encode,buffer:!0,name:"cbor"}},80:(t,e,r)=>{"use strict";const n=r(729),i=n.MT,s=n.SIMPLE,o=n.SYMS;class a{constructor(t){if("number"!=typeof t)throw new Error("Invalid Simple type: "+typeof t);if(t<0||t>255||(0|t)!==t)throw new Error("value must be a small positive integer: "+t);this.value=t}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(t){return t._pushInt(this.value,i.SIMPLE_FLOAT)}static isSimple(t){return t instanceof a}static decode(t,e){switch(null==e&&(e=!0),t){case s.FALSE:return!1;case s.TRUE:return!0;case s.NULL:return e?null:o.NULL;case s.UNDEFINED:return e?void 0:o.UNDEFINED;case-1:if(!e)throw new Error("Invalid BREAK");return o.BREAK;default:return new a(t)}}}t.exports=a},994:t=>{"use strict";class e{constructor(t,e,r){if(this.tag=t,this.value=e,this.err=r,"number"!=typeof this.tag)throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(0|this.tag)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(t){return t._pushTag(this.tag),t.pushAny(this.value)}convert(t){var r,n;if("function"!=typeof(n=null!=t?t[this.tag]:void 0)&&"function"!=typeof(n=e["_tag"+this.tag]))return this;try{return n.call(e,this.value)}catch(t){return r=t,this.err=r,this}}}t.exports=e},205:(t,e,r)=>{"use strict";const{Buffer:n}=r(279),i=r(594).BigNumber,s=r(729),o=s.SHIFT32,a=s.SHIFT16;e.parseHalf=function(t){var e,r,n;return n=128&t[0]?-1:1,e=(124&t[0])>>2,r=(3&t[0])<<8|t[1],e?31===e?n*(r?NaN:Infinity):n*Math.pow(2,e-25)*(1024+r):5.960464477539063e-8*n*r},e.arrayBufferToBignumber=function(t){const e=t.byteLength;let r="";for(let i=0;i<e;i++)r+=(n=t[i])<16?"0"+n.toString(16):n.toString(16);var n;return new i(r,16)},e.buildMap=t=>{const e=new Map,r=Object.keys(t),n=r.length;for(let i=0;i<n;i++)e.set(r[i],t[r[i]]);return e},e.buildInt32=(t,e)=>t*a+e,e.buildInt64=(t,r,n,s)=>{const a=e.buildInt32(t,r),c=e.buildInt32(n,s);return a>2097151?new i(a).times(o).plus(c):a*o+c},e.writeHalf=function(t,e){const r=n.allocUnsafe(4);r.writeFloatBE(e,0);const i=r.readUInt32BE(0);if(8191&i)return!1;var s=i>>16&32768;const o=i>>23&255,a=8388607&i;if(o>=113&&o<=142)s+=(o-112<<10)+(a>>13);else{if(!(o>=103&&o<113))return!1;if(a&(1<<126-o)-1)return!1;s+=a+8388608>>126-o}return t.writeUInt16BE(s,0),!0},e.keySorter=function(t,e){var r=t[0].byteLength,n=e[0].byteLength;return r>n?1:n>r?-1:t[0].compare(e[0])},e.isNegativeZero=t=>0===t&&1/t<0,e.nextPowerOf2=t=>{let e=0;if(t&&!(t&t-1))return t;for(;0!==t;)t>>=1,e+=1;return 1<<e}},287:(t,e,r)=>{"use strict";const n=r(526),i=r(251),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.hp=c,e.IS=50;const o=2147483647;function a(t){if(t>o)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,c.prototype),e}function c(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return u(t,e,r)}function u(t,e,r){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!c.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const r=0|g(t,e);let n=a(r);const i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(Y(t,Uint8Array)){const e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return l(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Y(t,ArrayBuffer)||t&&Y(t.buffer,ArrayBuffer))return d(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(Y(t,SharedArrayBuffer)||t&&Y(t.buffer,SharedArrayBuffer)))return d(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return c.from(n,e,r);const i=function(t){if(c.isBuffer(t)){const e=0|p(t.length),r=a(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||Z(t.length)?a(0):l(t):"Buffer"===t.type&&Array.isArray(t.data)?l(t.data):void 0}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return c.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return f(t),a(t<0?0:0|p(t))}function l(t){const e=t.length<0?0:0|p(t.length),r=a(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function d(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,c.prototype),n}function p(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function g(t,e){if(c.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Y(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return K(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return W(t).length;default:if(i)return n?-1:K(t).length;e=(""+e).toLowerCase(),i=!0}}function y(t,e,r){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return N(this,e,r);case"utf8":case"utf-8":return A(this,e,r);case"ascii":return S(this,e,r);case"latin1":case"binary":return O(this,e,r);case"base64":return x(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function w(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function b(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=c.from(e,n)),c.isBuffer(e))return 0===e.length?-1:m(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):m(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,r,n,i){let s,o=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,a/=2,c/=2,r/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){let n=-1;for(s=r;s<a;s++)if(u(t,s)===u(e,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===c)return n*o}else-1!==n&&(s-=s-n),n=-1}else for(r+c>a&&(r=a-c),s=r;s>=0;s--){let r=!0;for(let n=0;n<c;n++)if(u(t,s+n)!==u(e,n)){r=!1;break}if(r)return s}return-1}function v(t,e,r,n){r=Number(r)||0;const i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;const s=e.length;let o;for(n>s/2&&(n=s/2),o=0;o<n;++o){const n=parseInt(e.substr(2*o,2),16);if(Z(n))return o;t[r+o]=n}return o}function E(t,e,r,n){return H(K(e,t.length-r),t,r,n)}function _(t,e,r,n){return H(function(t){const e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function I(t,e,r,n){return H(W(e),t,r,n)}function B(t,e,r,n){return H(function(t,e){let r,n,i;const s=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}(e,t.length-r),t,r,n)}function x(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function A(t,e,r){r=Math.min(t.length,r);const n=[];let i=e;for(;i<r;){const e=t[i];let s=null,o=e>239?4:e>223?3:e>191?2:1;if(i+o<=r){let r,n,a,c;switch(o){case 1:e<128&&(s=e);break;case 2:r=t[i+1],128==(192&r)&&(c=(31&e)<<6|63&r,c>127&&(s=c));break;case 3:r=t[i+1],n=t[i+2],128==(192&r)&&128==(192&n)&&(c=(15&e)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:r=t[i+1],n=t[i+2],a=t[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=o}return function(t){const e=t.length;if(e<=T)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=T));return r}(n)}c.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(t,e,r){return u(t,e,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(t,e,r){return function(t,e,r){return f(t),t<=0?a(t):void 0!==e?"string"==typeof r?a(t).fill(e,r):a(t).fill(e):a(t)}(t,e,r)},c.allocUnsafe=function(t){return h(t)},c.allocUnsafeSlow=function(t){return h(t)},c.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==c.prototype},c.compare=function(t,e){if(Y(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),Y(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;const n=c.allocUnsafe(e);let i=0;for(r=0;r<t.length;++r){let e=t[r];if(Y(e,Uint8Array))i+e.length>n.length?(c.isBuffer(e)||(e=c.from(e)),e.copy(n,i)):Uint8Array.prototype.set.call(n,e,i);else{if(!c.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,i)}i+=e.length}return n},c.byteLength=g,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)w(this,e,e+1);return this},c.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)w(this,e,e+3),w(this,e+1,e+2);return this},c.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)w(this,e,e+7),w(this,e+1,e+6),w(this,e+2,e+5),w(this,e+3,e+4);return this},c.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?A(this,0,t):y.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){let t="";const r=e.IS;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},s&&(c.prototype[s]=c.prototype.inspect),c.prototype.compare=function(t,e,r,n,i){if(Y(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;let s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(e>>>=0);const a=Math.min(s,o),u=this.slice(n,i),f=t.slice(e,r);for(let t=0;t<a;++t)if(u[t]!==f[t]){s=u[t],o=f[t];break}return s<o?-1:o<s?1:0},c.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},c.prototype.indexOf=function(t,e,r){return b(this,t,e,r,!0)},c.prototype.lastIndexOf=function(t,e,r){return b(this,t,e,r,!1)},c.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return v(this,t,e,r);case"utf8":case"utf-8":return E(this,t,e,r);case"ascii":case"latin1":case"binary":return _(this,t,e,r);case"base64":return I(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const T=4096;function S(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function O(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function N(t,e,r){const n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=e;n<r;++n)i+=J[t[n]];return i}function R(t,e,r){const n=t.slice(e,r);let i="";for(let t=0;t<n.length-1;t+=2)i+=String.fromCharCode(n[t]+256*n[t+1]);return i}function U(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function P(t,e,r,n,i,s){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function k(t,e,r,n,i){V(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,r}function j(t,e,r,n,i){V(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r+7]=s,s>>=8,t[r+6]=s,s>>=8,t[r+5]=s,s>>=8,t[r+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o>>=8,t[r+2]=o,o>>=8,t[r+1]=o,o>>=8,t[r]=o,r+8}function F(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function L(t,e,r,n,s){return e=+e,r>>>=0,s||F(t,0,r,4),i.write(t,e,r,n,23,4),r+4}function D(t,e,r,n,s){return e=+e,r>>>=0,s||F(t,0,r,8),i.write(t,e,r,n,52,8),r+8}c.prototype.slice=function(t,e){const r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);let n=this[t],i=1,s=0;for(;++s<e&&(i*=256);)n+=this[t+s]*i;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);let n=this[t+--e],i=1;for(;e>0&&(i*=256);)n+=this[t+--e]*i;return n},c.prototype.readUint8=c.prototype.readUInt8=function(t,e){return t>>>=0,e||U(t,1,this.length),this[t]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(t,e){return t>>>=0,e||U(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(t,e){return t>>>=0,e||U(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(t,e){return t>>>=0,e||U(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(t,e){return t>>>=0,e||U(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readBigUInt64LE=X((function(t){$(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,i=this[++t]+256*this[++t]+65536*this[++t]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),c.prototype.readBigUInt64BE=X((function(t){$(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],i=this[++t]*2**24+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),c.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);let n=this[t],i=1,s=0;for(;++s<e&&(i*=256);)n+=this[t+s]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},c.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);let n=e,i=1,s=this[t+--n];for(;n>0&&(i*=256);)s+=this[t+--n]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*e)),s},c.prototype.readInt8=function(t,e){return t>>>=0,e||U(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){t>>>=0,e||U(t,2,this.length);const r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(t,e){t>>>=0,e||U(t,2,this.length);const r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(t,e){return t>>>=0,e||U(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return t>>>=0,e||U(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readBigInt64LE=X((function(t){$(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),c.prototype.readBigInt64BE=X((function(t){$(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+r)})),c.prototype.readFloatLE=function(t,e){return t>>>=0,e||U(t,4,this.length),i.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return t>>>=0,e||U(t,4,this.length),i.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return t>>>=0,e||U(t,8,this.length),i.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return t>>>=0,e||U(t,8,this.length),i.read(this,t,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||P(this,t,e,r,Math.pow(2,8*r)-1,0);let i=1,s=0;for(this[e]=255&t;++s<r&&(i*=256);)this[e+s]=t/i&255;return e+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||P(this,t,e,r,Math.pow(2,8*r)-1,0);let i=r-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,1,255,0),this[e]=255&t,e+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeBigUInt64LE=X((function(t,e=0){return k(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=X((function(t,e=0){return j(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);P(this,t,e,r,n-1,-n)}let i=0,s=1,o=0;for(this[e]=255&t;++i<r&&(s*=256);)t<0&&0===o&&0!==this[e+i-1]&&(o=1),this[e+i]=(t/s|0)-o&255;return e+r},c.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);P(this,t,e,r,n-1,-n)}let i=r-1,s=1,o=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===o&&0!==this[e+i+1]&&(o=1),this[e+i]=(t/s|0)-o&255;return e+r},c.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},c.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeBigInt64LE=X((function(t,e=0){return k(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=X((function(t,e=0){return j(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(t,e,r){return L(this,t,e,!0,r)},c.prototype.writeFloatBE=function(t,e,r){return L(this,t,e,!1,r)},c.prototype.writeDoubleLE=function(t,e,r){return D(this,t,e,!0,r)},c.prototype.writeDoubleBE=function(t,e,r){return D(this,t,e,!1,r)},c.prototype.copy=function(t,e,r,n){if(!c.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);const i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},c.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;let i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{const s=c.isBuffer(t)?t:c.from(t,n),o=s.length;if(0===o)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=s[i%o]}return this};const C={};function M(t,e,r){C[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function q(t){let e="",r=t.length;const n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function V(t,e,r,n,i,s){if(t>r||t<e){const n="bigint"==typeof e?"n":"";let i;throw i=s>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`:`>= ${e}${n} and <= ${r}${n}`,new C.ERR_OUT_OF_RANGE("value",i,t)}!function(t,e,r){$(e,"offset"),void 0!==t[e]&&void 0!==t[e+r]||z(e,t.length-(r+1))}(n,i,s)}function $(t,e){if("number"!=typeof t)throw new C.ERR_INVALID_ARG_TYPE(e,"number",t)}function z(t,e,r){if(Math.floor(t)!==t)throw $(t,r),new C.ERR_OUT_OF_RANGE(r||"offset","an integer",t);if(e<0)throw new C.ERR_BUFFER_OUT_OF_BOUNDS;throw new C.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}M("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),M("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),M("ERR_OUT_OF_RANGE",(function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=q(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=q(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n}),RangeError);const G=/[^+/0-9A-Za-z-_]/g;function K(t,e){let r;e=e||1/0;const n=t.length;let i=null;const s=[];for(let o=0;o<n;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function W(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(G,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function H(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function Y(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Z(t){return t!=t}const J=function(){const t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function X(t){return"undefined"==typeof BigInt?Q:t}function Q(){throw new Error("BigInt not supported")}},251:(t,e)=>{e.read=function(t,e,r,n,i){var s,o,a=8*i-n-1,c=(1<<a)-1,u=c>>1,f=-7,h=r?i-1:0,l=r?-1:1,d=t[e+h];for(h+=l,s=d&(1<<-f)-1,d>>=-f,f+=a;f>0;s=256*s+t[e+h],h+=l,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=n;f>0;o=256*o+t[e+h],h+=l,f-=8);if(0===s)s=1-u;else{if(s===c)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),s-=u}return(d?-1:1)*o*Math.pow(2,s-n)},e.write=function(t,e,r,n,i,s){var o,a,c,u=8*s-i-1,f=(1<<u)-1,h=f>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),(e+=o+h>=1?l/c:l*Math.pow(2,1-h))*c>=2&&(o++,c/=2),o+h>=f?(a=0,o=f):o+h>=1?(a=(e*c-1)*Math.pow(2,i),o+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[r+d]=255&a,d+=p,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[r+d]=255&o,d+=p,o/=256,u-=8);t[r+d-p]|=128*g}},438:(t,e,r)=>{"use strict";const{URLWithLegacySupport:n,format:i,URLSearchParams:s,defaultBase:o}=r(911),a=r(331);t.exports={URL:n,URLSearchParams:s,format:i,relative:a,defaultBase:o}},331:(t,e,r)=>{"use strict";const{URLWithLegacySupport:n,format:i}=r(911);t.exports=(t,e={},r={},s)=>{let o,a=e.protocol?e.protocol.replace(":",""):"http";a=(r[a]||s||a)+":";try{o=new n(t)}catch(t){o={}}const c=Object.assign({},e,{protocol:a||o.protocol,host:e.host||o.host});return new n(t,i(c)).toString()}},911:t=>{"use strict";const e=self.location?self.location.protocol+"//"+self.location.host:"",r=self.URL;t.exports={URLWithLegacySupport:class{constructor(t="",n=e){this.super=new r(t,n),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(t){this.super.hash=t}set host(t){this.super.host=t}set hostname(t){this.super.hostname=t}set href(t){this.super.href=t}set origin(t){this.super.origin=t}set password(t){this.super.password=t}set pathname(t){this.super.pathname=t}set port(t){this.super.port=t}set protocol(t){this.super.protocol=t}set search(t){this.super.search=t}set searchParams(t){this.super.searchParams=t}set username(t){this.super.username=t}createObjectURL(t){return this.super.createObjectURL(t)}revokeObjectURL(t){this.super.revokeObjectURL(t)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:e,format:function(t){if("string"==typeof t)return new r(t).toString();if(!(t instanceof r)){const e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",n=t.port?":"+t.port:"",i=t.protocol?t.protocol+"//":"",s=t.host||"",o=t.hostname||"",a=t.search||(t.query?"?"+t.query:""),c=t.hash||"",u=t.pathname||"";return`${i}${e||r}${s||o+n}${t.path||u+a}${c}`}}}},283:function(t,e,r){"use strict";var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}(r(771));const i=n(r(770));e.value=i},771:function(t,e,r){"use strict";var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});const i=n(r(770)),s=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class o{constructor(t,e=!1){this._serializer=t,this._stable=e,this.name="jsonDefault",this.priority=-100}match(t){return-1!=["undefined","boolean","number","string","object"].indexOf(typeof t)}encode(t){switch(typeof t){case"undefined":return i.undefined_();case"boolean":return i.bool(t);case"number":return Math.floor(t)===t?i.number(t):i.doubleFloat(t);case"string":return i.string(t);case"object":if(null===t)return i.null_();if(Array.isArray(t))return i.array(t.map((t=>this._serializer.serializeValue(t))));if(s.find((e=>t instanceof e)))return i.bytes(t.buffer);if(-1!==Object.getOwnPropertyNames(t).indexOf("toJSON"))return this.encode(t.toJSON());if(t instanceof Map){const e=new Map;for(const[r,n]of t.entries())e.set(r,this._serializer.serializeValue(n));return i.map(e,this._stable)}{const e=new Map;for(const[r,n]of Object.entries(t))e.set(r,this._serializer.serializeValue(n));return i.map(e,this._stable)}default:throw new Error("Invalid value.")}}}e.JsonDefaultCborEncoder=o;class a{constructor(){this.name="cborEncoder",this.priority=-90}match(t){return"object"==typeof t&&"function"==typeof t.toCBOR}encode(t){return t.toCBOR()}}e.ToCborEncoder=a;class c{constructor(){this._encoders=new Set}static withDefaultEncoders(t=!1){const e=new this;return e.addEncoder(new o(e,t)),e.addEncoder(new a),e}removeEncoder(t){for(const e of this._encoders.values())e.name==t&&this._encoders.delete(e)}addEncoder(t){this._encoders.add(t)}getEncoderFor(t){let e=null;for(const r of this._encoders)(!e||r.priority>e.priority)&&r.match(t)&&(e=r);if(null===e)throw new Error("Could not find an encoder for value.");return e}serializeValue(t){return this.getEncoderFor(t).encode(t)}serialize(t){return this.serializeValue(t)}}e.CborSerializer=c,e.SelfDescribeCborSerializer=class extends c{serialize(t){return i.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(t))]))}}},770:(t,e)=>{"use strict";function r(t,...e){const r=new Uint8Array(t.byteLength+e.reduce(((t,e)=>t+e.byteLength),0));r.set(new Uint8Array(t),0);let n=t.byteLength;for(const t of e)r.set(new Uint8Array(t),n),n+=t.byteLength;return r.buffer}function n(t,e,r){const n=2**(e-24);r=(r=r.replace(/[^0-9a-fA-F]/g,"")).slice(2*-n).padStart(2*n,"0");const i=[(t<<5)+e].concat(r.match(/../g).map((t=>parseInt(t,16))));return new Uint8Array(i).buffer}function i(t,e){return e<24?new Uint8Array([(t<<5)+e]).buffer:n(t,e<=255?24:e<=65535?25:e<=4294967295?26:27,e.toString(16))}function s(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n<128?e.push(n):n<2048?e.push(192|n>>6,128|63&n):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|63&n):(r++,n=(1023&n)<<10|1023&t.charCodeAt(r),e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return r(new Uint8Array(i(3,t.length)),new Uint8Array(e))}function o(t){return new Uint8Array(t).buffer}function a(t){if(isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),23),new Uint8Array([0+t]).buffer}function c(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return n(0,24,t=(t=Math.min(Math.max(0,t),255)).toString(16))}function u(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return n(0,25,t=(t=Math.min(Math.max(0,t),65535)).toString(16))}function f(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return n(0,26,t=(t=Math.min(Math.max(0,t),4294967295)).toString(16))}function h(t,e){if("string"==typeof t&&16==e){if(t.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return n(0,27,t)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return n(0,27,t=(t=Math.min(Math.max(0,t),9007199254740992)).toString(16))}function l(t){if(isNaN(t))throw new RangeError("Invalid number.");return 0===t?a(0):(t=Math.min(Math.max(0,-t),24)-1,new Uint8Array([32+t]).buffer)}function d(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return n(1,24,t=(t=Math.min(Math.max(0,-t-1),255)).toString(16))}function p(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return n(1,25,t=(t=Math.min(Math.max(0,-t-1),65535)).toString(16))}function g(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return n(1,26,t=(t=Math.min(Math.max(0,-t-1),4294967295)).toString(16))}function y(t,e){if("string"==typeof t&&16==e){if((t=t.startsWith("-")?t.slice(1):"0").match(/[^0-9a-fA-F]/)||t.length>16)throw new RangeError("Invalid number.");let e=!1,r=t.split("").reduceRight(((t,r)=>{if(e)return r+t;let n=parseInt(r,16)-1;return n>=0?(e=!0,n.toString(16)+t):"f"+t}),"");return e?n(1,27,r):h(0)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return n(1,27,t=(t=Math.min(Math.max(0,-t-1),9007199254740992)).toString(16))}function w(){return o(new Uint8Array([245]))}function b(){return o(new Uint8Array([244]))}Object.defineProperty(e,"__esModule",{value:!0}),e.tagged=function(t,e){if(14277111==t)return r(new Uint8Array([217,217,247]),e);if(t<24)return r(new Uint8Array([192+t]),e);{const e=t<=255?24:t<=65535?25:t<=4294967295?26:27,r=2**(e-24),n=t.toString(16).slice(2*-r).padStart(2*r,"0"),i=[192+e].concat(n.match(/../g).map((t=>parseInt(t,16))));return new Uint8Array(i).buffer}},e.raw=o,e.uSmall=a,e.u8=c,e.u16=u,e.u32=f,e.u64=h,e.iSmall=l,e.i8=d,e.i16=p,e.i32=g,e.i64=y,e.number=function(t){return t>=0?t<24?a(t):t<=255?c(t):t<=65535?u(t):t<=4294967295?f(t):h(t):t>=-24?l(t):t>=-255?d(t):t>=-65535?p(t):t>=-4294967295?g(t):y(t)},e.bytes=function(t){return r(i(2,t.byteLength),t)},e.string=function(t){return s(t)},e.array=function(t){return r(i(4,t.length),...t)},e.map=function(t,e=!1){t instanceof Map||(t=new Map(Object.entries(t)));let n=Array.from(t.entries());return e&&(n=n.sort((([t],[e])=>t.localeCompare(e)))),r(i(5,t.size),...n.map((([t,e])=>r(s(t),e))))},e.singleFloat=function(t){const e=new Float32Array([t]);return r(new Uint8Array([250]),new Uint8Array(e.buffer))},e.doubleFloat=function(t){const e=new Float64Array([t]);return r(new Uint8Array([251]),new Uint8Array(e.buffer))},e.bool=function(t){return t?w():b()},e.true_=w,e.false_=b,e.null_=function(){return o(new Uint8Array([246]))},e.undefined_=function(){return o(new Uint8Array([247]))}},615:(t,e,r)=>{"use strict";r.d(e,{Xf:()=>p,hT:()=>d,hp:()=>g});var n=r(30),i=r(293);const s=BigInt(0),o=BigInt(1);function a(t,e){const r=e.negate();return t?r:e}function c(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function u(t,e){return c(t,e),{windows:Math.ceil(e/t)+1,windowSize:2**(t-1)}}const f=new WeakMap,h=new WeakMap;function l(t){return h.get(t)||1}function d(t,e){return{constTimeNegate:a,hasPrecomputes:t=>1!==l(t),unsafeLadder(e,r,n=t.ZERO){let i=e;for(;r>s;)r&o&&(n=n.add(i)),i=i.double(),r>>=o;return n},precomputeWindow(t,r){const{windows:n,windowSize:i}=u(r,e),s=[];let o=t,a=o;for(let t=0;t<n;t++){a=o,s.push(a);for(let t=1;t<i;t++)a=a.add(o),s.push(a);o=a.double()}return s},wNAF(r,n,i){const{windows:s,windowSize:c}=u(r,e);let f=t.ZERO,h=t.BASE;const l=BigInt(2**r-1),d=2**r,p=BigInt(r);for(let t=0;t<s;t++){const e=t*c;let r=Number(i&l);i>>=p,r>c&&(r-=d,i+=o);const s=e,u=e+Math.abs(r)-1,g=t%2!=0,y=r<0;0===r?h=h.add(a(g,n[s])):f=f.add(a(y,n[u]))}return{p:f,f:h}},wNAFUnsafe(r,n,i,a=t.ZERO){const{windows:c,windowSize:f}=u(r,e),h=BigInt(2**r-1),l=2**r,d=BigInt(r);for(let t=0;t<c;t++){const e=t*f;if(i===s)break;let r=Number(i&h);if(i>>=d,r>f&&(r-=l,i+=o),0===r)continue;let c=n[e+Math.abs(r)-1];r<0&&(c=c.negate()),a=a.add(c)}return a},getPrecomputes(t,e,r){let n=f.get(e);return n||(n=this.precomputeWindow(e,t),1!==t&&f.set(e,r(n))),n},wNAFCached(t,e,r){const n=l(t);return this.wNAF(n,this.getPrecomputes(n,t,r),e)},wNAFCachedUnsafe(t,e,r,n){const i=l(t);return 1===i?this.unsafeLadder(t,e,n):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),e,n)},setWindowSize(t,r){c(r,e),h.set(t,r),f.delete(t)}}}function p(t,e,r,n){if(function(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach(((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)}))}(r,t),function(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach(((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)}))}(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,o=(0,i.dJ)(BigInt(r.length)),a=o>12?o-3:o>4?o-2:o?2:1,c=(1<<a)-1,u=new Array(c+1).fill(s);let f=s;for(let t=Math.floor((e.BITS-1)/a)*a;t>=0;t-=a){u.fill(s);for(let e=0;e<n.length;e++){const i=n[e],s=Number(i>>BigInt(t)&BigInt(c));u[s]=u[s].add(r[e])}let e=s;for(let t=u.length-1,r=s;t>0;t--)r=r.add(u[t]),e=e.add(r);if(f=f.add(e),0!==t)for(let t=0;t<a;t++)f=f.double()}return f}function g(t){return(0,n.jr)(t.Fp),(0,i.Q5)(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,n.LH)(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}},30:(t,e,r)=>{"use strict";r.d(e,{D0:()=>_,LH:()=>E,Tp:()=>B,dQ:()=>g,f4:()=>b,jr:()=>w,pS:()=>m,qy:()=>x,tB:()=>v,zH:()=>d,zi:()=>h});var n=r(293);const i=BigInt(0),s=BigInt(1),o=BigInt(2),a=BigInt(3),c=BigInt(4),u=BigInt(5),f=BigInt(8);function h(t,e){const r=t%e;return r>=i?r:e+r}function l(t,e,r){if(e<i)throw new Error("invalid exponent, negatives unsupported");if(r<=i)throw new Error("invalid modulus");if(r===s)return i;let n=s;for(;e>i;)e&s&&(n=n*t%r),t=t*t%r,e>>=s;return n}function d(t,e,r){let n=t;for(;e-- >i;)n*=n,n%=r;return n}function p(t,e){if(t===i)throw new Error("invert: expected non-zero number");if(e<=i)throw new Error("invert: expected positive modulus, got "+e);let r=h(t,e),n=e,o=i,a=s,c=s,u=i;for(;r!==i;){const t=n/r,e=n%r,i=o-c*t,s=a-u*t;n=r,r=e,o=c,a=u,c=i,u=s}if(n!==s)throw new Error("invert: does not exist");return h(o,e)}const g=(t,e)=>(h(t,e)&s)===s,y=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function w(t){const e=y.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return(0,n.Q5)(t,e)}function b(t,e,r){if(r<i)throw new Error("invalid exponent, negatives unsupported");if(r===i)return t.ONE;if(r===s)return e;let n=t.ONE,o=e;for(;r>i;)r&s&&(n=t.mul(n,o)),o=t.sqr(o),r>>=s;return n}function m(t,e){const r=new Array(e.length),n=e.reduce(((e,n,i)=>t.is0(n)?e:(r[i]=e,t.mul(e,n))),t.ONE),i=t.inv(n);return e.reduceRight(((e,n,i)=>t.is0(n)?e:(r[i]=t.mul(e,r[i]),t.mul(e,n))),i),r}function v(t){const e=(t-s)/o;return(t,r)=>t.pow(r,e)}function E(t,e){const r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function _(t,e,r=!1,d={}){if(t<=i)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:g,nByteLength:y}=E(t,e);if(y>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let w;const v=Object.freeze({ORDER:t,BITS:g,BYTES:y,MASK:(0,n.OG)(g),ZERO:i,ONE:s,create:e=>h(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("invalid field element: expected bigint, got "+typeof e);return i<=e&&e<t},is0:t=>t===i,isOdd:t=>(t&s)===s,neg:e=>h(-e,t),eql:(t,e)=>t===e,sqr:e=>h(e*e,t),add:(e,r)=>h(e+r,t),sub:(e,r)=>h(e-r,t),mul:(e,r)=>h(e*r,t),pow:(t,e)=>b(v,t,e),div:(e,r)=>h(e*p(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>p(e,t),sqrt:d.sqrt||(e=>(w||(w=function(t){if(t%c===a){const e=(t+s)/c;return function(t,r){const n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw new Error("Cannot find square root");return n}}if(t%f===u){const e=(t-u)/f;return function(t,r){const n=t.mul(r,o),i=t.pow(n,e),s=t.mul(r,i),a=t.mul(t.mul(s,o),i),c=t.mul(s,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),r))throw new Error("Cannot find square root");return c}}return function(t){const e=(t-s)/o;let r,n,a;for(r=t-s,n=0;r%o===i;r/=o,n++);for(a=o;a<t&&l(a,e,t)!==t-s;a++)if(a>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===n){const e=(t+s)/c;return function(t,r){const n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw new Error("Cannot find square root");return n}}const u=(r+s)/o;return function(t,i){if(t.pow(i,e)===t.neg(t.ONE))throw new Error("Cannot find square root");let o=n,c=t.pow(t.mul(t.ONE,a),r),f=t.pow(i,u),h=t.pow(i,r);for(;!t.eql(h,t.ONE);){if(t.eql(h,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(h);e<o&&!t.eql(r,t.ONE);e++)r=t.sqr(r);const r=t.pow(c,s<<BigInt(o-e-1));c=t.sqr(r),f=t.mul(f,r),h=t.mul(h,c),o=e}return f}}(t)}(t)),w(v,e))),invertBatch:t=>m(v,t),cmov:(t,e,r)=>r?e:t,toBytes:t=>r?(0,n.z)(t,y):(0,n.lq)(t,y),fromBytes:t=>{if(t.length!==y)throw new Error("Field.fromBytes: expected "+y+" bytes, got "+t.length);return r?(0,n.lX)(t):(0,n.Ph)(t)}});return Object.freeze(v)}function I(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function B(t){const e=I(t);return e+Math.ceil(e/2)}function x(t,e,r=!1){const i=t.length,o=I(e),a=B(e);if(i<16||i<a||i>1024)throw new Error("expected "+a+"-1024 bytes of input, got "+i);const c=h(r?(0,n.Ph)(t):(0,n.lX)(t),e-s)+s;return r?(0,n.z)(c,o):(0,n.lq)(c,o)}},293:(t,e,r)=>{"use strict";r.d(e,{AI:()=>_,DO:()=>a,GU:()=>T,Id:()=>E,My:()=>f,OG:()=>S,Ph:()=>y,Q5:()=>N,SJ:()=>R,aK:()=>x,aT:()=>g,aY:()=>o,dJ:()=>A,e8:()=>c,lX:()=>w,lq:()=>b,qj:()=>v,r4:()=>B,x:()=>U,z:()=>m,zW:()=>h});const n=BigInt(0),i=BigInt(1),s=BigInt(2);function o(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function a(t){if(!o(t))throw new Error("Uint8Array expected")}function c(t,e){if("boolean"!=typeof e)throw new Error(t+" boolean expected, got "+e)}const u=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function f(t){a(t);let e="";for(let r=0;r<t.length;r++)e+=u[t[r]];return e}function h(t){const e=t.toString(16);return 1&e.length?"0"+e:e}function l(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return""===t?n:BigInt("0x"+t)}const d={_0:48,_9:57,A:65,F:70,a:97,f:102};function p(t){return t>=d._0&&t<=d._9?t-d._0:t>=d.A&&t<=d.F?t-(d.A-10):t>=d.a&&t<=d.f?t-(d.a-10):void 0}function g(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){const r=p(t.charCodeAt(i)),s=p(t.charCodeAt(i+1));if(void 0===r||void 0===s){const e=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+e+'" at index '+i)}n[e]=16*r+s}return n}function y(t){return l(f(t))}function w(t){return a(t),l(f(Uint8Array.from(t).reverse()))}function b(t,e){return g(t.toString(16).padStart(2*e,"0"))}function m(t,e){return b(t,e).reverse()}function v(t,e,r){let n;if("string"==typeof e)try{n=g(e)}catch(e){throw new Error(t+" must be hex string or Uint8Array, cause: "+e)}else{if(!o(e))throw new Error(t+" must be hex string or Uint8Array");n=Uint8Array.from(e)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function E(...t){let e=0;for(let r=0;r<t.length;r++){const n=t[r];a(n),e+=n.length}const r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}function _(t){if("string"!=typeof t)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}const I=t=>"bigint"==typeof t&&n<=t;function B(t,e,r){return I(t)&&I(e)&&I(r)&&e<=t&&t<r}function x(t,e,r,n){if(!B(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function A(t){let e;for(e=0;t>n;t>>=i,e+=1);return e}function T(t,e){return t>>BigInt(e)&i}const S=t=>(s<<BigInt(t-1))-i,O={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||o(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function N(t,e,r={}){const n=(e,r,n)=>{const i=O[r];if("function"!=typeof i)throw new Error("invalid validator function");const s=t[e];if(!(n&&void 0===s||i(s,t)))throw new Error("param "+String(e)+" is invalid. Expected "+r+", got "+s)};for(const[t,r]of Object.entries(e))n(t,r,!1);for(const[t,e]of Object.entries(r))n(t,e,!0);return t}const R=()=>{throw new Error("not implemented")};function U(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(void 0!==i)return i;const s=t(r,...n);return e.set(r,s),s}}},31:(t,e,r)=>{"use strict";r.d(e,{ev:()=>K});var n=r(690);const i=BigInt(2**32-1),s=BigInt(32);function o(t,e=!1){return e?{h:Number(t&i),l:Number(t>>s&i)}:{h:0|Number(t>>s&i),l:0|Number(t&i)}}const a=function(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:a}=o(t[i],e);[r[i],n[i]]=[s,a]}return[r,n]},c=(t,e,r)=>t>>>r,u=(t,e,r)=>t<<32-r|e>>>r,f=(t,e,r)=>t>>>r|e<<32-r,h=(t,e,r)=>t<<32-r|e>>>r,l=(t,e,r)=>t<<64-r|e>>>r-32,d=(t,e,r)=>t>>>r-32|e<<64-r,p=function(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:0|i}},g=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),y=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,w=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),b=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,m=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0,v=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0);var E=r(606);const[_,I]=(()=>a(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t)))))(),B=new Uint32Array(80),x=new Uint32Array(80);class A extends n.ol{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:r,Bl:n,Ch:i,Cl:s,Dh:o,Dl:a,Eh:c,El:u,Fh:f,Fl:h,Gh:l,Gl:d,Hh:p,Hl:g}=this;return[t,e,r,n,i,s,o,a,c,u,f,h,l,d,p,g]}set(t,e,r,n,i,s,o,a,c,u,f,h,l,d,p,g){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|f,this.Fl=0|h,this.Gh=0|l,this.Gl=0|d,this.Hh=0|p,this.Hl=0|g}process(t,e){for(let r=0;r<16;r++,e+=4)B[r]=t.getUint32(e),x[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|B[t-15],r=0|x[t-15],n=f(e,r,1)^f(e,r,8)^c(e,r,7),i=h(e,r,1)^h(e,r,8)^u(e,r,7),s=0|B[t-2],o=0|x[t-2],a=f(s,o,19)^l(s,o,61)^c(s,o,6),p=h(s,o,19)^d(s,o,61)^u(s,o,6),g=w(i,p,x[t-7],x[t-16]),y=b(g,n,a,B[t-7],B[t-16]);B[t]=0|y,x[t]=0|g}let{Ah:r,Al:n,Bh:i,Bl:s,Ch:o,Cl:a,Dh:E,Dl:A,Eh:T,El:S,Fh:O,Fl:N,Gh:R,Gl:U,Hh:P,Hl:k}=this;for(let t=0;t<80;t++){const e=f(T,S,14)^f(T,S,18)^l(T,S,41),c=h(T,S,14)^h(T,S,18)^d(T,S,41),u=T&O^~T&R,w=v(k,c,S&N^~S&U,I[t],x[t]),b=m(w,P,e,u,_[t],B[t]),j=0|w,F=f(r,n,28)^l(r,n,34)^l(r,n,39),L=h(r,n,28)^d(r,n,34)^d(r,n,39),D=r&i^r&o^i&o,C=n&s^n&a^s&a;P=0|R,k=0|U,R=0|O,U=0|N,O=0|T,N=0|S,({h:T,l:S}=p(0|E,0|A,0|b,0|j)),E=0|o,A=0|a,o=0|i,a=0|s,i=0|r,s=0|n;const M=g(j,L,C);r=y(M,b,F,D),n=0|M}({h:r,l:n}=p(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:s}=p(0|this.Bh,0|this.Bl,0|i,0|s)),({h:o,l:a}=p(0|this.Ch,0|this.Cl,0|o,0|a)),({h:E,l:A}=p(0|this.Dh,0|this.Dl,0|E,0|A)),({h:T,l:S}=p(0|this.Eh,0|this.El,0|T,0|S)),({h:O,l:N}=p(0|this.Fh,0|this.Fl,0|O,0|N)),({h:R,l:U}=p(0|this.Gh,0|this.Gl,0|R,0|U)),({h:P,l:k}=p(0|this.Hh,0|this.Hl,0|P,0|k)),this.set(r,n,i,s,o,a,E,A,T,S,O,N,R,U,P,k)}roundClean(){B.fill(0),x.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const T=(0,E.ld)((()=>new A));var S=r(615),O=r(30),N=r(293);const R=BigInt(0),U=BigInt(1),P=BigInt(2),k=BigInt(8),j={zip215:!0};const F=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),L=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),D=(BigInt(0),BigInt(1)),C=BigInt(2),M=(BigInt(3),BigInt(5)),q=BigInt(8);function V(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function $(t,e){const r=F,n=(0,O.zi)(e*e*e,r),i=function(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=F,o=t*t%s*t%s,a=(0,O.zH)(o,C,s)*o%s,c=(0,O.zH)(a,D,s)*t%s,u=(0,O.zH)(c,M,s)*c%s,f=(0,O.zH)(u,e,s)*u%s,h=(0,O.zH)(f,r,s)*f%s,l=(0,O.zH)(h,n,s)*h%s,d=(0,O.zH)(l,i,s)*l%s,p=(0,O.zH)(d,i,s)*l%s,g=(0,O.zH)(p,e,s)*u%s;return{pow_p_5_8:(0,O.zH)(g,C,s)*t%s,b2:o}}(t*(0,O.zi)(n*n*e,r)).pow_p_5_8;let s=(0,O.zi)(t*n*i,r);const o=(0,O.zi)(e*s*s,r),a=s,c=(0,O.zi)(s*L,r),u=o===t,f=o===(0,O.zi)(-t,r),h=o===(0,O.zi)(-t*L,r);return u&&(s=a),(f||h)&&(s=c),(0,O.dQ)(s,r)&&(s=(0,O.zi)(-s,r)),{isValid:u||f,value:s}}const z=(()=>(0,O.D0)(F,void 0,!0))(),G=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:z,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:q,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:T,randomBytes:E.po,adjustScalarBytes:V,uvRatio:$}))(),K=(()=>function(t){const e=function(t){const e=(0,S.hp)(t);return N.Q5(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:r,n,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:c}=e,u=P<<BigInt(8*a)-U,f=r.create,h=(0,O.D0)(e.n,e.nBitLength),l=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:r.sqrt(t*r.inv(e))}}catch(t){return{isValid:!1,value:R}}}),d=e.adjustScalarBytes||(t=>t),p=e.domain||((t,e,r)=>{if((0,N.e8)("phflag",r),e.length||r)throw new Error("Contexts/pre-hash are not supported");return t});function g(t,e){N.aK("coordinate "+t,e,R,u)}function y(t){if(!(t instanceof m))throw new Error("ExtendedPoint expected")}const w=(0,N.x)(((t,e)=>{const{ex:n,ey:i,ez:s}=t,o=t.is0();null==e&&(e=o?k:r.inv(s));const a=f(n*e),c=f(i*e),u=f(s*e);if(o)return{x:R,y:U};if(u!==U)throw new Error("invZ was invalid");return{x:a,y:c}})),b=(0,N.x)((t=>{const{a:r,d:n}=e;if(t.is0())throw new Error("bad point: ZERO");const{ex:i,ey:s,ez:o,et:a}=t,c=f(i*i),u=f(s*s),h=f(o*o),l=f(h*h),d=f(c*r);if(f(h*f(d+u))!==f(l+f(n*f(c*u))))throw new Error("bad point: equation left != right (1)");if(f(i*s)!==f(o*a))throw new Error("bad point: equation left != right (2)");return!0}));class m{constructor(t,e,r,n){this.ex=t,this.ey=e,this.ez=r,this.et=n,g("x",t),g("y",e),g("z",r),g("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof m)throw new Error("extended point not allowed");const{x:e,y:r}=t||{};return g("x",e),g("y",r),new m(e,r,U,f(e*r))}static normalizeZ(t){const e=r.invertBatch(t.map((t=>t.ez)));return t.map(((t,r)=>t.toAffine(e[r]))).map(m.fromAffine)}static msm(t,e){return(0,S.Xf)(m,h,t,e)}_setWindowSize(t){_.setWindowSize(this,t)}assertValidity(){b(this)}equals(t){y(t);const{ex:e,ey:r,ez:n}=this,{ex:i,ey:s,ez:o}=t,a=f(e*o),c=f(i*n),u=f(r*o),h=f(s*n);return a===c&&u===h}is0(){return this.equals(m.ZERO)}negate(){return new m(f(-this.ex),this.ey,this.ez,f(-this.et))}double(){const{a:t}=e,{ex:r,ey:n,ez:i}=this,s=f(r*r),o=f(n*n),a=f(P*f(i*i)),c=f(t*s),u=r+n,h=f(f(u*u)-s-o),l=c+o,d=l-a,p=c-o,g=f(h*d),y=f(l*p),w=f(h*p),b=f(d*l);return new m(g,y,b,w)}add(t){y(t);const{a:r,d:n}=e,{ex:i,ey:s,ez:o,et:a}=this,{ex:c,ey:u,ez:h,et:l}=t;if(r===BigInt(-1)){const t=f((s-i)*(u+c)),e=f((s+i)*(u-c)),r=f(e-t);if(r===R)return this.double();const n=f(o*P*l),d=f(a*P*h),p=d+n,g=e+t,y=d-n,w=f(p*r),b=f(g*y),v=f(p*y),E=f(r*g);return new m(w,b,E,v)}const d=f(i*c),p=f(s*u),g=f(a*n*l),w=f(o*h),b=f((i+s)*(c+u)-d-p),v=w-g,E=w+g,_=f(p-r*d),I=f(b*v),B=f(E*_),x=f(b*_),A=f(v*E);return new m(I,B,A,x)}subtract(t){return this.add(t.negate())}wNAF(t){return _.wNAFCached(this,t,m.normalizeZ)}multiply(t){const e=t;N.aK("scalar",e,U,n);const{p:r,f:i}=this.wNAF(e);return m.normalizeZ([r,i])[0]}multiplyUnsafe(t,e=m.ZERO){const r=t;return N.aK("scalar",r,R,n),r===R?E:this.is0()||r===U?this:_.wNAFCachedUnsafe(this,r,m.normalizeZ,e)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return _.unsafeLadder(this,n).is0()}toAffine(t){return w(this,t)}clearCofactor(){const{h:t}=e;return t===U?this:this.multiplyUnsafe(t)}static fromHex(t,n=!1){const{d:i,a:s}=e,o=r.BYTES;t=(0,N.qj)("pointHex",t,o),(0,N.e8)("zip215",n);const a=t.slice(),c=t[o-1];a[o-1]=-129&c;const h=N.lX(a),d=n?u:r.ORDER;N.aK("pointHex.y",h,R,d);const p=f(h*h),g=f(p-U),y=f(i*p-s);let{isValid:w,value:b}=l(g,y);if(!w)throw new Error("Point.fromHex: invalid y coordinate");const v=(b&U)===U,E=!!(128&c);if(!n&&b===R&&E)throw new Error("Point.fromHex: x=0 and x_0=1");return E!==v&&(b=f(-b)),m.fromAffine({x:b,y:h})}static fromPrivateKey(t){return x(t).point}toRawBytes(){const{x:t,y:e}=this.toAffine(),n=N.z(e,r.BYTES);return n[n.length-1]|=t&U?128:0,n}toHex(){return N.My(this.toRawBytes())}}m.BASE=new m(e.Gx,e.Gy,U,f(e.Gx*e.Gy)),m.ZERO=new m(R,U,U,R);const{BASE:v,ZERO:E}=m,_=(0,S.hT)(m,8*a);function I(t){return(0,O.zi)(t,n)}function B(t){return I(N.lX(t))}function x(t){const e=r.BYTES;t=(0,N.qj)("private key",t,e);const n=(0,N.qj)("hashed private key",s(t),2*e),i=d(n.slice(0,e)),o=n.slice(e,2*e),a=B(i),c=v.multiply(a),u=c.toRawBytes();return{head:i,prefix:o,scalar:a,point:c,pointBytes:u}}function A(t=new Uint8Array,...e){const r=N.Id(...e);return B(s(p(r,(0,N.qj)("context",t),!!i)))}const T=j;return v._setWindowSize(8),{CURVE:e,getPublicKey:function(t){return x(t).pointBytes},sign:function(t,e,s={}){t=(0,N.qj)("message",t),i&&(t=i(t));const{prefix:o,scalar:a,pointBytes:c}=x(e),u=A(s.context,o,t),f=v.multiply(u).toRawBytes(),h=I(u+A(s.context,f,c,t)*a);N.aK("signature.s",h,R,n);const l=N.Id(f,N.z(h,r.BYTES));return(0,N.qj)("result",l,2*r.BYTES)},verify:function(t,e,n,s=T){const{context:o,zip215:a}=s,c=r.BYTES;t=(0,N.qj)("signature",t,2*c),e=(0,N.qj)("message",e),n=(0,N.qj)("publicKey",n,c),void 0!==a&&(0,N.e8)("zip215",a),i&&(e=i(e));const u=N.lX(t.slice(c,2*c));let f,h,l;try{f=m.fromHex(n,a),h=m.fromHex(t.slice(0,c),a),l=v.multiplyUnsafe(u)}catch(t){return!1}if(!a&&f.isSmallOrder())return!1;const d=A(o,h.toRawBytes(),f.toRawBytes(),e);return h.add(f.multiplyUnsafe(d)).subtract(l).clearCofactor().equals(m.ZERO)},ExtendedPoint:m,utils:{getExtendedPublicKey:x,randomPrivateKey:()=>o(r.BYTES),precompute:(t=8,e=m.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}(G))()},493:(t,e,r)=>{"use strict";function n(t,...e){if(!((r=t)instanceof Uint8Array||ArrayBuffer.isView(r)&&"Uint8Array"===r.constructor.name))throw new Error("Uint8Array expected");var r;if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function i(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function s(t,e){n(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}r.d(e,{CC:()=>i,DO:()=>n,Ht:()=>s})},690:(t,e,r)=>{"use strict";r.d(e,{TQ:()=>o,ol:()=>a,r9:()=>s});var n=r(493),i=r(606);const s=(t,e,r)=>t&e^~t&r,o=(t,e,r)=>t&e^t&r^e&r;class a extends i.Vw{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,i.O8)(this.buffer)}update(t){(0,n.CC)(this);const{view:e,buffer:r,blockLen:s}=this,o=(t=(0,i.ZJ)(t)).length;for(let n=0;n<o;){const a=Math.min(s-this.pos,o-n);if(a!==s)r.set(t.subarray(n,n+a),this.pos),this.pos+=a,n+=a,this.pos===s&&(this.process(e,0),this.pos=0);else{const e=(0,i.O8)(t);for(;s<=o-n;n+=s)this.process(e,n)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,n.CC)(this),(0,n.Ht)(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:s,isLE:o}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>s-a&&(this.process(r,0),a=0);for(let t=a;t<s;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,a,n)}(r,s-8,BigInt(8*this.length),o),this.process(r,0);const c=(0,i.O8)(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=u/4,h=this.get();if(f>h.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<f;t++)c.setUint32(4*t,h[t],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return t.length=n,t.pos=o,t.finished=i,t.destroyed=s,n%e&&t.buffer.set(r),t}}},606:(t,e,r)=>{"use strict";r.d(e,{Vw:()=>c,O8:()=>s,po:()=>f,Ow:()=>o,ZJ:()=>a,ld:()=>u});const n="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;var i=r(493);const s=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),o=(t,e)=>t<<32-e|t>>>e;function a(t){return"string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),(0,i.DO)(t),t}class c{clone(){return this._cloneInto()}}function u(t){const e=e=>t().update(a(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function f(t=32){if(n&&"function"==typeof n.getRandomValues)return n.getRandomValues(new Uint8Array(t));if(n&&"function"==typeof n.randomBytes)return n.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}},190:(t,e,r)=>{"use strict";function n(t,...e){if(!((r=t)instanceof Uint8Array||ArrayBuffer.isView(r)&&"Uint8Array"===r.constructor.name))throw new Error("Uint8Array expected");var r;if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function i(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function s(t,e){n(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}r.d(e,{CC:()=>i,DO:()=>n,Ht:()=>s})},663:(t,e,r)=>{"use strict";r.d(e,{ZT:()=>d,sc:()=>l});var n=r(190),i=r(531);const s=(t,e,r)=>t&e^t&r^e&r;class o extends i.Vw{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,i.O8)(this.buffer)}update(t){(0,n.CC)(this);const{view:e,buffer:r,blockLen:s}=this,o=(t=(0,i.ZJ)(t)).length;for(let n=0;n<o;){const a=Math.min(s-this.pos,o-n);if(a!==s)r.set(t.subarray(n,n+a),this.pos),this.pos+=a,n+=a,this.pos===s&&(this.process(e,0),this.pos=0);else{const e=(0,i.O8)(t);for(;s<=o-n;n+=s)this.process(e,n)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,n.CC)(this),(0,n.Ht)(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:s,isLE:o}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>s-a&&(this.process(r,0),a=0);for(let t=a;t<s;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,a,n)}(r,s-8,BigInt(8*this.length),o),this.process(r,0);const c=(0,i.O8)(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=u/4,h=this.get();if(f>h.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<f;t++)c.setUint32(4*t,h[t],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return t.length=n,t.pos=o,t.finished=i,t.destroyed=s,n%e&&t.buffer.set(r),t}}const a=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),c=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),u=new Uint32Array(64);class f extends o{constructor(){super(64,32,8,!1),this.A=0|c[0],this.B=0|c[1],this.C=0|c[2],this.D=0|c[3],this.E=0|c[4],this.F=0|c[5],this.G=0|c[6],this.H=0|c[7]}get(){const{A:t,B:e,C:r,D:n,E:i,F:s,G:o,H:a}=this;return[t,e,r,n,i,s,o,a]}set(t,e,r,n,i,s,o,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)u[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=u[t-15],r=u[t-2],n=(0,i.Ow)(e,7)^(0,i.Ow)(e,18)^e>>>3,s=(0,i.Ow)(r,17)^(0,i.Ow)(r,19)^r>>>10;u[t]=s+u[t-7]+n+u[t-16]|0}let{A:r,B:n,C:o,D:c,E:f,F:h,G:l,H:d}=this;for(let t=0;t<64;t++){const e=d+((0,i.Ow)(f,6)^(0,i.Ow)(f,11)^(0,i.Ow)(f,25))+((p=f)&h^~p&l)+a[t]+u[t]|0,g=((0,i.Ow)(r,2)^(0,i.Ow)(r,13)^(0,i.Ow)(r,22))+s(r,n,o)|0;d=l,l=h,h=f,f=c+e|0,c=o,o=n,n=r,r=e+g|0}var p;r=r+this.A|0,n=n+this.B|0,o=o+this.C|0,c=c+this.D|0,f=f+this.E|0,h=h+this.F|0,l=l+this.G|0,d=d+this.H|0,this.set(r,n,o,c,f,h,l,d)}roundClean(){u.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class h extends f{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const l=(0,i.ld)((()=>new f)),d=(0,i.ld)((()=>new h))},531:(t,e,r)=>{"use strict";r.d(e,{Vw:()=>c,O8:()=>s,po:()=>f,Ow:()=>o,ZJ:()=>a,ld:()=>u});const n="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;var i=r(190);const s=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),o=(t,e)=>t<<32-e|t>>>e;function a(t){return"string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),(0,i.DO)(t),t}class c{clone(){return this._cloneInto()}}function u(t){const e=e=>t().update(a(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function f(t=32){if(n&&"function"==typeof n.getRandomValues)return n.getRandomValues(new Uint8Array(t));if(n&&"function"==typeof n.randomBytes)return n.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,r),s.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t=r(287),e=r(485),n=r(857),i=r(664),s=r(810),o=r(338);function a(){return function(...t){return async(e,r,n)=>{for(const i of t)await i(e,r,n)}}((t=function(){let t=!0;return async()=>!!t&&(t=!1,!0)}(),async(e,r,n)=>{if(await t(e,r,n))return new Promise((t=>setTimeout(t,1e3)))}),function(){let t=1e3;return()=>new Promise((e=>setTimeout((()=>{t*=1.2,e()}),t)))}(),function(t){const e=Date.now()+t;return async(t,r,n)=>{if(Date.now()>e)throw new Error(`Request timed out after 300000 msec:\n  Request ID: ${(0,o.nj)(r)}\n  Request status: ${n}\n`)}}(3e5));var t}var c=r(373);async function u(t,r,n,i=a(),f,h){var l;const d=[(new TextEncoder).encode("request_status"),n],p=null!=f?f:await(null===(l=t.createReadStateRequest)||void 0===l?void 0:l.call(t,{paths:[d]}));p.body.content.ingress_expiry=new e.MM(c.j);const g=await t.readState(r,{paths:[d]},void 0,p);if(null==t.rootKey)throw new Error("Agent root key not initialized before polling");const y=await s.us.create({certificate:g.certificate,rootKey:t.rootKey,canisterId:r,blsVerify:h}),w=(0,s.Xr)(y.lookup([...d,(new TextEncoder).encode("status")]));let b;switch(b=void 0===w?e.BY.Unknown:(new TextDecoder).decode(w),b){case e.BY.Replied:return{reply:(0,s.Xr)(y.lookup([...d,"reply"])),certificate:y};case e.BY.Received:case e.BY.Unknown:case e.BY.Processing:return await i(r,n,b),u(t,r,n,i,p,h);case e.BY.Rejected:{const t=new Uint8Array((0,s.Xr)(y.lookup([...d,"reject_code"])))[0],e=(new TextDecoder).decode((0,s.Xr)(y.lookup([...d,"reject_message"])));throw new Error(`Call was rejected:\n  Request ID: ${(0,o.nj)(n)}\n  Reject code: ${t}\n  Reject text: ${e}\n`)}case e.BY.Done:throw new Error(`Call was marked as done but we never saw the reply:\n  Request ID: ${(0,o.nj)(n)}\n`)}throw new Error("unreachable")}var f=r(336);const h=({IDL:t})=>{const e=t.Variant({mainnet:t.Null,testnet:t.Null}),r=t.Text,n=t.Record({network:e,address:r,min_confirmations:t.Opt(t.Nat32)}),i=t.Nat64,s=i,o=t.Record({network:e}),a=t.Nat64,c=t.Vec(a),u=t.Record({network:e,filter:t.Opt(t.Variant({page:t.Vec(t.Nat8),min_confirmations:t.Nat32})),address:r}),f=t.Vec(t.Nat8),h=t.Record({txid:t.Vec(t.Nat8),vout:t.Nat32}),l=t.Record({height:t.Nat32,value:i,outpoint:h}),d=t.Record({next_page:t.Opt(t.Vec(t.Nat8)),tip_height:t.Nat32,tip_block_hash:f,utxos:t.Vec(l)}),p=t.Record({transaction:t.Vec(t.Nat8),network:e}),g=t.Principal,y=t.Record({canister_id:g,num_requested_changes:t.Opt(t.Nat64)}),w=t.Variant({from_user:t.Record({user_id:t.Principal}),from_canister:t.Record({canister_version:t.Opt(t.Nat64),canister_id:t.Principal})}),b=t.Variant({creation:t.Record({controllers:t.Vec(t.Principal)}),code_deployment:t.Record({mode:t.Variant({reinstall:t.Null,upgrade:t.Null,install:t.Null}),module_hash:t.Vec(t.Nat8)}),controllers_change:t.Record({controllers:t.Vec(t.Principal)}),code_uninstall:t.Null}),m=t.Record({timestamp_nanos:t.Nat64,canister_version:t.Nat64,origin:w,details:b}),v=t.Record({controllers:t.Vec(t.Principal),module_hash:t.Opt(t.Vec(t.Nat8)),recent_changes:t.Vec(m),total_num_changes:t.Nat64}),E=t.Record({canister_id:g}),_=t.Variant({controllers:t.Null,public:t.Null}),I=t.Record({freezing_threshold:t.Nat,controllers:t.Vec(t.Principal),reserved_cycles_limit:t.Nat,log_visibility:_,wasm_memory_limit:t.Nat,memory_allocation:t.Nat,compute_allocation:t.Nat}),B=t.Record({status:t.Variant({stopped:t.Null,stopping:t.Null,running:t.Null}),memory_size:t.Nat,cycles:t.Nat,settings:I,query_stats:t.Record({response_payload_bytes_total:t.Nat,num_instructions_total:t.Nat,num_calls_total:t.Nat,request_payload_bytes_total:t.Nat}),idle_cycles_burned_per_day:t.Nat,module_hash:t.Opt(t.Vec(t.Nat8)),reserved_cycles:t.Nat}),x=t.Record({canister_id:g}),A=t.Record({freezing_threshold:t.Opt(t.Nat),controllers:t.Opt(t.Vec(t.Principal)),reserved_cycles_limit:t.Opt(t.Nat),log_visibility:t.Opt(_),wasm_memory_limit:t.Opt(t.Nat),memory_allocation:t.Opt(t.Nat),compute_allocation:t.Opt(t.Nat)}),T=t.Record({settings:t.Opt(A),sender_canister_version:t.Opt(t.Nat64)}),S=t.Record({canister_id:g}),O=t.Record({canister_id:g}),N=t.Record({canister_id:g}),R=t.Variant({secp256k1:t.Null}),U=t.Record({key_id:t.Record({name:t.Text,curve:R}),canister_id:t.Opt(g),derivation_path:t.Vec(t.Vec(t.Nat8))}),P=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),k=t.Record({canister_id:g}),j=t.Record({idx:t.Nat64,timestamp_nanos:t.Nat64,content:t.Vec(t.Nat8)}),F=t.Record({canister_log_records:t.Vec(j)}),L=t.Record({value:t.Text,name:t.Text}),D=t.Record({status:t.Nat,body:t.Vec(t.Nat8),headers:t.Vec(L)}),C=t.Record({url:t.Text,method:t.Variant({get:t.Null,head:t.Null,post:t.Null}),max_response_bytes:t.Opt(t.Nat64),body:t.Opt(t.Vec(t.Nat8)),transform:t.Opt(t.Record({function:t.Func([t.Record({context:t.Vec(t.Nat8),response:D})],[D],["query"]),context:t.Vec(t.Nat8)})),headers:t.Vec(L)}),M=t.Variant({reinstall:t.Null,upgrade:t.Opt(t.Record({wasm_memory_persistence:t.Opt(t.Variant({keep:t.Null,replace:t.Null})),skip_pre_upgrade:t.Opt(t.Bool)})),install:t.Null}),q=t.Record({hash:t.Vec(t.Nat8)}),V=t.Record({arg:t.Vec(t.Nat8),wasm_module_hash:t.Vec(t.Nat8),mode:M,chunk_hashes_list:t.Vec(q),target_canister:g,store_canister:t.Opt(g),sender_canister_version:t.Opt(t.Nat64)}),$=t.Vec(t.Nat8),z=t.Record({arg:t.Vec(t.Nat8),wasm_module:$,mode:M,canister_id:g,sender_canister_version:t.Opt(t.Nat64)}),G=t.Record({start_at_timestamp_nanos:t.Nat64,subnet_id:t.Principal}),K=t.Record({num_block_failures_total:t.Nat64,node_id:t.Principal,num_blocks_proposed_total:t.Nat64}),W=t.Vec(t.Record({timestamp_nanos:t.Nat64,node_metrics:t.Vec(K)})),H=t.Record({settings:t.Opt(A),specified_id:t.Opt(g),amount:t.Opt(t.Nat),sender_canister_version:t.Opt(t.Nat64)}),Y=t.Record({canister_id:g}),Z=t.Record({canister_id:g,amount:t.Nat}),J=t.Vec(t.Nat8),X=t.Variant({ed25519:t.Null,bip340secp256k1:t.Null}),Q=t.Record({key_id:t.Record({algorithm:X,name:t.Text}),canister_id:t.Opt(g),derivation_path:t.Vec(t.Vec(t.Nat8))}),tt=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),et=t.Record({key_id:t.Record({name:t.Text,curve:R}),derivation_path:t.Vec(t.Vec(t.Nat8)),message_hash:t.Vec(t.Nat8)}),rt=t.Record({signature:t.Vec(t.Nat8)}),nt=t.Record({key_id:t.Record({algorithm:X,name:t.Text}),derivation_path:t.Vec(t.Vec(t.Nat8)),message:t.Vec(t.Nat8)}),it=t.Record({signature:t.Vec(t.Nat8)}),st=t.Record({canister_id:g}),ot=t.Record({canister_id:g}),at=t.Record({canister_id:g}),ct=t.Vec(q),ut=t.Record({canister_id:g,sender_canister_version:t.Opt(t.Nat64)}),ft=t.Record({canister_id:t.Principal,settings:A,sender_canister_version:t.Opt(t.Nat64)}),ht=t.Record({chunk:t.Vec(t.Nat8),canister_id:t.Principal}),lt=q;return t.Service({bitcoin_get_balance:t.Func([n],[s],[]),bitcoin_get_current_fee_percentiles:t.Func([o],[c],[]),bitcoin_get_utxos:t.Func([u],[d],[]),bitcoin_send_transaction:t.Func([p],[],[]),canister_info:t.Func([y],[v],[]),canister_status:t.Func([E],[B],[]),clear_chunk_store:t.Func([x],[],[]),create_canister:t.Func([T],[S],[]),delete_canister:t.Func([O],[],[]),deposit_cycles:t.Func([N],[],[]),ecdsa_public_key:t.Func([U],[P],[]),fetch_canister_logs:t.Func([k],[F],["query"]),http_request:t.Func([C],[D],[]),install_chunked_code:t.Func([V],[],[]),install_code:t.Func([z],[],[]),node_metrics_history:t.Func([G],[W],[]),provisional_create_canister_with_cycles:t.Func([H],[Y],[]),provisional_top_up_canister:t.Func([Z],[],[]),raw_rand:t.Func([],[J],[]),schnorr_public_key:t.Func([Q],[tt],[]),sign_with_ecdsa:t.Func([et],[rt],[]),sign_with_schnorr:t.Func([nt],[it],[]),start_canister:t.Func([st],[],[]),stop_canister:t.Func([ot],[],[]),stored_chunks:t.Func([at],[ct],[]),uninstall_code:t.Func([ut],[],[]),update_settings:t.Func([ft],[],[]),upload_chunk:t.Func([ht],[lt],[])})};class l extends n.Yv{constructor(t,e,r,n){super(["Call failed:",`  Canister: ${t.toText()}`,`  Method: ${e} (${r})`,...Object.getOwnPropertyNames(n).map((t=>`  "${t}": ${JSON.stringify(n[t])}`))].join("\n")),this.canisterId=t,this.methodName=e,this.type=r,this.props=n}}class d extends l{constructor(t,r,n){var i;super(t,r,"query",{Status:n.status,Code:null!==(i=e.RK[n.reject_code])&&void 0!==i?i:`Unknown Code "${n.reject_code}"`,Message:n.reject_message}),this.result=n}}class p extends l{constructor(t,e,r,n,i,s,a){super(t,e,"update",Object.assign({"Request ID":(0,o.nj)(r)},n.body?Object.assign(Object.assign({},a?{"Error code":a}:{}),{"Reject code":String(i),"Reject message":s}):{"HTTP status code":n.status.toString(),"HTTP status text":n.statusText})),this.requestId=r,this.response=n,this.reject_code=i,this.reject_message=s,this.error_code=a}}const g=Symbol.for("ic-agent-metadata");class y{constructor(t){this[g]=Object.freeze(t)}static agentOf(t){return t[g].config.agent}static interfaceOf(t){return t[g].service}static canisterIdOf(t){return f.p.from(t[g].config.canisterId)}static async install(t,e){const r=void 0===t.mode?{install:null}:t.mode,n=t.arg?[...new Uint8Array(t.arg)]:[],i=[...new Uint8Array(t.module)],s="string"==typeof e.canisterId?f.p.fromText(e.canisterId):e.canisterId;await _(e).install_code({mode:r,arg:n,wasm_module:i,canister_id:s,sender_canister_version:[]})}static async createCanister(t,e){const{canister_id:r}=await _(t||{}).provisional_create_canister_with_cycles({amount:[],settings:function(t){return[{controllers:t.controllers?[t.controllers]:[],compute_allocation:t.compute_allocation?[t.compute_allocation]:[],freezing_threshold:t.freezing_threshold?[t.freezing_threshold]:[],memory_allocation:t.memory_allocation?[t.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}(e||{}),specified_id:[],sender_canister_version:[]});return r}static async createAndInstallCanister(t,e,r){const n=await this.createCanister(r);return await this.install(Object.assign({},e),Object.assign(Object.assign({},r),{canisterId:n})),this.createActor(t,Object.assign(Object.assign({},r),{canisterId:n}))}static createActorClass(t,e){const r=t({IDL:i.Ih});return class extends y{constructor(t){if(!t.canisterId)throw new n.Yv(`Canister ID is required, but received ${typeof t.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const i="string"==typeof t.canisterId?f.p.fromText(t.canisterId):t.canisterId;super({config:Object.assign(Object.assign(Object.assign({},b),t),{canisterId:i}),service:r});for(const[n,i]of r._fields)(null==e?void 0:e.httpDetails)&&i.annotations.push(m),(null==e?void 0:e.certificate)&&i.annotations.push(v),this[n]=E(this,n,i,t.blsVerify)}}}static createActor(t,e){if(!e.canisterId)throw new n.Yv(`Canister ID is required, but received ${typeof e.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(t))(e)}static createActorWithHttpDetails(t,e){return new(this.createActorClass(t,{httpDetails:!0}))(e)}static createActorWithExtendedDetails(t,e,r={httpDetails:!0,certificate:!0}){return new(this.createActorClass(t,r))(e)}}function w(e,r){const n=i.Ih.decode(e,t.hp.from(r));switch(n.length){case 0:return;case 1:return n[0];default:return n}}const b={pollingStrategyFactory:a},m="http-details",v="certificate";function E(t,r,o,a){let c;c=o.annotations.includes("query")||o.annotations.includes("composite_query")?async(n,...s)=>{var a,c;const u=(n=Object.assign(Object.assign({},n),null===(c=(a=t[g].config).queryTransform)||void 0===c?void 0:c.call(a,r,s,Object.assign(Object.assign({},t[g].config),n)))).agent||t[g].config.agent||(0,e.i8)(),h=f.p.from(n.canisterId||t[g].config.canisterId),l=i.Ih.encode(o.argTypes,s),p=await u.query(h,{methodName:r,arg:l,effectiveCanisterId:n.effectiveCanisterId}),y=Object.assign(Object.assign({},p.httpDetails),{requestDetails:p.requestDetails});switch(p.status){case"rejected":throw new d(h,r,p);case"replied":return o.annotations.includes(m)?{httpDetails:y,result:w(o.retTypes,p.reply.arg)}:w(o.retTypes,p.reply.arg)}}:async(c,...h)=>{var l,d;const y=(c=Object.assign(Object.assign({},c),null===(d=(l=t[g].config).callTransform)||void 0===d?void 0:d.call(l,r,h,Object.assign(Object.assign({},t[g].config),c)))).agent||t[g].config.agent||(0,e.i8)(),{canisterId:E,effectiveCanisterId:_,pollingStrategyFactory:I}=Object.assign(Object.assign(Object.assign({},b),t[g].config),c),B=f.p.from(E),x=void 0!==_?f.p.from(_):B,A=i.Ih.encode(o.argTypes,h);if(null==y.rootKey)throw new n.Yv("Agent root key not initialized before making call");const{requestId:T,response:S,requestDetails:O}=await y.call(B,{methodName:r,arg:A,effectiveCanisterId:x});let N,R;if(S.body&&S.body.certificate){const t=S.body.certificate;R=await s.us.create({certificate:(0,i.em)(t),rootKey:y.rootKey,canisterId:f.p.from(E),blsVerify:a});const e=[(new TextEncoder).encode("request_status"),T];switch((new TextDecoder).decode((0,s.Xr)(R.lookup([...e,"status"])))){case"replied":N=(0,s.Xr)(R.lookup([...e,"reply"]));break;case"rejected":{const t=new Uint8Array((0,s.Xr)(R.lookup([...e,"reject_code"])))[0],n=(new TextDecoder).decode((0,s.Xr)(R.lookup([...e,"reject_message"]))),i=(0,s.Xr)(R.lookup([...e,"error_code"])),o=i?(new TextDecoder).decode(i):void 0;throw new p(B,r,T,S,t,n,o)}}}else if(S.body&&"reject_message"in S.body){const{reject_code:t,reject_message:e,error_code:n}=S.body;throw new p(B,r,T,S,t,e,n)}if(202===S.status){const t=I(),e=await u(y,x,T,t,a);R=e.certificate,N=e.reply}const U=o.annotations.includes(m),P=o.annotations.includes(v),k=Object.assign(Object.assign({},S),{requestDetails:O});if(void 0!==N)return U&&P?{httpDetails:k,certificate:R,result:w(o.retTypes,N)}:P?{certificate:R,result:w(o.retTypes,N)}:U?{httpDetails:k,result:w(o.retTypes,N)}:w(o.retTypes,N);if(0===o.retTypes.length)return U?{httpDetails:S,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${o.retTypes.join(",")}].`)};const h=(...t)=>c({},...t);return h.withOptions=t=>(...e)=>c(t,...e),h}function _(t){function e(e,r){if(t.effectiveCanisterId)return{effectiveCanisterId:f.p.from(t.effectiveCanisterId)};const n=r[0];let i=f.p.fromHex("");return n&&"object"==typeof n&&n.canister_id&&(i=f.p.from(n.canister_id)),{effectiveCanisterId:i}}return y.createActor(h,Object.assign(Object.assign(Object.assign({},t),{canisterId:f.p.fromHex("")}),{callTransform:e,queryTransform:e}))}r(218),r(477);var I=r(508),B=r(919);r(57),r(649),r(499);var x,A,T,S,O=r(141),N=(r(358),r(31)),R=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},U=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};function P(t){return null!==t&&"object"==typeof t}class k{constructor(t){if(x.set(this,void 0),A.set(this,void 0),t.byteLength!==k.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");R(this,x,t,"f"),R(this,A,k.derEncode(t),"f")}static from(t){if("string"==typeof t){const e=(0,o.aD)(t);return this.fromRaw(e)}if(P(t)){const e=t;if(P(e)&&Object.hasOwnProperty.call(e,"__derEncodedPublicKey__"))return this.fromDer(e);if(ArrayBuffer.isView(e)){const t=e;return this.fromRaw((0,o.em)(t.buffer))}if(e instanceof ArrayBuffer)return this.fromRaw(e);if("rawKey"in e)return this.fromRaw(e.rawKey);if("derKey"in e)return this.fromDer(e.derKey);if("toDer"in e)return this.fromDer(e.toDer())}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(t){return new k(t)}static fromDer(t){return new k(this.derDecode(t))}static derEncode(t){const e=(0,B.C2)(t,B.le).buffer;return e.__derEncodedPublicKey__=void 0,e}static derDecode(t){const e=(0,B.n9)(t,B.le);if(e.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return e}get rawKey(){return U(this,x,"f")}get derKey(){return U(this,A,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}x=new WeakMap,A=new WeakMap,k.RAW_KEY_LENGTH=32;class j extends I.A4{constructor(t,e){super(),T.set(this,void 0),S.set(this,void 0),R(this,T,k.from(t),"f"),R(this,S,new Uint8Array(e),"f")}static generate(t){if(t&&32!==t.length)throw new Error("Ed25519 Seed needs to be 32 bytes long.");t||(t=N.ev.utils.randomPrivateKey()),(0,o.HA)(t,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const e=new Uint8Array(32);for(let r=0;r<32;r++)e[r]=new Uint8Array(t)[r];const r=N.ev.getPublicKey(e);return j.fromKeyPair(r,e)}static fromParsedJson(t){const[e,r]=t;return new j(k.fromDer((0,o.aD)(e)),(0,o.aD)(r))}static fromJSON(t){const e=JSON.parse(t);if(Array.isArray(e)){if("string"==typeof e[0]&&"string"==typeof e[1])return this.fromParsedJson([e[0],e[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(t)}`)}static fromKeyPair(t,e){return new j(k.fromRaw(t),e)}static fromSecretKey(t){const e=N.ev.getPublicKey(new Uint8Array(t));return j.fromKeyPair(e,t)}toJSON(){return[(0,o.nj)(U(this,T,"f").toDer()),(0,o.nj)(U(this,S,"f"))]}getKeyPair(){return{secretKey:U(this,S,"f"),publicKey:U(this,T,"f")}}getPublicKey(){return U(this,T,"f")}async sign(t){const e=new Uint8Array(t),r=(0,o.Nn)(N.ev.sign(e,U(this,S,"f").slice(0,32)));return Object.defineProperty(r,"__signature__",{enumerable:!1,value:void 0}),r}static verify(t,e,r){const[n,i,s]=[t,e,r].map((t=>("string"==typeof t&&(t=(0,o.aD)(t)),t instanceof Uint8Array&&(t=t.buffer),new Uint8Array(t))));return N.ev.verify(i,n,s)}}T=new WeakMap,S=new WeakMap;class F extends Error{constructor(t){super(t),this.message=t,Object.setPrototypeOf(this,F.prototype)}}function L(t){if(void 0!==r.g&&r.g.crypto&&r.g.crypto.subtle)return r.g.crypto.subtle;if(t)return t;if("undefined"!=typeof crypto&&crypto.subtle)return crypto.subtle;throw new F("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class D extends I.A4{constructor(t,e,r){super(),this._keyPair=t,this._derKey=e,this._subtleCrypto=r}static async generate(t){const{extractable:e=!1,keyUsages:r=["sign","verify"],subtleCrypto:n}=null!=t?t:{},i=L(n),s=await i.generateKey({name:"ECDSA",namedCurve:"P-256"},e,r);return new this(s,await i.exportKey("spki",s.publicKey),i)}static async fromKeyPair(t,e){const r=L(e),n=await r.exportKey("spki",t.publicKey);return new D(t,n,r)}getKeyPair(){return this._keyPair}getPublicKey(){const t=this._derKey,e=Object.create(this._keyPair.publicKey);return e.toDer=function(){return t},e}async sign(t){return await this._subtleCrypto.sign({name:"ECDSA",hash:{name:"SHA-256"}},this._keyPair.privateKey,t)}}var C,M=r(283),q=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class V{constructor(t){C.set(this,void 0),function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?i.call(t,r):i?i.value=r:e.set(t,r)}(this,C,t,"f")}get rawKey(){return q(this,C,"f").rawKey}get derKey(){return q(this,C,"f").derKey}toDer(){return q(this,C,"f").toDer()}getPublicKey(){return q(this,C,"f")}getPrincipal(){return f.p.from(q(this,C,"f").rawKey)}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}C=new WeakMap;var $;const z=(new TextEncoder).encode("ic-request-auth-delegation"),G=(new TextEncoder).encode("\nic-request");function K(t){if("string"!=typeof t||t.length<64)throw new Error("Invalid public key.");return(0,o.aD)(t)}class W{constructor(t,e,r){this.pubkey=t,this.expiration=e,this.targets=r}toCBOR(){return M.value.map(Object.assign({pubkey:M.value.bytes(this.pubkey),expiration:M.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:M.value.array(this.targets.map((t=>M.value.bytes(t.toUint8Array()))))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:(0,o.nj)(this.pubkey)},this.targets&&{targets:this.targets.map((t=>t.toHex()))})}}class H{constructor(t,e){this.delegations=t,this.publicKey=e}static async create(t,e,r=new Date(Date.now()+9e5),n={}){var i,s;const o=await async function(t,e,r,n){const i=new W(e.toDer(),BigInt(+r)*BigInt(1e6),n),s=new Uint8Array([...z,...new Uint8Array((0,O.Gb)(i))]);return{delegation:i,signature:await t.sign(s)}}(t,e,r,n.targets);return new H([...(null===(i=n.previous)||void 0===i?void 0:i.delegations)||[],o],(null===(s=n.previous)||void 0===s?void 0:s.publicKey)||t.getPublicKey().toDer())}static fromJSON(t){const{publicKey:e,delegations:r}="string"==typeof t?JSON.parse(t):t;if(!Array.isArray(r))throw new Error("Invalid delegations.");return new this(r.map((t=>{const{delegation:e,signature:r}=t,{pubkey:n,expiration:i,targets:s}=e;if(void 0!==s&&!Array.isArray(s))throw new Error("Invalid targets.");return{delegation:new W(K(n),BigInt("0x"+i),s&&s.map((t=>{if("string"!=typeof t)throw new Error("Invalid target.");return f.p.fromHex(t)}))),signature:K(r)}})),K(e))}static fromDelegations(t,e){return new this(t,e)}toJSON(){return{delegations:this.delegations.map((t=>{const{delegation:e,signature:r}=t,{targets:n}=e;return{delegation:Object.assign({expiration:e.expiration.toString(16),pubkey:(0,o.nj)(e.pubkey)},n&&{targets:n.map((t=>t.toHex()))}),signature:(0,o.nj)(r)}})),publicKey:(0,o.nj)(this.publicKey)}}}class Y extends I.A4{constructor(t,e){super(),this._inner=t,this._delegation=e}static fromDelegation(t,e){return new this(t,e)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(t){return this._inner.sign(t)}async transformRequest(t){const{body:e}=t,r=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r}(t,["body"]),n=await(0,O.Gb)(e);return Object.assign(Object.assign({},r),{body:{content:e,sender_sig:await this.sign(new Uint8Array([...G,...new Uint8Array(n)])),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class Z extends V{constructor(t,e){super(t),$.set(this,void 0),function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?i.call(t,r):i?i.value=r:e.set(t,r)}(this,$,e,"f")}get delegation(){return function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}(this,$,"f")}static fromDelegation(t,e){return new Z(t,e)}}var J;$=new WeakMap,r(516),r(531),function(t){t[t.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"}(J||(J={})),I.A4;const X=["mousedown","mousemove","keydown","touchstart","wheel"];class Q{constructor(t={}){var e;this.callbacks=[],this.idleTimeout=6e5,this.timeoutID=void 0;const{onIdle:r,idleTimeout:n=6e5}=t||{};this.callbacks=r?[r]:[],this.idleTimeout=n;const i=this._resetTimer.bind(this);window.addEventListener("load",i,!0),X.forEach((function(t){document.addEventListener(t,i,!0)}));const s=(t,e)=>{let r;return(...n)=>{const i=this;clearTimeout(r),r=window.setTimeout((function(){r=void 0,t.apply(i,n)}),e)}};if(null==t?void 0:t.captureScroll){const r=s(i,null!==(e=null==t?void 0:t.scrollDebounce)&&void 0!==e?e:100);window.addEventListener("scroll",r,!0)}i()}static create(t={}){return new this(t)}registerCallback(t){this.callbacks.push(t)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const t=this._resetTimer.bind(this);X.forEach((function(e){document.removeEventListener(e,t,!0)})),this.callbacks.forEach((t=>t()))}_resetTimer(){const t=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(t,this.idleTimeout)}}let tt,et;const rt=new WeakMap,nt=new WeakMap,it=new WeakMap,st=new WeakMap,ot=new WeakMap;let at={get(t,e,r){if(t instanceof IDBTransaction){if("done"===e)return nt.get(t);if("objectStoreNames"===e)return t.objectStoreNames||it.get(t);if("store"===e)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ut(t[e])},set:(t,e,r)=>(t[e]=r,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function ct(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(et||(et=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(ft(this),t),ut(rt.get(this))}:function(...t){return ut(e.apply(ft(this),t))}:function(t,...r){const n=e.call(ft(this),t,...r);return it.set(n,t.sort?t.sort():[t]),ut(n)}:(t instanceof IDBTransaction&&function(t){if(nt.has(t))return;const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",s),t.removeEventListener("abort",s)},i=()=>{e(),n()},s=()=>{r(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",i),t.addEventListener("error",s),t.addEventListener("abort",s)}));nt.set(t,e)}(t),r=t,(tt||(tt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>r instanceof t))?new Proxy(t,at):t);var e,r}function ut(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("success",i),t.removeEventListener("error",s)},i=()=>{e(ut(t.result)),n()},s=()=>{r(t.error),n()};t.addEventListener("success",i),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&rt.set(e,t)})).catch((()=>{})),ot.set(e,t),e}(t);if(st.has(t))return st.get(t);const e=ct(t);return e!==t&&(st.set(t,e),ot.set(e,t)),e}const ft=t=>ot.get(t),ht=["get","getKey","getAll","getAllKeys","count"],lt=["put","add","delete","clear"],dt=new Map;function pt(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(dt.get(e))return dt.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=lt.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!ht.includes(r))return;const s=async function(t,...e){const s=this.transaction(t,i?"readwrite":"readonly");let o=s.store;return n&&(o=o.index(e.shift())),(await Promise.all([o[r](...e),i&&s.done]))[0]};return dt.set(e,s),s}var gt;gt=at,at={...gt,get:(t,e,r)=>pt(t,e)||gt.get(t,e,r),has:(t,e)=>!!pt(t,e)||gt.has(t,e)};const yt="auth-client-db",wt="ic-keyval";class bt{constructor(t,e){this._db=t,this._storeName=e}static async create(t){const{dbName:e=yt,storeName:r=wt,version:n=_t}=null!=t?t:{},i=await(async(t=yt,e=wt,r)=>(It&&(null===localStorage||void 0===localStorage?void 0:localStorage.getItem(Et))&&(localStorage.removeItem(Et),localStorage.removeItem(vt)),await function(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=ut(o);return n&&o.addEventListener("upgradeneeded",(t=>{n(ut(o.result),t.oldVersion,t.newVersion,ut(o.transaction),t)})),r&&o.addEventListener("blocked",(t=>r(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(t,r,{upgrade:t=>{t.objectStoreNames.contains(e)&&t.clear(e),t.createObjectStore(e)}})))(e,r,n);return new bt(i,r)}async set(t,e){return await async function(t,e,r,n){return await t.put(e,n,r)}(this._db,this._storeName,t,e)}async get(t){var e;return null!==(e=await async function(t,e,r){return await t.get(e,r)}(this._db,this._storeName,t))&&void 0!==e?e:null}async remove(t){return await async function(t,e,r){return await t.delete(e,r)}(this._db,this._storeName,t)}}var mt;const vt="identity",Et="delegation",_t=1,It="undefined"!=typeof window;class Bt{constructor(t="ic-",e){this.prefix=t,this._localStorage=e}get(t){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+t))}set(t,e){return this._getLocalStorage().setItem(this.prefix+t,e),Promise.resolve()}remove(t){return this._getLocalStorage().removeItem(this.prefix+t),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const t="undefined"==typeof window?void 0===r.g?"undefined"==typeof self?void 0:self.localStorage:r.g.localStorage:window.localStorage;if(!t)throw new Error("Could not find local storage.");return t}}class xt{constructor(t){mt.set(this,void 0),function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?i.call(t,r):i?i.value=r:e.set(t,r)}(this,mt,null!=t?t:{},"f")}get _db(){return new Promise((t=>{this.initializedDb?t(this.initializedDb):bt.create(function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}(this,mt,"f")).then((e=>{this.initializedDb=e,t(e)}))}))}async get(t){const e=await this._db;return await e.get(t)}async set(t,e){const r=await this._db;await r.set(t,e)}async remove(t){const e=await this._db;await e.remove(t)}}mt=new WeakMap;const At="ECDSA",Tt="Ed25519";class St{constructor(t,e,r,n,i,s,o,a){this._identity=t,this._key=e,this._chain=r,this._storage=n,this.idleManager=i,this._createOptions=s,this._idpWindow=o,this._eventHandler=a,this._registerDefaultIdleCallback()}static async create(t={}){var e,r,n;const i=null!==(e=t.storage)&&void 0!==e?e:new xt,s=null!==(r=t.keyType)&&void 0!==r?r:At;let o=null;if(t.identity)o=t.identity;else{let t=await i.get(vt);if(!t&&It)try{const e=new Bt,r=await e.get(Et),n=await e.get(vt);r&&n&&s===At&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await i.set(Et,r),await i.set(vt,n),t=r,await e.remove(Et),await e.remove(vt))}catch(t){console.error("error while attempting to recover localstorage: "+t)}if(t)try{"object"==typeof t?o=s===Tt&&"string"==typeof t?await j.fromJSON(t):await D.fromKeyPair(t):"string"==typeof t&&(o=j.fromJSON(t))}catch(t){}}let a,c=new I.mC,u=null;if(o)try{const e=await i.get(Et);if("object"==typeof e&&null!==e)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");t.identity?c=t.identity:e&&(u=H.fromJSON(e),function(t){for(const{delegation:e}of t.delegations)if(+new Date(Number(e.expiration/BigInt(1e6)))<=+Date.now())return!1;const e=[],r=void 0;r&&(Array.isArray(r)?e.push(...r.map((t=>"string"==typeof t?f.p.fromText(t):t))):e.push("string"==typeof r?f.p.fromText(r):r));for(const r of e){const e=r.toText();for(const{delegation:r}of t.delegations){if(void 0===r.targets)continue;let t=!0;for(const n of r.targets)if(n.toText()===e){t=!1;break}if(t)return!1}}return!0}(u)?c="toDer"in o?Z.fromDelegation(o,u):Y.fromDelegation(o,u):(await Ot(i),o=null))}catch(t){console.error(t),await Ot(i),o=null}return(null===(n=t.idleOptions)||void 0===n?void 0:n.disableIdle)?a=void 0:(u||t.identity)&&(a=Q.create(t.idleOptions)),o||(s===Tt?(o=await j.generate(),await i.set(vt,JSON.stringify(o.toJSON()))):(t.storage&&s===At&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${Tt}' as the key type, as it can serialize to a string`),o=await D.generate(),await i.set(vt,o.getKeyPair()))),new this(c,o,u,i,a,t)}_registerDefaultIdleCallback(){var t,e;const r=null===(t=this._createOptions)||void 0===t?void 0:t.idleOptions;(null==r?void 0:r.onIdle)||(null==r?void 0:r.disableDefaultIdleCallback)||null===(e=this.idleManager)||void 0===e||e.registerCallback((()=>{this.logout(),location.reload()}))}async _handleSuccess(t,e){var r,n;const i=t.delegations.map((t=>({delegation:new W(t.delegation.pubkey,t.delegation.expiration,t.delegation.targets),signature:t.signature.buffer}))),s=H.fromDelegations(i,t.userPublicKey.buffer),o=this._key;if(!o)return;this._chain=s,this._identity="toDer"in o?Z.fromDelegation(o,this._chain):Y.fromDelegation(o,this._chain),null===(r=this._idpWindow)||void 0===r||r.close();const a=null===(n=this._createOptions)||void 0===n?void 0:n.idleOptions;this.idleManager||(null==a?void 0:a.disableIdle)||(this.idleManager=Q.create(a),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(Et,JSON.stringify(this._chain.toJSON())),null==e||e(t)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&null!==this._chain}async login(t){var e,r,n,i;const s=BigInt(8)*BigInt(36e11),o=new URL((null===(e=null==t?void 0:t.identityProvider)||void 0===e?void 0:e.toString())||"https://identity.ic0.app");o.hash="#authorize",null===(r=this._idpWindow)||void 0===r||r.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(o,Object.assign({maxTimeToLive:null!==(n=null==t?void 0:t.maxTimeToLive)&&void 0!==n?n:s},t)),window.addEventListener("message",this._eventHandler),this._idpWindow=null!==(i=window.open(o.toString(),"idpWindow",null==t?void 0:t.windowOpenerFeatures))&&void 0!==i?i:void 0;const a=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure("UserInterrupt",null==t?void 0:t.onError):setTimeout(a,500))};a()}_getEventHandler(t,e){return async r=>{var n,i,s;if(r.origin!==t.origin)return void console.warn(`WARNING: expected origin '${t.origin}', got '${r.origin}' (ignoring)`);const o=r.data;switch(o.kind){case"authorize-ready":{const r=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array(null===(n=this._key)||void 0===n?void 0:n.getPublicKey().toDer()),maxTimeToLive:null==e?void 0:e.maxTimeToLive,allowPinAuthentication:null==e?void 0:e.allowPinAuthentication,derivationOrigin:null===(i=null==e?void 0:e.derivationOrigin)||void 0===i?void 0:i.toString()},null==e?void 0:e.customValues);null===(s=this._idpWindow)||void 0===s||s.postMessage(r,t.origin);break}case"authorize-client-success":try{await this._handleSuccess(o,null==e?void 0:e.onSuccess)}catch(t){this._handleFailure(t.message,null==e?void 0:e.onError)}break;case"authorize-client-failure":this._handleFailure(o.text,null==e?void 0:e.onError)}}}_handleFailure(t,e){var r;null===(r=this._idpWindow)||void 0===r||r.close(),null==e||e(t),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(t={}){if(await Ot(this._storage),this._identity=new I.mC,this._chain=null,t.returnTo)try{window.history.pushState({},"",t.returnTo)}catch(e){window.location.href=t.returnTo}}}async function Ot(t){await t.remove(vt),await t.remove(Et),await t.remove("iv")}function Nt(t){return t>=1e12?(t/1e12).toFixed(2)+" T":t>=1e9?(t/1e9).toFixed(2)+" B":t>=1e6?(t/1e6).toFixed(2)+" M":t>=1e3?(t/1e3).toFixed(2)+" K":t.toString()}const Rt="bw4dl-smaaa-aaaaa-qaacq-cai",Ut=({IDL:t})=>t.Service({whoAmI:t.Func([],[t.Principal],["query"])}),Pt=(t,r={})=>{const n=new e.qB({host:"http://localhost:4943",...r});return n.fetchRootKey().catch(console.error),y.createActor(Ut,{agent:n,canisterId:t})};let kt,jt=Pt(Rt);const Ft=async(t,e=!1)=>{const r=document.getElementById("principal-display");if(r)try{const e=(await t.whoAmI()).toText();r.textContent=`${e}`}catch(t){console.error("Error getting principal:",t),r.textContent="Error fetching principal"}},Lt=t=>{const e=document.getElementById("auth-button");e&&(e.textContent=t?"Sign Out":"Sign in")},Dt=async t=>{const e=t.getIdentity();jt=Pt(Rt,{identity:e}),await Ft(jt,!0),Lt(!0)};(async()=>{kt=await St.create(),await kt.isAuthenticated()?await Dt(kt):(await Ft(jt,!1),Lt(!1)),document.getElementById("auth-button").addEventListener("click",(async()=>{await kt.isAuthenticated()?(await kt.logout(),jt=Pt(Rt),await Ft(jt,!1),Lt(!1)):(await new Promise(((t,e)=>{kt.login({identityProvider:"http://rdmx6-jaaaa-aaaaa-aaadq-cai.localhost:4943",onSuccess:t,onError:e})})),await Dt(kt)),async function(){try{const t=await fetch("/balance",{method:"GET",headers:{"Content-Type":"application/json"}}),e=parseInt(await t.text()),r=Math.min(e/1e13*100,100),n=document.getElementById("energy-fill");n.style.width=`${r}%`,document.getElementById("energy-text").innerText=`${Nt(e)} cycles`,document.getElementById("raw-balance").innerText=`Total: ${Nt(e)} cycles`,document.getElementById("percentage").innerText=`${r.toFixed(1)}% of max capacity`,n.style.background=r<20?"linear-gradient(90deg, #ff5252, #ff8a80)":r<50?"linear-gradient(90deg, #ffd740, #ffecb3)":"linear-gradient(90deg, #4CAF50, #8BC34A)"}catch(t){console.error("Error fetching balance:",t)}}()}))})().catch(console.error)})()})();

================
File: src/assets/bundle.js.LICENSE.txt
================
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */

/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */

/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */

================
File: src/assets/cycles-balance.js
================
function formatCycles(cycles) {
    if (cycles >= 1_000_000_000_000) {
        return (cycles / 1_000_000_000_000).toFixed(2) + ' T';
    } else if (cycles >= 1_000_000_000) {
        return (cycles / 1_000_000_000).toFixed(2) + ' B';
    } else if (cycles >= 1_000_000) {
        return (cycles / 1_000_000).toFixed(2) + ' M';
    } else if (cycles >= 1_000) {
        return (cycles / 1_000).toFixed(2) + ' K';
    }
    return cycles.toString();
}

const MAX_CYCLES = 10_000_000_000_000;

async function updateBalance() {
    try {
        const response = await fetch('/balance', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
            },
        });
        
        const balance = parseInt(await response.text());
        
        // Calculate percentage (capped at 100%)
        const percentage = Math.min((balance / MAX_CYCLES) * 100, 100);
        
        // Update energy bar
        const energyFill = document.getElementById('energy-fill');
        energyFill.style.width = `${percentage}%`;
        
        // Update text displays
        document.getElementById('energy-text').innerText = 
            `${formatCycles(balance)} cycles`;
        document.getElementById('raw-balance').innerText = 
            `Total: ${formatCycles(balance)} cycles`;
        document.getElementById('percentage').innerText = 
            `${percentage.toFixed(1)}% of max capacity`;

        // Change color based on percentage
        if (percentage < 20) {
            energyFill.style.background = 'linear-gradient(90deg, #ff5252, #ff8a80)';
        } else if (percentage < 50) {
            energyFill.style.background = 'linear-gradient(90deg, #ffd740, #ffecb3)';
        } else {
            energyFill.style.background = 'linear-gradient(90deg, #4CAF50, #8BC34A)';
        }

    } catch (error) {
        console.error('Error fetching balance:', error);
    }
}

export { updateBalance };

================
File: src/assets/index.html
================
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Starter page</title>
    <style>
         body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    h1 {
      color: #2f80ed;
    }
    .energy-bar-container {
      width: 100%;
      background-color: #f0f0f0;
      padding: 10px;
      border-radius: 8px;
      margin: 20px 0;
    }
    .energy-bar {
      width: 100%;
      height: 30px;
      background: #ddd;
      border-radius: 5px;
      overflow: hidden;
      position: relative;
    }
    .energy-fill {
      height: 100%;
      background: linear-gradient(90deg, #4CAF50, #8BC34A);
      transition: width 0.5s ease-in-out;
      border-radius: 5px;
    }
    .energy-text {
      position: absolute;
      width: 100%;
      text-align: center;
      line-height: 30px;
      color: #000;
      font-weight: bold;
      text-shadow: 1px 1px 1px rgba(255,255,255,0.5);
    }
    .energy-details {
      display: flex;
      justify-content: space-between;
      margin-top: 5px;
      font-size: 0.9em;
      color: #666;
    }

        .auth-container {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .ii-button {
            background-color: #29ABE2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        .ii-button:hover {
            background-color: #1a8ac0;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #29ABE2;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <h1>Hello from the Internet Computer!</h1>
    <div class="auth-container">
        <div id="auth-section">
            <button id="auth-button" class="ii-button">Sign in</button>
        </div>
        <p>Current Principal: <span id="principal-display">Loading...</span></p>
    </div>

    <div class="energy-bar-container">
        <h3>Energy level</h3>
        <div class="energy-bar">
          <div class="energy-fill" id="energy-fill"></div>
          <div class="energy-text" id="energy-text"></div>
        </div>
        <div class="energy-details">
          <span id="raw-balance"></span>
          <span id="percentage"></span>
        </div>
      </div>

    <script src="bundle.js" type="module"></script>
</body>
</html>

================
File: src/main.mo
================
import Server "mo:server";
import Text "mo:base/Text";
import Nat "mo:base/Nat";
import Assets "mo:assets";
import T "mo:assets/Types";
import Cycles "mo:base/ExperimentalCycles"

shared ({ caller = creator }) actor class () {
  type Request = Server.Request;
  type Response = Server.Response;
  type HttpRequest = Server.HttpRequest;
  type HttpResponse = Server.HttpResponse;
  type ResponseClass = Server.ResponseClass;

  stable var serializedEntries : Server.SerializedEntries = ([], [], [creator]);

  var server = Server.Server({ serializedEntries });

  public query ({ caller }) func whoAmI() : async Principal {
    return caller;
};

    server.get(
  "/balance",
  func(_ : Request, res : ResponseClass) : async Response {
    let balance = Nat.toText(Cycles.balance());
    res.send({
      status_code = 200;
      headers = [("Content-Type", "text/plain")];
      body = Text.encodeUtf8(balance);
      streaming_strategy = null;
      cache_strategy = #noCache;
    });
  },
);

 

  server.get(
    "/json",
    func(_ : Request, res : ResponseClass) : async Response {
      res.json({
        status_code = 200;
        body = "{\"hello\":\"world\"}";
        cache_strategy = #noCache;
      });
    },
  );

  server.get(
    "/404",
    func(_ : Request, res : ResponseClass) : async Response {
      res.send({
        status_code = 404;
        headers = [("Content-Type", "text/plain")];
        body = Text.encodeUtf8("Not found");
        streaming_strategy = null;
        cache_strategy = #noCache;
      });
    },
  );



   let assets = server.assets;

  public shared ({ caller }) func authorize(other : Principal) : async () {
    server.authorize({ caller; other });
  };

  public query func retrieve(path : Assets.Path) : async Assets.Contents {
    assets.retrieve(path);
  };

  public shared ({ caller }) func store(
    arg : {
      key : Assets.Key;
      content_type : Text;
      content_encoding : Text;
      content : Blob;
      sha256 : ?Blob;
    }
  ) : async () {
    server.store({ caller; arg });
  };


  // Bind the server to the HTTP interface
  public query func http_request(req : HttpRequest) : async HttpResponse {
    server.http_request(req);
  };
  public func http_request_update(req : HttpRequest) : async HttpResponse {
    await server.http_request_update(req);
  };

  public func invalidate_cache() : async () {
    server.empty_cache();
  };

  system func preupgrade() {
    serializedEntries := server.entries();
  };

  system func postupgrade() {
    ignore server.cache.pruneAll();
  };


public query func list(arg : {}) : async [T.AssetDetails] {
  assets.list(arg);
};

public query func get(
  arg : {
    key : T.Key;
    accept_encodings : [Text];
  }
) : async ({
  content : Blob;
  content_type : Text;
  content_encoding : Text;
  total_length : Nat;
  sha256 : ?Blob;
}) {
  assets.get(arg);
};

public shared ({ caller }) func create_batch(arg : {}) : async ({
  batch_id : T.BatchId;
}) {
  assets.create_batch({
    caller;
    arg;
  });
};

public shared ({ caller }) func create_chunk(
  arg : {
    batch_id : T.BatchId;
    content : Blob;
  }
) : async ({
  chunk_id : T.ChunkId;
}) {
  assets.create_chunk({
    caller;
    arg;
  });
};

public shared ({ caller }) func commit_batch(args : T.CommitBatchArguments) : async () {
  assets.commit_batch({
    caller;
    args;
  });
};

public shared ({ caller }) func create_asset(arg : T.CreateAssetArguments) : async () {
  assets.create_asset({
    caller;
    arg;
  });
};

public shared ({ caller }) func set_asset_content(arg : T.SetAssetContentArguments) : async () {
  assets.set_asset_content({
    caller;
    arg;
  });
};

public shared ({ caller }) func unset_asset_content(args : T.UnsetAssetContentArguments) : async () {
  assets.unset_asset_content({
    caller;
    args;
  });
};

public shared ({ caller }) func delete_asset(args : T.DeleteAssetArguments) : async () {
  assets.delete_asset({
    caller;
    args;
  });
};

public shared ({ caller }) func clear(args : T.ClearArguments) : async () {
  assets.clear({
    caller;
    args;
  });
};

public type StreamingCallbackToken = {
  key : Text;
  content_encoding : Text;
  index : Nat;
  sha256 : ?Blob;
};

public type StreamingCallbackHttpResponse = {
  body : Blob;
  token : ?StreamingCallbackToken;
};

public query func http_request_streaming_callback(token : T.StreamingCallbackToken) : async StreamingCallbackHttpResponse {
  assets.http_request_streaming_callback(token);
};

};

================
File: dfx.json
================
{
    "canisters": {
      "http_server_test": {
        "main": "src/main.mo",
        "type": "motoko"
      },
      "internet_identity": {
          "type": "custom",
          "candid": "https://github.com/dfinity/internet-identity/releases/download/release-2024-09-17/internet_identity.did",
          "wasm": "https://github.com/dfinity/internet-identity/releases/download/release-2024-09-17/internet_identity_dev.wasm.gz",
          "remote": {
              "id": {
                  "ic": "rdmx6-jaaaa-aaaaa-aaadq-cai"
              }
          },
          "specified_id": "rdmx6-jaaaa-aaaaa-aaadq-cai"
      }
    },
    "defaults": {
      "build": {
        "args": "",
        "packtool": "mops sources"
      }
    },
    "version": 1
  }

================
File: index.js
================
function formatCycles(cycles) {
    if (cycles >= 1_000_000_000_000) {
        return (cycles / 1_000_000_000_000).toFixed(2) + ' T';
    } else if (cycles >= 1_000_000_000) {
        return (cycles / 1_000_000_000).toFixed(2) + ' B';
    } else if (cycles >= 1_000_000) {
        return (cycles / 1_000_000).toFixed(2) + ' M';
    } else if (cycles >= 1_000) {
        return (cycles / 1_000).toFixed(2) + ' K';
    }
    return cycles.toString();
}

const MAX_CYCLES = 10_000_000_000_000;

async function updateBalance() {
    try {
        const response = await fetch('/balance', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
            },
        });
        
        const balance = parseInt(await response.text());
        
        // Calculate percentage (capped at 100%)
        const percentage = Math.min((balance / MAX_CYCLES) * 100, 100);
        
        // Update energy bar
        const energyFill = document.getElementById('energy-fill');
        energyFill.style.width = `${percentage}%`;
        
        // Update text displays
        document.getElementById('energy-text').innerText = 
            `${formatCycles(balance)} cycles`;
        document.getElementById('raw-balance').innerText = 
            `Total: ${formatCycles(balance)} cycles`;
        document.getElementById('percentage').innerText = 
            `${percentage.toFixed(1)}% of max capacity`;

        // Change color based on percentage
        if (percentage < 20) {
            energyFill.style.background = 'linear-gradient(90deg, #ff5252, #ff8a80)';
        } else if (percentage < 50) {
            energyFill.style.background = 'linear-gradient(90deg, #ffd740, #ffecb3)';
        } else {
            energyFill.style.background = 'linear-gradient(90deg, #4CAF50, #8BC34A)';
        }

    } catch (error) {
        console.error('Error fetching balance:', error);
    }
}

// Update balance initially and every 5 seconds
updateBalance();
setInterval(updateBalance, 5000);

================
File: Makefile
================
# Access routes in a local replica
# canisterId.localhost:4943/whatever_route
# http://bw4dl-smaaa-aaaaa-qaacq-cai.localhost:4943/hi

================
File: mops.toml
================
[package]
name = "http_demo"
version = "0.1.0"
description = "A simple HTTP server demo"

[dependencies]
base = "0.12.1"
server = "1.0.0"
http-parser = "0.3.1"
assets = "0.2.2"

================
File: package.json
================
{
    "name": "http_demo",
    "version": "0.1.0",
    "description": "A simple HTTP server demo",
    "scripts": {
        "upload": "node upload.js"
    },
    "dependencies": {
        "@dfinity/agent": "^2.1.3",
        "@dfinity/assets": "^2.1.3",
        "@dfinity/identity": "^2.1.3",
        "@dfinity/auth-client": "^2.1.3",
        "webpack": "^5.96.1",
        "webpack-cli": "^5.1.4"
    }
}

================
File: upload.js
================
const { HttpAgent } = require("@dfinity/agent");
const fs = require("fs");
const path = require("path");
const { Ed25519KeyIdentity } = require("@dfinity/identity");
const { AssetManager } = require("@dfinity/assets");
const { spawn } = require("child_process");

// Create a test identity
const encoder = new TextEncoder();
const seed = new Uint8Array(32);
const base = encoder.encode("test");
seed.set(base, 0);
seed.fill(0);
const testIdentity = Ed25519KeyIdentity.generate(seed);

const canisterId = "bw4dl-smaaa-aaaaa-qaacq-cai"; // Your canister ID
const HOST = `http://127.0.0.1:4943`;

// First authorize the identity
console.log("Authorizing identity...");
const child = spawn("dfx", [
  "canister",
  "call",
  "http_server_test",
  "authorize",
  `(principal "${testIdentity.getPrincipal().toText()}")`,
]);

child.stdout.on("data", (data) => {
  console.log(`Authorization success: ${data}`);
});

child.stderr.on("data", (data) => {
  console.error(`Authorization error: ${data}`);
});

// Only proceed with upload after authorization
child.on("close", (code) => {
  if (code === 0) {
    uploadAssets();
  }
});

async function uploadAssets() {
  const agent = new HttpAgent({ 
    host: HOST,
    identity: testIdentity 
  });
  await agent.fetchRootKey();

  const assetManager = new AssetManager({
    canisterId,
    agent,
  });

  const assets = [];
  fs.readdirSync(path.join(__dirname, "src/assets")).forEach((file) => {
    assets.push([file, fs.readFileSync(path.join(__dirname, "src/assets", file))]);
  });

  console.log(`Uploading ${assets.length} files...`);
  
  for (const [name, file] of assets) {
    const key = await assetManager.store(file, { fileName: name });
    const asset = await assetManager.get(key);
    console.log(`Uploaded ${name}, size: ${asset.length} bytes`);
  }
}

================
File: webpack.config.js
================
const path = require('path');

module.exports = {
  entry: './src/assets/actor.js',
  output: {
    filename: 'bundle.js',
    path: path.resolve(__dirname, 'src', 'assets'),
  },
  target: 'web',
  mode: 'production',
  resolve: {
    alias: {
      '@dfinity/agent': path.resolve(__dirname, 'node_modules/@dfinity/agent'),
    },
  },
};
